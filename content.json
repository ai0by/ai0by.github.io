{"meta":{"title":"é£å‘æ ‡ | åˆ†äº«ä¸åˆ›é€ ","subtitle":null,"description":null,"author":"ai0by","url":"https://sbcoder.cn","root":"/"},"pages":[{"title":"api","date":"2019-04-03T02:17:31.000Z","updated":"2020-07-27T06:47:48.314Z","comments":true,"path":"api/index.html","permalink":"https://sbcoder.cn/api/index.html","excerpt":"","text":"é£å‘æ ‡APIåˆé›† åç§° ä½œç”¨ æ¥å£ å¾®åšå›¾åºŠapi è¿œç¨‹å›¾ç‰‡ä¸Šä¼ åˆ°å¾®åšå›¾åºŠ https://sbcoder.cn/api/sinaImg.html ç”ŸæˆäºŒç»´ç  å°†åœ°å€è½¬æ¢ä¸ºäºŒç»´ç å›¾ç‰‡ https://sbcoder.cn/api/qrcode.html æŠ–éŸ³ç›´æ’­æµè§£æ è§£æç›´æ’­æµçœŸå®åœ°å€ https://sbcoder.cn/api/douyin.html ç½‘æ˜“äº‘éŸ³ä¹è§£æ è§£æç½‘æ˜“äº‘éŸ³ä¹çœŸå®åœ°å€ https://sbcoder.cn/api/neteasy.html æ›´å¤šapiè¯·æŒç»­å…³æ³¨â€¦"},{"title":"api","date":"2019-04-04T07:27:21.000Z","updated":"2020-08-08T06:24:20.338Z","comments":true,"path":"api/douyin.html","permalink":"https://sbcoder.cn/api/douyin.html","excerpt":"","text":"æŠ–éŸ³ç›´æ’­apiä»‹ç»æ‰“å¼€APPç›´æ’­ç•Œé¢ï¼Œåˆ†äº«ç›´æ’­é—´é“¾æ¥ï¼Œå¾—åˆ°ä¸€ä¸² https://v.douyin.com/JNUDPVo/ ç±»ä¼¼åœ°å€æäº¤ å‚æ•°åˆ° api è¿”å›ä¸€ä¸ª jsonæ ¼å¼çš„ç›´æ’­æµåœ°å€ å‚æ•°è¯´æ˜ä»¥ GET/POST çš„æ–¹å¼æäº¤åˆ°ï¼šhttps://api.46wz.com/douyin.php å‚æ•° æ•°å€¼ç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¿…ä¼  url String https://sbcoder.cn æ˜¯ è¿”å›å€¼ç±»å‹ : json ç¤ºä¾‹1&#123;\"hls_pull_url\":\"http://pull-hls-l1.douyincdn.com/stage/stream-683443806729404446/playlist.m3u8\",\"rtmp_pull_url\":\"http://pull-flv-l1.douyincdn.com/stage/stream-683443806729404446.flv\"&#125; æ¼”ç¤ºç›´æ¥è®¿é—®ä»¥ä¸‹åœ°å€ 1https://api.46wz.com/douyin.php?url=https://v.douyin.com/JNUDPVo/"},{"title":"api","date":"2019-04-04T07:27:21.000Z","updated":"2020-08-08T06:24:51.709Z","comments":true,"path":"api/qrcode.html","permalink":"https://sbcoder.cn/api/qrcode.html","excerpt":"","text":"äºŒç»´ç ç”Ÿæˆä»‹ç»ä½¿ç”¨åœºæ™¯å¾ˆå¤šï¼Œç®€å•æ¥è®²ï¼Œç»™æˆ‘åœ°å€ï¼Œæˆ‘ç»™ä½ å›¾ï¼Œç›´æ¥å°†åœ°å€æ”¾åœ¨imgæ ‡ç­¾å†…å³å¯~ å‚æ•°è¯´æ˜ä»¥GETçš„æ–¹å¼æäº¤åˆ°ï¼šhttps://api.46wz.com/qrcode.php å‚æ•° æ•°å€¼ç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¿…ä¼  url String https://sbcoder.cn æ˜¯ err String L (L,M,Q,Hå››ç§å¯¹åº”å®¹é”™çº§åˆ«ï¼Œä¸ä¼ é»˜è®¤L) å¦ size String 7 (å¯ä»¥é€‰æ‹©1~9999ä¹‹é—´çš„å€¼ï¼Œå¯¹åº”ä¸åŒå¤§å°ï¼Œé»˜è®¤7) å¦ logo String https://sbcoder.cn/img/avatar.jpg å¦ è¿”å›å€¼ç±»å‹ : ç›´æ¥è¿”å›å›¾ç‰‡ æ¼”ç¤ºç›´æ¥è®¿é—®ä»¥ä¸‹åœ°å€ 12https://api.46wz.com/qrcode.php?url=https://sbcoder.cnhttps://api.46wz.com/qrcode.php?url=https://sbcoder.cn&amp;err=L&amp;size=7&amp;logo=https://sbcoder.cn/img/avatar.jpg ç¤ºä¾‹å›¾ç‰‡"},{"title":"categories","date":"2019-03-21T07:11:04.000Z","updated":"2019-03-21T07:11:32.000Z","comments":false,"path":"categories/index.html","permalink":"https://sbcoder.cn/categories/index.html","excerpt":"","text":""},{"title":"api","date":"2019-04-04T07:27:21.000Z","updated":"2020-08-08T06:25:08.127Z","comments":true,"path":"api/sinaImg.html","permalink":"https://sbcoder.cn/api/sinaImg.html","excerpt":"","text":"å¾®åšå›¾åºŠ-è¿œç¨‹å›¾ç‰‡ä¸Šä¼ apiï¼ˆå·²å¤±æ•ˆï¼‰ä»‹ç»æˆ‘ä»¬åœ¨ä½¿ç”¨çˆ¬è™«ç›¸å…³å†…å®¹çš„æ—¶å€™ï¼Œå­˜æ”¾å›¾ç‰‡æ—¶å¾€å¾€ä¼šé‡åˆ°å›¾ç‰‡å°ºå¯¸è¿‡å¤§ï¼Œå­˜å‚¨ä¸æ–¹ä¾¿ç­‰é—®é¢˜ï¼Œè¿™æ—¶å€™ï¼Œå­˜æ”¾åœ¨ä¸€ä¸ªæ°¸ä¹…å­˜å‚¨çš„äº‘ä¸Šé¢å°±å¾ˆæœ‰å¿…è¦ï¼Œå¾®åšæ˜¯ä¸€ä¸ªä¸é™æµé‡ï¼Œå…¨çƒCDNçš„å›¾åºŠ~å¾®åšä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä»–å¹¶ä¸æ˜¯ä¸€ä¸ªæ˜“äºç®¡ç†çš„å›¾åºŠï¼Œä»…é™äºå­˜æ”¾å›¾ç‰‡ä½†ä¸èƒ½ç®¡ç†å›¾ç‰‡ï¼Œå¦‚æœå¸Œæœ›ä½¿ç”¨å¯ä»¥ç®¡ç†çš„å›¾åºŠï¼Œå¯ä»¥å‚è€ƒä½¿ç”¨è‡ªå»ºå›¾åºŠï¼Œå‚è€ƒæˆ‘çš„:0161 IMG å‚æ•°è¯´æ˜ä»¥GETçš„æ–¹å¼æäº¤åˆ°ï¼šhttps://api.46wz.com/sinaimg/sinaImg.php ä¼ é€’å‚æ•°ç±»å‹ï¼šGET POST å‚æ•° æ•°å€¼ç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¿…ä¼  url String https://sbcoder.cn/img/avatar.jpg æ˜¯ è¿”å›å‚æ•°ç±»å‹ ï¼š JSON æ¼”ç¤ºç¤ºä¾‹:1&#123;\"large\":\"http://ww2.sinaimg.cn/bmiddle/0062WdSely1g1p8mlciyrg30390120jl.gif\"&#125; PHP DEMO12345678910111213141516171819$data = array( 'url' =&gt; \"https://sbcoder.cn/img/avatar.jpg\", );echo curlPost(\"https://api.46wz.com/sinaimg/sinaImg.php\",$data);function curlPost($url,$res)&#123; $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); curl_setopt($curl, CURLOPT_AUTOREFERER, 1); curl_setopt($curl, CURLOPT_POST, 1); curl_setopt($curl, CURLOPT_POSTFIELDS, http_build_query($res)); curl_setopt($curl, CURLOPT_TIMEOUT, 30); curl_setopt($curl, CURLOPT_HEADER, 0); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); $result = curl_exec($curl); curl_close($curl); return $result;&#125;"},{"title":"api","date":"2020-07-21T07:27:21.000Z","updated":"2020-08-08T06:24:32.954Z","comments":true,"path":"api/neteasy.html","permalink":"https://sbcoder.cn/api/neteasy.html","excerpt":"","text":"ç½‘æ˜“äº‘éŸ³ä¹è§£æä»‹ç»ä½¿ç”¨URLæˆ–è€…éŸ³ä¹idè§£æå‡ºéŸ³ä¹çœŸå®åœ°å€ï¼ŒçœŸå®åœ°å€å…·æœ‰æ—¶æ•ˆæ€§ï¼Œå°½å¯èƒ½å½“æ—¶ä½¿ç”¨ å‚æ•°è¯´æ˜ä»¥GET/POSTçš„æ–¹å¼æäº¤åˆ°ï¼šhttps://api.46wz.com/neteasy.php å‚æ•° æ•°å€¼ç±»å‹ ç¤ºä¾‹ æ˜¯å¦å¿…ä¼  url String https://music.163.com/song?id=1438116717&amp;userid=36276027 æ˜¯ è¿”å›å€¼ç±»å‹ : json æ¼”ç¤ºç›´æ¥è®¿é—®ä»¥ä¸‹åœ°å€ 1https://api.46wz.com/neteasy.php?url=http://music.163.com/song?id=27506983&amp;userid=36276027 è¿”å›ç¤ºä¾‹1&#123;\"src\":\"http://m10.music.126.net/20200727150722/407150eee50229ec961c8fcc076264dc/ymusic/4eaf/b0c1/5dfa/83c3b3868df7c381230b3df71beaff32.mp3\",\"code\":1,\"msg\":\"\\u6210\\u529f\"&#125; æ•™ç¨‹å‚è€ƒ ç®€å•åˆ¶ä½œç½‘æ˜“äº‘éŸ³ä¹è§£ææ¥å£"},{"title":"tags","date":"2019-03-21T05:14:24.000Z","updated":"2019-03-21T05:14:52.000Z","comments":false,"path":"tags/index.html","permalink":"https://sbcoder.cn/tags/index.html","excerpt":"","text":""},{"title":"Links","date":"2019-04-22T12:14:24.000Z","updated":"2020-07-23T09:03:47.694Z","comments":true,"path":"custom/index.html","permalink":"https://sbcoder.cn/custom/index.html","excerpt":"","text":"æˆ‘çš„æœ‹å‹ - æ’åä¸åˆ†å…ˆå - songsongâ€™s Blog - çŒ«çˆªå¯¼èˆªğŸ± - Huas Leungâ€™s Blog ç”³è¯·å‹æƒ…é“¾æ¥ ç›´æ¥åœ¨ä¸‹é¢ç•™è¨€å³å¯ï¼ è¦æ±‚ï¼š - æ­£è§„ç«™ç‚¹ - åšå®¢ç±»ä¼˜å…ˆ - æŠ€æœ¯ç±»ç«™ç‚¹ä¼˜å…ˆ æœ¬ç«™é“¾æ¥æ ¼å¼ - é£å‘æ ‡åšå®¢ - https://sbcoder.cn"}],"posts":[{"title":"åˆ©ç”¨CPUçš„ç‰¹æ€§å¼€å‘æ›´é«˜æ•ˆçš„ä»£ç ","slug":"åˆ©ç”¨CPU-Cacheçš„ç‰¹æ€§å¼€å‘æ›´é«˜æ•ˆçš„ä»£ç ","date":"2021-11-29T08:31:34.000Z","updated":"2021-11-29T09:27:57.024Z","comments":true,"path":"2021/11/29/CPU-Cache-Optimization.html","link":"","permalink":"https://sbcoder.cn/2021/11/29/CPU-Cache-Optimization.html","excerpt":"","text":"CPU Cacheæ˜¯ä»€ä¹ˆCPU Cacheæ˜¯åœ¨å†…å­˜çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥è¢«CPUç›´æ¥è¯»å–çš„ç¼“å­˜ï¼Œåˆ†ä¸º L1,L2,L3 ä¸‰å±‚ç¼“å­˜çº§åˆ«ï¼Œä»–çš„è¯»å–é€Ÿåº¦ï¼Œæ˜¯å†…å­˜çš„100å€ä»¥ä¸Šï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åŸºäºå†…å­˜çš„æ•°æ®åº“Redisï¼Œä»…ä»…æ˜¯ä½¿ç”¨äº†å†…å­˜å­˜å‚¨å°±å¾ˆå¿«äº†ï¼ŒCPU Cacheåˆ™æ›´å¿«ï¼Œåˆ©ç”¨å¥½CPU Cacheåˆ™å¯ä»¥è®©ä½ ç¼–å†™çš„ç¨‹åºæ›´å¿«ã€‚ ç›¸æ¯”è¾ƒå„ç±»IOæ“ä½œï¼ŒCPU Cacheåˆ™æ˜¯æœ€åº•å±‚çš„ï¼Œåˆ†çº§ä¸€èˆ¬ä¸º L1 Cache &gt; L2 Cache &gt; L3 Cache &gt; MEM &gt; SSD &gt; HDDï¼ŒæŒ‰ç…§ç°åœ¨å¸‚åœºä¸Šé¢çš„å®šä»·ï¼Œç›¸å¯¹åº”çš„ä»·æ ¼ä¹Ÿæ˜¯æ¢¯å½¢ä¸‹é™ ç›¸å¯¹äºCPU Cacheæ˜‚è´µçš„ä»·æ ¼ï¼Œå¸¦æ¥çš„æ”¶ç›Šè‡ªç„¶ä¹Ÿè¦æ›´é«˜ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€åœ¨æœºå™¨çš„CPU Cacheåˆ†åˆ«æ˜¯å¤šå°‘ï¼Œä»è€Œæ›´æœ‰åˆ©äºä¼˜åŒ–ä»£ç  1234567891011# è·å–L1 æ•°æ®ç¼“å­˜å¤§å°cat /sys/devices/system/cpu/cpu0/cache/index0/size# è·å–L1 æŒ‡ä»¤ç¼“å­˜å¤§å°cat /sys/devices/system/cpu/cpu0/cache/index1/size# è·å–L2 Cache å¤§å°cat /sys/devices/system/cpu/cpu0/cache/index2/size# è·å–L3 Cache å¤§å°cat /sys/devices/system/cpu/cpu0/cache/index3/size ä¸€èˆ¬æ¥è¯´ L3 çš„å®¹é‡ &gt; L2 &gt; L1æ•°æ® = L1æŒ‡ä»¤ oMLjgI.png è¶Šé è¿‘ CPU æ ¸å¿ƒçš„ç¼“å­˜å…¶è®¿é—®é€Ÿåº¦è¶Šå¿«ï¼ŒCPU è®¿é—® L1 Cache åªéœ€è¦ 2~4 ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè®¿é—® L2 Cache å¤§çº¦ 10~20 ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè®¿é—® L3 Cache å¤§çº¦ 20~60 ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè€Œè®¿é—®å†…å­˜é€Ÿåº¦å¤§æ¦‚åœ¨ 200~300 ä¸ª æ—¶é’Ÿå‘¨æœŸä¹‹é—´ã€‚ æ—¶é’Ÿå‘¨æœŸæ˜¯CPUä¸»é¢‘çš„å€’æ•°ï¼Œä¾‹å¦‚ 2GHZä¸»é¢‘çš„CPUï¼Œä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸæ˜¯ 0.5ns CPU Cache LineCPU Cache Line æ˜¯æ¯æ¬¡CPUè½½å…¥ç¼“å­˜çš„å¤§å°ï¼ŒCPUåœ¨è¯»å–ç¼“å­˜ä¿¡æ¯æ—¶å¹¶éæ˜¯ä¸€æ¬¡ä¸€å­—èŠ‚è¯»å–è€Œæ˜¯æ¯æ¬¡è¯»ä¸€ä¸ªå›ºå®šå­—èŠ‚é•¿åº¦çš„æ•°æ® 1cat /sys/devices/system/cpu/cpu0/cache/index0/coherency_line_size oMOIRs.png ç”±äºä»–æ¯æ¬¡æ˜¯è¯»ä¸€å—å„¿æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶åˆ™å¯ä»¥é¿å…å¤šæ¬¡è¯»å–å†…å­˜ï¼Œå¯ä»¥å°†æ•°æ®å†…å®¹å‹ç¼©åˆ°64ä½ä»¥å†…ï¼Œé¿å…é‡å¤è¯» å½“æˆ‘ä»¬åœ¨ä½¿ç”¨æ•°ç»„æ—¶ï¼Œä¾‹å¦‚ä¸€ä¸ª æ•°æ® A é•¿åº¦ 65ï¼Œåˆ™ä¼šç¼“å­˜å‰64ä½æ•°ç»„å†…å®¹ï¼Œä¾‹å¦‚ä»ä¸‹æ ‡0è¯»åˆ°63ï¼Œåˆ™ä¸ä¼šé‡å¤è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆå¦‚æœè¯»0 ç„¶å è¯» 64å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¼šé‡å¤è¯»å†…å­˜ï¼Œä»–ä¼šè‡ªåŠ¨ç¼“å­˜ä»0å¼€å§‹çš„ä¸€å…±é•¿åº¦64çš„æ•°æ®ï¼Œé‚£ä¹ˆä¸‹æ ‡64å·²ç»è¶…å‡ºè¿™ä¸ªé•¿åº¦åˆ™ä¼šé‡å¤è¯»å†…å­˜ é‚£ä¹ˆå¦‚æœè¯» 0 ç„¶åè¯» 2å‘¢ï¼Œè¿˜ä¼šé‡å¤è¯»å†…å­˜å—ï¼Ÿ ç­”æ¡ˆä¹Ÿæ˜¯è‚¯å®šçš„ï¼Œå¦‚æœè·³ç€è¯»ä»–ä¼šé‡å¤ç¼“å­˜ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªè¿ç»­çš„æ•°å€¼æ‰å¯ä»¥åˆ©ç”¨ä¸Šè¿™ä¸ªé•¿åº¦ 1234567p : = [3][3]int&#123;&#123;1, 2, 3&#125;, &#123;4 ,5, 6&#125;, &#123;7, 8, 9&#125;&#125;for i := 0; i &lt; 3; i++ &#123; for j := 0; j &lt; 3; i++ &#123; fmt.Println(\"echo : \" ,p[i][j]) // fmt.Println(\"echo : \" ,p[j][i]) &#125;&#125; ä¸Šè¿°Goä»£ç ä¸­ fmt.Println(&quot;echo : &quot; ,p[i][j])æ˜¯åœ¨å†…å­˜ä¸­è¯»å–è¿ç»­çš„æ•°å€¼ï¼Œè€Œ fmt.Println(&quot;echo : &quot; ,p[j][i]) åˆ™å¹¶éæ˜¯åœ¨è¯»è¿ç»­æ•°æ®ï¼Œä»–ä¼šä¸æ–­åœ°è¯·æ±‚å†…å­˜ï¼Œä»è€Œä¼šå‘ç°å‰è€…çš„æ•ˆç‡æ›´é«˜ä¸€äº› æ€»ç»“ ï¼š æŠ›å¼€ä¸€åˆ‡å› ç´ ï¼Œè¯»å–æ•°æ®æ—¶æŒ‰ç…§å­˜å‚¨é¡ºåºæ¥è¯»ä¸€å®šè¦æ¯”ä»»æ„è¯»æ•ˆç‡è¦é«˜ï¼Œå¦‚æœæœ‰æ¡ä»¶æ§åˆ¶æ•°æ®é•¿åº¦é‚£ä¹ˆå¯ä»¥ç»“åˆCPU Cache Line çš„é•¿åº¦æ¥åšä¸€äº›ä¼˜åŒ– CPUåˆ†æ”¯é¢„æµ‹CPUæœ¬èº«æ˜¯æœ‰ä¸€ä¸ªåˆ†æ”¯é¢„æµ‹åŠŸèƒ½ï¼Œå®ƒç›¸å½“äºä¸€ä¸ªCPUè‡ªå¸¦çš„ä¼˜åŒ–å™¨ï¼Œå½“æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨ifåˆ¤æ–­çš„æ—¶å€™ï¼ŒCPUä¼šè‡ªè¡Œé¢„æµ‹ä»–çš„ç»“æœå¹¶ç¼“å­˜ï¼Œé‚£ä¹ˆCPUé¢„æµ‹çš„ç»“æœå°±ä¸€å®šæ˜¯å‡†ç¡®çš„ä¹ˆï¼Œå½“ç„¶ä¸æ˜¯~ æ—¢ç„¶CPUçš„åˆ†æ”¯é¢„æµ‹å¯ä»¥åœ¨ä¸çŸ¥é“ç»“æœçš„æƒ…å†µä¸‹ç¼“å­˜ä»–è®¤ä¸ºæ­£ç¡®çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶åˆ™å¯ä»¥é€‚å½“åœ°è®©CPUçš„åˆ†æ”¯é¢„æµ‹æ›´å‡†ç¡®ï¼Œé‚£ä¹ˆä¹Ÿå°±é¿å…äº†ç»§ç»­ä»å†…å­˜è¯»å–æ•°æ®ï¼Œé¿å…äº†å¤šä½™çš„æ“ä½œ ä»£ç å®ç°è¯¥å¦‚ä½•åšå‘¢ï¼Œå½“ä¸€ä¸ªifè¯­å¥å¤§å¤šæ•°æ—¶é—´éƒ½æ˜¯ çœŸ çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆCPUçš„åˆ†æ”¯é¢„æµ‹å°†åœ¨åç»­é¢„æµ‹ä¸­æ›´å®¹æ˜“ç¼“å­˜ çœŸ çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥è¯´ï¼Œæˆ‘ä»¬çš„ä»£ç å°½é‡è®©æ•°æ®ä¿æŒåœ¨ä¸€ä¸ªåˆ†æ”¯ä¸­ï¼Œå¯ä»¥é¿å…é‡å¤è¯»å–æ“ä½œ é™¤äº†è¿™ç§CPUè‡ªåŠ¨çš„åˆ†æ”¯é¢„æµ‹ï¼ŒCè¯­è¨€ä¹Ÿæä¾›äº†ä¸€ä¸ªæ–¹æ³•å¯ä»¥å‘Šè¯‰CPUå¤§æ¦‚çš„ç»“æœï¼Œä»è€Œä½¿CPUæ›´å¤šçš„ç¼“å­˜æŸä¸ªåˆ†æ”¯çš„æ•°æ® 123456789#define likely(x) __builtin_expect(!!(x),1)#define unlikely(x) __builtin_expect(!!(x),0)if (likely(a == 1))&#123; /* code */&#125;else&#123; /* code */&#125;","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"}]},{"title":"frp+Nginxå†…ç½‘ç©¿é€è¿œç¨‹æ¡Œé¢","slug":"frp-Nginxå†…ç½‘ç©¿é€è¿œç¨‹æ¡Œé¢","date":"2020-07-27T08:41:31.000Z","updated":"2020-07-27T08:51:35.693Z","comments":true,"path":"2020/07/27/frp-nginx.html","link":"","permalink":"https://sbcoder.cn/2020/07/27/frp-nginx.html","excerpt":"","text":"è¯´æ˜åŸºäº fatedier/frp çš„å†…ç½‘ç©¿é€æœåŠ¡å‚è€ƒæ–‡æ¡£ frpä¸­æ–‡æ–‡æ¡£å‚è€ƒæ–‡æ¡£ ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€ æœåŠ¡ç«¯ç›´æ¥ä¸‹è½½ Releases Â· fatedier/frpæ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬ä¸‹è½½å³å¯ï¼Œæˆ‘è¿™é‡ŒæœåŠ¡ç«¯é€‰ç”¨çš„æ˜¯ frp_0.33.0_linux_386 å›½å†…æœºå™¨é€Ÿåº¦æ…¢å¯ä»¥ä½¿ç”¨æˆ‘çš„ä¸ªäººé•œåƒåœ°å€1wget https://api.0161.org/resources/frp_0.33.0_linux_386.tar.gz ä¿®æ”¹é…ç½®æ–‡ä»¶ frps.ini æ–‡ä»¶ï¼Œå»ºè®®å¢åŠ TokenéªŒè¯ å…³äºæœåŠ¡ç«¯é…ç½®å¯ä»¥å‚ç…§å®˜æ–¹ç»™å‡ºçš„å®Œå…¨ç‰ˆé…ç½®æ–‡ä»¶åŠæ³¨é‡ŠæŸ¥çœ‹ frps_full.ini æ–‡ä»¶ é…ç½®ç¤ºä¾‹12345678[common]bind_port = 7000token = 123456dashboard_port = 7500dashboard_user = admindashboard_pwd = 123456vhost_http_port = 10088vhost_https_port = 10443 1nohup ./frps -c ./frps.ini &amp; æŸ¥çœ‹åå°è¿›ç¨‹1jobs åˆ é™¤è¿›ç¨‹ç¤ºä¾‹12ps -ef | grep frps | grep -v grepkill &lt;è¿›ç¨‹id&gt; æ ¹æ®ä¸Šè¿°é…ç½®å¥½çš„ç«¯å£ 7500 ä½¿ç”¨ IP+ç«¯å£ è®¿é—®frpé¢æ¿ è¾“å…¥é¢æ¿ç”¨æˆ·å+å¯†ç è¯¥é¢æ¿æ— å®é™…æ€§ä½œç”¨ï¼Œä»…ç”¨æ¥åšæ¢é’ˆä»¥åŠæŸ¥çœ‹å½“å‰æœåŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœªé…ç½®dashboardåˆ™æ— æ³•ä½¿ç”¨dashboard 1.png å®¢æˆ·ç«¯ä¸‹è½½ å®¢æˆ·ç«¯ å¯ä»¥ç›´æ¥åœ¨githubä¸‹è½½æˆ–è€…ä½¿ç”¨æˆ‘çš„1wget https://api.0161.org/resources/frp_0.33.0_windows_amd64.zip è§£å‹åä¿®æ”¹ frpc.ini 12345678910111213[common]server_addr = &lt;ä½ çš„æœåŠ¡å™¨IPåœ°å€&gt;server_port = 7000token = 123456[rdp]type = tcplocal_ip = 127.0.0.1 local_port = 3389remote_port = 7001[web]type = httplocal_port = 80custom_domains = &lt;ä½ çš„è¿œç¨‹è§£æåŸŸå ä¾‹å¦‚: xxx.0161.org&gt; ä¸Šè¿°ä½¿ç”¨Windowså¼€å¯3389åå¯ä»¥è®¿é—®è¿œç¨‹æ¡Œé¢ï¼ŒLinuxåŒç†ï¼Œåªéœ€è¦ä¿®æ”¹ä¸º SSH å³å¯ 2.png å€¼å¾—æ³¨æ„çš„æ˜¯ custom_domains è¿™ä¸ªå‚æ•°éœ€è¦é…åˆ vhost_http_port è¿™ä¸ªå‚æ•°ä½¿ç”¨ï¼Œç”±äºè·ŸNginxå†²çªæ‰€ä»¥ä¸Šè¿°ç«¯å£æˆ‘å¼€å¯çš„æ˜¯ 10088å¯ä»¥ä½¿ç”¨åŸŸåè§£æçš„æ–¹å¼ æ¶è®¾æ¸¸æˆæœåŠ¡å™¨ æˆ–è€…ç½‘ç»œäº‘ç›˜ ç¾¤æ™– ä½ æ‡‚å¾—ç½‘ç«™ç­‰ Nginxåå‘ä»£ç†ä½¿ç”¨ä¸Šè¿°é…ç½®å¿…é¡»è¦ä½¿ç”¨ åŸŸå+ç«¯å£ çš„å½¢å¼æ‰èƒ½è®¿é—®ï¼Œå¦‚æœè¦ç”¨æ­£å¼ç¯å¢ƒåˆ™ä¸ç¾è§‚ï¼Œä¸”æˆ‘ä»¬å¸Œæœ›å®ƒä¸Nginxå…±å­˜ï¼Œå› æ­¤ï¼Œå¯ä»¥é€šè¿‡Nginxåå‘ä»£ç†çš„å½¢å¼å»è§£æé…ç½®Nginxé…ç½®æ–‡ä»¶123456789101112server &#123; listen 80; server_name xxx.0161.org; location / &#123; proxy_pass http://127.0.0.1:10088; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header REMOTE-HOST $remote_addr; &#125;&#125; æµç¨‹å›¾è§£ 3.png è‡³æ­¤ï¼Œå¯ä»¥ç›´æ¥è®¿é—® xxx.0161.org æ— éœ€æºå¸¦ç«¯å£å·","categories":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"https://sbcoder.cn/categories/æŠ˜è…¾/"}],"tags":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://sbcoder.cn/tags/è¿ç»´/"},{"name":"å†…ç½‘ç©¿é€","slug":"å†…ç½‘ç©¿é€","permalink":"https://sbcoder.cn/tags/å†…ç½‘ç©¿é€/"},{"name":"frp","slug":"frp","permalink":"https://sbcoder.cn/tags/frp/"}]},{"title":"ç®€å•åˆ¶ä½œç½‘æ˜“äº‘éŸ³ä¹è§£ææ¥å£","slug":"ç®€å•åˆ¶ä½œç½‘æ˜“äº‘éŸ³ä¹è§£ææ¥å£","date":"2020-07-27T02:44:29.000Z","updated":"2020-07-27T06:33:58.069Z","comments":true,"path":"2020/07/27/neteasy-music.html","link":"","permalink":"https://sbcoder.cn/2020/07/27/neteasy-music.html","excerpt":"","text":"å®˜æ–¹æ¥å£ç½‘æ˜“äº‘æ˜¯æœ‰ä¸€ä¸ªå®˜æ–¹çš„éŸ³ä¹è§£ææ¥å£çš„ï¼Œåªæ˜¯éšè—çš„æ¯”è¾ƒæ·±ï¼ˆå…¶å®ä¹Ÿè¿˜å¥½ï¼‰ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨å®˜æ–¹çš„è§£ææ¥å£ä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘çš„ï¼Œå¯èƒ½å®˜æ–¹çš„æœ‰æ—¶æ•ˆæ€§ Step1. æ‰¾åˆ°ä¸€å¼ æ— ç‰ˆæƒæ­Œæ›²ç‚¹å‡»ç”Ÿæˆå¤–é“¾æ’­æ”¾å™¨ aPDuNR.png Step2. é€‰æ‹©flashæ’­æ”¾å™¨å¼€å¯F12 å®¡æŸ¥å…ƒç´  é€‰æ‹©flashæ’­æ”¾å™¨ aPDnE9.png Step3. æœç´¢æ¥å£ç›´æ¥åœ¨F12 æœç´¢ song æ‰¾åˆ°å¦‚ä¸‹æ¥å£ aPDZB4.png Step. å¤åˆ¶æ¥å£åœ°å€302ç›´æ¥è·³è½¬ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–åˆ°ç›´é“¾åœ°å€ aPDeHJ.png æ‰¾åˆ°å®˜æ–¹æ¥å£1https://music.163.com/song/media/outer/url?id=&lt;æ­Œæ›²ID&gt; æ ¹æ®å®˜æ–¹å†…å®¹è‡ªåˆ¶æ¥å£1234567891011121314151617181920212223242526272829303132&lt;?php$params = $_REQUEST;$returnData = [];$returnData['src'] = 'error 500';$returnData['code'] = 0;$returnData['msg'] = 'æ— çŠ¶æ€';if (!isset($params['url']) || empty($params['url'])) &#123; $returnData['msg'] = '5001 URLæˆ–è€…IDå‚æ•°ä¸å­˜åœ¨'; echo json_encode($returnData,JSON_UNESCAPED_SLASHES); exit();&#125;$url = $params['url'];$pattern = '/(\\d&#123;5,20&#125;)/i';preg_match($pattern, $url, $matches);if (!$matches) &#123; $returnData['msg'] = '5002 URLæˆ–è€…IDæ ¼å¼æœ‰è¯¯'; echo json_encode($returnData,JSON_UNESCAPED_SLASHES); exit();&#125;$getParameterUrl = 'https://music.163.com/song/media/outer/url?id=' . $matches[0];var_dump($getParameterUrl);exit();$headers = get_headers($getParameterUrl, TRUE);//è¾“å‡ºè·³è½¬åˆ°çš„ç½‘å€if ($headers['Location']) &#123; $returnData['msg'] = 'æˆåŠŸ'; $returnData['src'] = $headers['Location']; $returnData['code'] = 1;&#125;echo json_encode($returnData,JSON_UNESCAPED_SLASHES);exit(); äºŒæ¬¡å°è£…ä¹‹åå¯ä»¥ä½¿ç”¨æ³¨æ„ï¼šç½‘æ˜“äº‘çš„è¿™ä¸ªæ¥å£æ— æ³•ä½¿ç”¨å›½å¤–IPè®¿é—®ï¼Œå¦‚IPä¸ç¬¦å¯èƒ½ä¼šè¿”å›404 å¯ä»¥ä½¿ç”¨æˆ‘çš„APIæ¥å£è·å–æœ€æ–°ç‰ˆè§£æ","categories":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"https://sbcoder.cn/categories/æŠ˜è…¾/"}],"tags":[{"name":"éŸ³ä¹","slug":"éŸ³ä¹","permalink":"https://sbcoder.cn/tags/éŸ³ä¹/"}]},{"title":"ä½¿ç”¨Rancherå¿«é€Ÿéƒ¨ç½²k8sé›†ç¾¤","slug":"ä½¿ç”¨Rancherå¿«é€Ÿéƒ¨ç½²k8sé›†ç¾¤","date":"2020-07-24T03:32:57.000Z","updated":"2020-07-24T03:34:48.050Z","comments":true,"path":"2020/07/24/rancher-install.html","link":"","permalink":"https://sbcoder.cn/2020/07/24/rancher-install.html","excerpt":"","text":"å®‰è£…Rancheræ³¨æ„ï¼šæœ€ä½é…ç½®ä¸º 2H4G1M æœ¬æ•™ç¨‹ä½¿ç”¨ 2H8G5M Ubuntu18.04å¸è½½æ—§ç‰ˆDocker1sudo apt-get remove docker docker-engine docker.io containerd runc è„šæœ¬å®‰è£…Docker1curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun æ›´æ¢é˜¿é‡Œäº‘æºç™»å½• https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors æ‰¾åˆ° åŠ é€Ÿåœ°å€ï¼Œæˆ–è€…ä½¿ç”¨æˆ‘çš„12345678sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;&#123; &quot;registry-mirrors&quot;: [&quot;https://p4sew3ge.mirror.aliyuncs.com&quot;]&#125;EOFsudo systemctl daemon-reloadsudo systemctl restart docker å®‰è£…Rancher1sudo docker run -d --restart=unless-stopped -v /home/rancher:/var/lib/rancher/ -p 80:80 -p 443:443 rancher/rancher:stable æ‰“å¼€ https://&lt;ä½ çš„IP&gt;å¿½ç•¥æ‰è¯ä¹¦æç¤ºï¼Œç»§ç»­è¿›å…¥ 1.png æ·»åŠ é›†ç¾¤Step1.è®¾ç½®è¯­è¨€ 2.png Step2.é€‰æ‹©å³ä¸Šè§’æ·»åŠ é›†ç¾¤ï¼Œé€‰æ‹©è‡ªå®šä¹‰ 3.png Step3.è®¾ç½®å¥½é›†ç¾¤åå­—åç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ Step4.é…ç½®èŠ‚ç‚¹æŒ‰ç…§éœ€è¦é…ç½®ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©å…¨éƒ¨ 4.png Step5.é…ç½®å…¬ç½‘IPäº‘ä¸»æœºéœ€è¦é…ç½® 5.png Step6.å¤åˆ¶å‘½ä»¤æ‰§è¡Œ 6.png æ‰§è¡Œåä¼šå¯åŠ¨ä¸€ä¸ªå®¹å™¨ 7.png Step7.é›†ç¾¤éƒ¨ç½²èŠ‚ç‚¹å®Œæˆå‡†å¤‡ä¸­â€¦ 8.png å®Œæˆéƒ¨ç½² 9.png å¢åŠ èŠ‚ç‚¹é€‰æ‹©ä¸»æœº - ç¼–è¾‘é›†ç¾¤ 11.png æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œä¸ä¸Šé¢æ·»åŠ èŠ‚ç‚¹æ–¹å¼ä¸€æ ·ï¼Œä¿®æ”¹ä¸ºå­èŠ‚ç‚¹çš„ipï¼Œç„¶ååœ¨å­èŠ‚ç‚¹è¿è¡Œè¯¥å‘½ä»¤ç­‰å¾…æ·»åŠ å®Œæˆ 10.png","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://sbcoder.cn/tags/è¿ç»´/"},{"name":"Docker","slug":"Docker","permalink":"https://sbcoder.cn/tags/Docker/"}]},{"title":"Ubuntu18.04éƒ¨ç½²Kubernetes(k8s)é›†ç¾¤å¯è§†åŒ–ç•Œé¢Dashboard","slug":"Ubuntu18-04éƒ¨ç½²Kubernetes-k8s-é›†ç¾¤å¯è§†åŒ–ç•Œé¢Dashboard","date":"2020-07-23T01:12:57.000Z","updated":"2020-07-23T06:03:37.256Z","comments":true,"path":"2020/07/23/Kubernetes-Ubuntu.html","link":"","permalink":"https://sbcoder.cn/2020/07/23/Kubernetes-Ubuntu.html","excerpt":"","text":"k8sæ¦‚å¿µæ¶æ„ Kubernetesæ˜¯ä¸€ä¸ªå®Œå¤‡çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ”¯æ’‘å¹³å°ã€‚Kuberneteså…·æœ‰å®Œå¤‡çš„é›†ç¾¤ç®¡ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬å¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤å’Œå‡†å…¥æœºåˆ¶/å¤šç§Ÿæˆ·åº”ç”¨æ”¯æ’‘èƒ½åŠ›ã€é€æ˜çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°æœºåˆ¶ã€å†…å»ºæ™ºèƒ½è´Ÿè½½å‡è¡¡å™¨ã€å¼ºå¤§çš„æ•…éšœå‘ç°å’Œè‡ªæˆ‘ä¿®å¤åŠŸèƒ½ã€æœåŠ¡æ»šåŠ¨å‡çº§å’Œåœ¨çº¿æ‰©å®¹èƒ½åŠ›ã€å¯æ‰©å±•çš„èµ„æºè‡ªåŠ¨è°ƒåº¦æœºåˆ¶ï¼Œä»¥åŠå¤šç²’åº¦çš„èµ„æºé…é¢ç®¡ç†èƒ½åŠ›ã€‚åŒæ—¶kubernetesæä¾›äº†å®Œå–„çš„ç®¡ç†å·¥å…·ï¼Œè¿™äº›å·¥å…·è¦†ç›–äº†åŒ…æ‹¬å¼€å‘ã€æµ‹è¯•éƒ¨ç½²ã€è¿ç»´ç›‘æ§åœ¨å†…çš„å„ä¸ªç¯èŠ‚ï¼›å› æ­¤kubernetesæ˜¯ä¸€ä¸ªå…¨æ–°çš„åŸºäºå®¹å™¨æŠ€æœ¯çš„åˆ†å¸ƒå¼æ¶æ„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªä¸€ç«™å¼çš„å®Œå¤‡çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å’Œæ”¯æ’‘å¹³å° Kubernetesç®€æ˜“.png Kubernetes Service Serviceçš„æœåŠ¡è¿›ç¨‹ç›®å‰éƒ½åŸºäºSockeré€šä¿¡æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ¯”å¦‚redisã€memcacheã€MySQLã€Web Serverï¼Œæˆ–è€…æ˜¯å®ç°äº†æŸä¸ªå…·ä½“ä¸šåŠ¡çš„ä¸€ä¸ªç‰¹å®šçš„TCP Serverè¿›ç¨‹ã€‚è™½ç„¶ä¸€ä¸ªServiceé€šå¸¸ç”±å¤šä¸ªç›¸å…³çš„æœåŠ¡è¿›ç¨‹æ¥æä¾›æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„Endpoint(IP+Port)è®¿é—®ç‚¹ï¼Œä½†Kubernetes èƒ½å¤Ÿè®©æˆ‘ä»¬é€šè¿‡Serviceè™šæ‹ŸCluster IP+Service Portè¿æ¥åˆ°æŒ‡å®šçš„Serviceä¸Šã€‚æœ‰äº†Kuberneteså†…å»ºçš„é€æ˜è´Ÿè½½å‡è¡¡å’Œæ•…éšœæ¢å¤æœºåˆ¶ï¼Œä¸ç®¡åç«¯æœ‰å¤šå°‘æœåŠ¡è¿›ç¨‹ï¼Œä¹Ÿä¸ç®¡æŸä¸ªæœåŠ¡è¿›ç¨‹æ˜¯å¦ä¼šç”±äºå‘ç”Ÿæ•…éšœè€Œé‡æ–°éƒ¨ç½²åˆ°å…¶ä»–æœºå™¨ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°æˆ‘ä»¬å¯¹æœåŠ¡çš„æ­£å¸¸è°ƒç”¨ã€‚æ›´é‡è¦çš„æ˜¯è¿™ä¸ªServiceæœ¬èº«ä¸€æ—¦åˆ›å»ºå°±ä¸å†å˜åŒ–ï¼Œè¿™æ„å‘³ç€Kubernetesé›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨ä¸ºäº†æœåŠ¡çš„IPåœ°å€å˜æ¥å˜å»çš„é—®é¢˜è€Œå¤´ç–¼ã€‚ serviceå¯ä»¥é€šè¿‡è®¿é—®ç‚¹å»è®¿é—®ä¸åŒçš„å­èŠ‚ç‚¹ä¸‹é¢çš„Podä¸Šï¼Œç±»ä¼¼ä¸€ä¸ªProxyçš„æ¦‚å¿µï¼Œä¸ªäººç†è§£ä¸ºä»–æœ¬èº«ç±»ä¼¼é›†ç¾¤ï¼Œé€šè¿‡serviceåˆ†å‘ä¸swarmé›†ç¾¤ä¸­çš„serviceç±»ä¼¼ï¼Œå¯ä»¥ä¿æŒå®¹å™¨å¯åŠ¨æ•°é‡ï¼Œç”±äºæƒé™ç›¸å…³é—®é¢˜ï¼Œç”¨æˆ·æ‰‹åŠ¨å‘½ä»¤è¦å¤§äºserviceæ§åˆ¶çš„æƒé™çº§åˆ«ï¼Œå› æ­¤å¦‚æœåœ¨ä½¿ç”¨serviceæ§åˆ¶Podæ—¶ï¼Œæœ‰å¯èƒ½å¯¼è‡´æŠ¥é”™ï¼Œä¸æ¨èä½¿ç”¨ Kubernetes Service.png Kubernetes Pod Podè¿è¡Œåœ¨ä¸€ä¸ªæˆ‘ä»¬ç§°ä¹‹ä¸ºèŠ‚ç‚¹Nodeçš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥æ˜¯ç§æœ‰äº‘ä¹Ÿå¯ä»¥æ˜¯å…¬æœ‰äº‘çš„è™šæ‹Ÿæœºæˆ–è€…ç‰©ç†æœºï¼Œé€šå¸¸åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œå‡ ç™¾ä¸ªPod;å…¶æ¬¡ï¼Œæ¯ä¸ªPodé‡Œè¿è¡Œç€ä¸€ä¸ªç‰¹æ®Šçš„è¢«ç§°ä¹‹ä¸ºPauseçš„å®¹å™¨ï¼Œå…¶ä»–å®¹å™¨åˆ™ä¸ºä¸šåŠ¡å®¹å™¨ï¼Œè¿™äº›ä¸šåŠ¡å®¹å™¨å…±äº«Pauseå®¹å™¨çš„ç½‘ç»œæ ˆå’ŒVolumeæŒ‚è½½å·ï¼Œå› æ­¤ä»–ä»¬ä¹‹é—´çš„é€šè®¯å’Œæ•°æ®äº¤æ¢æ›´ä¸ºé«˜æ•ˆã€‚åœ¨è®¾è®¡æ—¶æˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨è¿™ä¸€ç‰¹å¾å°†ä¸€ç»„å¯†åˆ‡ç›¸å…³çš„æœåŠ¡è¿›ç¨‹æ”¾å…¥åŒä¸€ä¸ªPodä¸­ã€‚å¹¶ä¸æ˜¯æ¯ä¸ªPodå’Œå®ƒé‡Œé¢è¿è¡Œçš„å®¹å™¨éƒ½èƒ½æ˜ å°„åˆ°ä¸€ä¸ªService ä¸Šï¼Œåªæœ‰é‚£äº›æä¾›æœåŠ¡(æ— è®ºæ˜¯å¯¹å†…è¿˜æ˜¯å¯¹å¤–)çš„ä¸€ç»„Podæ‰ä¼šè¢«æ˜ å°„æˆä¸€ä¸ªæœåŠ¡ã€‚ Kubernetes Pod.png Pod &amp; Container å®¹å™¨ï¼ˆContainerï¼‰æ˜¯ä¸€ç§é«˜åº¦éš”ç¦»çš„å°è£…ç¨‹åº å®¹å™¨1.png éæ‰€æœ‰çš„åº”ç”¨éƒ½é€‚åˆé€‰æ‹©å®¹å™¨ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±åº”ç”¨çš„ç‰¹ç‚¹å’Œéœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„è®¡ç®—å•å…ƒã€‚ä¾‹å¦‚ï¼Œä½ çš„åº”ç”¨æ˜¯é«˜æ€§èƒ½ã€äº’ä¿¡çš„ï¼Œä¸”å¤„äºåŒä¸€ä¸ªç®¡ç†åŒºåŸŸï¼Œé‚£ä¹ˆç”¨çº¿ç¨‹æˆ–è€…è¿›ç¨‹å°±å¯ä»¥æ»¡è¶³ï¼›ä½†å¦‚æœä½ çš„åº”ç”¨æ˜¯å¤šç§Ÿæˆ·çš„ï¼Œå¹¶ä¸”å’Œå…¶ä»–åº”ç”¨è¿è¡Œåœ¨åŒä¸€ä¸ªç©ºé—´ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦è€ƒè™‘å¦‚ä½•å°†è¿™äº›åº”ç”¨å®‰å…¨åœ°éš”ç¦»å¼€ï¼Œä½¿å¾—æ•°æ®ä¸ä¼šè¢«æ³„éœ²æˆ–æ€§èƒ½å—åˆ°å½±å“ã€‚é‚£ä¹ˆè¿™æ—¶ï¼Œå®¹å™¨ä¹Ÿè®¸å°±æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©äº†ã€‚å®¹å™¨ä¾¿äºç®¡ç†ï¼Œå› ä¸ºç°åœ¨å¸‚åœºä¸Šæœ‰ç€å®Œå…¨å®Œå–„çš„ç”Ÿæ€ä»¥åŠDockerçš„æ”¯æŒåº¦æ„ˆå‘å¢åŠ ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸ï¼ˆä¸ªäººï¼‰é€‰æ‹©Dockerï¼Œæˆ‘ä¸ªäººä¹Ÿæ›´å€¾å‘äºDockerï¼Œæœ‰äº†Dockerå°±å¯ä»¥éå¸¸å®Œç¾çš„ç®¡ç†Imagesä»¥åŠContainer å®¹å™¨2.png å®¹å™¨æ˜¯åªå ç”¨å¾ˆå°‘çš„ç©ºé—´çš„ï¼ŒçœŸæ­£å ç”¨ç©ºé—´å¤§çš„æ˜¯Imagesï¼Œä¹Ÿå¯ä»¥è¯´ Container ä¾èµ– Images Podï¼Œä¸€ç§å¢å¼ºå‹å®¹å™¨Podæ˜¯ä¸€ç§ç»„åˆçš„å¤šå®¹å™¨è¿è¡Œå•å…ƒï¼Œä¹Ÿæ˜¯Kubernetesé‡Œçš„ä¸€ä¸ªåŸºç¡€å•å…ƒã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ç§å®¹å™¨çš„æ‰©å±•æˆ–è€…å¢å¼ºå‹çš„å®¹å™¨ã€‚Podé‡Œé¢åŒ…æ‹¬ä¸€ä¸ªä¸»å®¹å™¨å’Œæ•°ä¸ªè¾…åŠ©å®¹å™¨ï¼Œå®ƒä»¬å…±åŒå®Œæˆä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ã€‚æŠŠå¤šä¸ªè¿›ç¨‹ï¼ˆå®¹å™¨ä¹Ÿæ˜¯ä¸€ç§éš”ç¦»çš„è¿›ç¨‹ï¼‰æ‰“åŒ…åœ¨ä¸€ä¸ªName Spaceé‡Œçš„æ—¶å€™ï¼Œå°±æ„æˆäº†ä¸€ä¸ªPodã€‚Podé‡Œé¢ä¸åŒè¿›ç¨‹çš„åº”ç”¨åŒ…è£…ä»ç„¶æ˜¯ç‹¬ç«‹çš„ï¼ˆæ¯ä¸ªå®¹å™¨éƒ½ä¼šæœ‰è‡ªå·±çš„é•œåƒï¼‰ã€‚Podçš„æ„ä¹‰åœ¨äºï¼Œå®ƒå¯ä»¥æ—¢ä¿æŒä¸»å®¹å™¨å’Œè¾…åŠ©å®¹å™¨çš„çš„å¯†åˆ‡å…³ç³»ï¼Œåˆä¿æŒä¸»å®¹å™¨çš„ç‹¬ç«‹æ€§ã€‚ç”±äºä¸»å®¹å™¨å’Œè¾…åŠ©å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒï¼Œå¯ä»¥åŒæ—¶è¢«åˆ›å»ºå’Œé”€æ¯ï¼Œå› æ­¤æŠŠå®ƒä»¬æ”¾åœ¨ä¸€ä¸ªPodä¸­ï¼Œå¯ä»¥ä½¿ä»–ä»¬çš„äº¤äº’æ›´åŠ é«˜æ•ˆã€‚ å‚è€ƒæ–‡æ¡£Aholiab - äº‘åŸç”Ÿçš„åŸºçŸ³ï¼Œä¸€æ–‡è¯»æ‡‚å®¹å™¨ã€Dockerã€Podåˆ°åº•æ˜¯ä»€ä¹ˆï¼ abcdockerç¼–å†™k8sä¸­æ–‡æ–‡æ¡£Ubuntu18.04ä½¿ç”¨kubeadméƒ¨ç½²v1.18 HAé›†ç¾¤ éƒ¨ç½²k8sæœºå™¨é€‰æ‹©è¿™é‡Œæˆ‘åªåšå­¦ä¹ ç”¨é€”ï¼Œå› æ­¤å¼€é€šçš„æ˜¯é˜¿é‡Œçš„æŒ‰é‡è®¡è´¹æœºå™¨ä»¥åŠä½é…ç½®æœºå™¨ master01 2H8G é˜¿é‡Œäº‘ Ubuntu18.04 node01 2H8G é˜¿é‡Œäº‘ Ubuntu18.04 éƒ¨ç½²ç¯å¢ƒUbuntuä¿®æ”¹ä»“åº“é•œåƒ12345678910111213141516sudo cat &gt; /etc/apt/sources.list &lt;&lt; EOFdeb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverseEOF å…³é—­é˜²ç«å¢™1sudo ufw disable æ—¶é—´åŒæ­¥12345678sudo apt-get install chrony -y &amp;&amp; sudo systemctl start chrony &amp;&amp; sudo systemctl enable chrony#æŸ¥çœ‹chronyè¿æ¥çš„å…¬ç½‘æœåŠ¡å™¨cat /etc/chrony/chrony.conf pool ntp.ubuntu.com iburst maxsources 4pool 0.ubuntu.pool.ntp.org iburst maxsources 1pool 1.ubuntu.pool.ntp.org iburst maxsources 1pool 2.ubuntu.pool.ntp.org iburst maxsources 2 ç¦ç”¨swap1sudo swapoff -a ä¸Šè¿°å‘½ä»¤å¯ä»¥ä¸´æ—¶ç¦ç”¨æ‰swapï¼Œå¦‚æœæƒ³è¦æ°¸ä¹…ç¦æ­¢ï¼Œéœ€è¦ç¼–è¾‘ /etc/fstab æ–‡ä»¶,å°†swapé‚£ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸ç®¡ ç¦ç”¨SELinuxå¦‚æœå®‰è£…äº†åˆ™éœ€è¦ç¦æ­¢æ‰ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…åˆ™å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤123sudo setenforce 0 #ä¸´æ—¶å…³é—­sudo vi /etc/selinux/config #æ°¸ä¹…å…³é—­SELINUX=permissive ä¿®æ”¹å†…æ ¸123456sudo cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOFnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1net.ipv4.ip_forward = 1 #å¼€å¯ipv4è½¬å‘ï¼Œå…è®¸å†…ç½®è·¯ç”±EOFsudo sysctl --system ä¿®æ”¹æ—¶åŒº12sudo ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimesudo bash -c &quot;echo &apos;Asia/Shanghai&apos; &gt; /etc/timezone&quot; å®‰è£…DockerStep 1: å®‰è£…å¿…è¦çš„ä¸€äº›ç³»ç»Ÿå·¥å…·12sudo apt-get updatesudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common Step 2: å®‰è£…GPGè¯ä¹¦1sudo curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add - Step 3: å†™å…¥è½¯ä»¶æºä¿¡æ¯1sudo add-apt-repository &quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot; Step 4: æŸ¥æ‰¾Docker-CEçš„ç‰ˆæœ¬1sudo apt-cache madison docker-ce Step 5: å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Docker-CE,docker-ce=VERSION1sudo apt-get -y install docker-ce Setp 6: å®‰è£…å®ŒæˆåDockeré»˜è®¤å°±å·²ç»å¯åŠ¨å’ŒåŠ å…¥å¼€æœºè‡ªå¯äº†ï¼Œè¿™ç‚¹æˆ‘ä»¬ä¸éœ€è¦å†åšäº†ï¼Œä¸è¿‡å¯ä»¥æ£€æŸ¥ä¸€ä¸‹12sudo systemctl status dockersudo systemctl is-enabled docker Setp 7: é…ç½®Dockeré•œåƒåŠ é€Ÿä»¥åŠæŒ‡å®šcgroupé©±åŠ¨ä¸ºsystemd123456789sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-&apos;EOF&apos;&#123; &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;], &quot;registry-mirrors&quot;: [&quot;https://81z69sad.mirror.aliyuncs.com&quot;]&#125;EOFsudo systemctl daemon-reloadsudo systemctl restart docker Setp 8: é…ç½®å®Œæˆåä½¿ç”¨ docker info å¯ä»¥çœ‹åˆ°ä¿®æ”¹çš„é…ç½®ä¿¡æ¯ é…ç½®ä¸»æœºå1234cat &gt;&gt; /etc/hosts &lt;&lt; EOF172.26.147.37 master01172.26.147.36 node01EOF å®‰è£…Kubeadm Kubelet KubectlStep 1: å®‰è£…å¿…è¦çš„ç¨‹åºåŒ…1apt-get update &amp;&amp; apt-get install -y apt-transport-https Step 2: å¯¼å…¥Kuberneteså®˜æ–¹åŒ…ç­¾åå¯†é’¥1sudo curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - Step 3: æ·»åŠ Kubernetesä»“åº“123cat &gt; /etc/apt/sources.list.d/kubernetes.list &lt;&lt; EOFdeb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial mainEOF Step 4: æ›´æ–°ä»“åº“1apt-get update Step 5: æŸ¥æ‰¾kubeadm kubelet kubectlç‰ˆæœ¬123apt-cache madison kubeadm | grep 1.18apt-cache madison kubelet | grep 1.18apt-cache madison kubectl | grep 1.18 ç›®å‰1.18å‘å¸ƒäº†1.18.0-00 1.18.1-00 1.18.2-00 ä¸‰ä¸ªç‰ˆæœ¬ Step 6: æŒ‡å®šç‰ˆæœ¬å®‰è£…kubelet kubeadm kubectl(å¦‚æœå®‰è£…æœ€æ–°ç‰ˆæœ¬åˆ™æ— éœ€å¸¦ç‰ˆæœ¬å·)1apt-get install kubeadm kubelet kubectl -y MasterèŠ‚ç‚¹éƒ¨ç½²æ ¹æ®éœ€è¦ä¿®æ”¹çš„å‚æ•°æ›´æ¢ä»¥ä¸‹å†…å®¹123456789kubeadm init \\--image-repository registry.aliyuncs.com/google_containers \\--kubernetes-version v1.18.0 \\--control-plane-endpoint master01 \\--pod-network-cidr=10.244.0.0/16 \\--service-cidr=10.96.0.0/12 \\--apiserver-advertise-address=0.0.0.0 \\--ignore-preflight-errors=Swap \\--token-ttl 30m å‚æ•°è¯´æ˜ image-repositoryï¼šåˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šå»dockerä»“åº“æ‹‰å»é•œåƒï¼Œé»˜è®¤æŒ‡å®šçš„ä¸ºdocker hub(å›½å†…è®¿é—®ç½‘é€Ÿä¸å ª)ï¼Œæ‰€ä»¥åœ¨æ­¤ä½¿ç”¨â€“image-repositoryå‚æ•°æŒ‡å®šé˜¿é‡Œäº‘é•œåƒã€‚ kubernetes-versionï¼šæŒ‡å®šæ­£åœ¨ä½¿ç”¨çš„ Kubernetes ç¨‹åºç»„ä»¶çš„ç‰ˆæœ¬å·ï¼Œéœ€è¦ä¸ kubelet kubeadm kubectl çš„ç‰ˆæœ¬å·ä¸€è‡´ã€‚ control-plane-endpoint: æŒ‡å®šæ§åˆ¶å¹³é¢çš„å›ºå®šè®¿é—®ç«¯ç‚¹ï¼Œå¯ä»¥æ˜¯IPåœ°å€æˆ–DNSåç§°ï¼Œä¼šè¢«ç”¨äºé›†ç¾¤ç®¡ç†å‘˜åŠé›†ç¾¤ç»„ä»¶çš„kubeconfigé…ç½®æ–‡ä»¶API Serverçš„è®¿é—®åœ°å€ï¼›å•æ§åˆ¶å¹³é¢éƒ¨ç½²æ—¶å¯ä»¥ä¸ä½¿ç”¨è¯¥é€‰é¡¹(å¦‚æœæ˜¯å•ä¸ªMasteréƒ¨ç½²åˆ™ä¸éœ€è¦ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œå› ä¸ºç­‰ä¼šæˆ‘ä»¬è¦å†åŠ å…¥å…¶å®ƒä¸¤ä¸ªMasterèŠ‚ç‚¹åˆ°æ§åˆ¶å¹³é¢ï¼Œæ‰€ä»¥è¿™é‡ŒåŠ ä¸Šæ­¤å‚æ•°)ã€‚ pod-network-cidrï¼šPod ç½‘ç»œçš„åœ°å€èŒƒå›´ï¼Œå…¶å€¼ä¸º CIDR æ ¼å¼çš„ç½‘ç»œåœ°å€ï¼Œä½¿ç”¨ flannel ç½‘ç»œæ’ä»¶æ—¶ï¼Œå…¶é»˜è®¤åœ°å€ä¸º 10.244.0.0/16ã€‚ service-cidrï¼šService çš„ç½‘ç»œåœ°å€èŒƒå›´ï¼Œå…¶å€¼ä¸º CIDR æ ¼å¼çš„ç½‘ç»œåœ°å€ï¼Œé»˜è®¤åœ°å€ä¸º 10.96.0.0/12ã€‚ apiserver-advertise-addressï¼šAPI Server é€šå‘Šç»™å…¶å®ƒç»„ä»¶çš„IPåœ°å€ï¼Œä¸€èˆ¬ä¸º Master èŠ‚ç‚¹çš„IPåœ°å€ï¼Œ0.0.0.0 æ ‡è¯†èŠ‚ç‚¹ä¸Šæ‰€æœ‰å¯ç”¨çš„åœ°å€ã€‚ignore-preflight-errorsï¼šå¿½ç•¥å“ªäº›è¿è¡Œæ—¶çš„é”™è¯¯ä¿¡æ¯ï¼Œå…¶å€¼ä¸º Swap æ—¶ï¼Œè¡¨ç¤ºå¿½ç•¥å›  swap æœªå…³é—­è€Œå¯¼è‡´çš„é”™è¯¯ã€‚ token-ttlï¼štokenä»¤ç‰Œè‡ªåŠ¨åˆ é™¤æ—¶é—´ï¼Œé»˜è®¤ä¸º24å°æ—¶ï¼ŒæŒ‡å®šä¸º 0 è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼ŒæŒ‡å®šå•ä½å¯ä»¥ä½¿ ç§’s åˆ†m æ—¶hï¼Œåœ¨nodeåŠ å…¥Kubernetesé›†ç¾¤æ—¶éœ€è¦æŒ‡å®štokenã€‚åˆå§‹åŒ–è¿‡ç¨‹ 01.png 02.png 03.png åˆå§‹åŒ–å®Œæˆ12345678910111213141516171819202122232425#æ‚¨çš„Kubernetesæ§åˆ¶å¹³é¢åˆå§‹åŒ–æˆåŠŸ!Your Kubernetes control-plane has initialized successfully!#è¦å¼€å§‹ä½¿ç”¨æ‚¨çš„é›†ç¾¤ï¼Œæ‚¨éœ€è¦ä½œä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·è¿è¡Œä»¥ä¸‹ç¨‹åº:To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config#ä½ éœ€è¦éƒ¨ç½²ä¸€ä¸ªç½‘ç»œæ’ä»¶åˆ°é›†ç¾¤ä¸­æ‰èƒ½å¤Ÿä½¿Kubernetesç½‘ç»œè¿è½¬èµ·æ¥You should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/#å¦‚æœè¦æ·»åŠ å…¶å®ƒæ§åˆ¶å¹³é¢åˆ°é›†ç¾¤ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤You can now join any number of control-plane nodes by copying certificate authoritiesand service account keys on each node and then running the following as root: kubeadm join k8s-devops.io:6443 --token 8r7sjk.9a31rmcjot9650fe \\ --discovery-token-ca-cert-hash sha256: \\ --control-plane#å¦‚æœè¦æ·»åŠ æ•°æ®å¹³é¢èŠ‚ç‚¹åˆ°é›†ç¾¤ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤Then you can join any number of worker nodes by running the following on each as root:kubeadm join k8s-devops.io:6443 --token 8r7sjk.9a31rmcjot9650fe \\ --discovery-token-ca-cert-hash sha256: åˆ›å»ºç”¨æˆ·12345root@master01:~# useradd -m -s /bin/bash k8s # åˆ›å»ºç”¨æˆ·root@master01:~# passwd k8s # è®¾ç½®å¯†ç Enter new UNIX password:Retype new UNIX password:passwd: password updated successfully ä¸ºæ™®é€šç”¨æˆ·ææƒ1root@master01:~# echo &apos;k8s ALL=(ALL:ALL) NOPASSWD:ALL&apos; &gt;&gt; /etc/sudoers.d/k8s åˆ›å»ºæƒé™123456root@master01:~# su k8s # åˆ‡æ¢ç”¨æˆ·k8s@master01:/root$ k8s@master01:/root$ cd / # åˆ‡æ¢ç›®å½•k8s@master01:/$ mkdir -p $HOME/.kube #åœ¨å½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹åˆ›å»º.kubeç›®å½•k8s@master01:/$ sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config #å¤åˆ¶configå‘½ä»¤é…ç½®æ–‡ä»¶åˆ°å½“å‰ç”¨æˆ·.kubeç›®å½•ä¸‹k8s@master01:/$ sudo chown $(id -u):$(id -g) $HOME/.kube/config #ä¿®æ”¹configæ–‡ä»¶æƒé™ éƒ¨ç½²ç½‘ç»œæ’ä»¶Step 1: å¯ä»¥ç›´æ¥åœ¨çº¿éƒ¨ç½²(å¦‚æœç½‘ç»œä¸‹è½½ä¸äº†çš„æƒ…å†µä¸‹,ä¹Ÿå¯ä»¥å…ˆè¯•ç”¨æµè§ˆå™¨ä¸‹è½½åä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š)1k8s@master01:/$ kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml Step 2: å¦‚æœä¸Šè¿°æ–¹æ³•è¿˜æ˜¯ä¸è¡Œï¼Œåˆ™å¯ä»¥å°è¯•ä½¿ç”¨æˆ‘çš„1kubectl apply -f https://api.0161.org/resources/kube-flannel.yml Step 3: ä¸Šä¼ å®Œåä¿®æ”¹æ–‡ä»¶çš„å±æ€§ä¿¡æ¯(å¦‚ä¸Šè¿°1,2æ­¥éª¤å·²å®Œæˆåˆ™ç›´æ¥è·³è¿‡)1k8s@master01:/$ sudo chown -Rf k8s.k8s kube-flannel.yml Step 4: ç„¶åæŒ‡å®šæ–‡ä»¶éƒ¨ç½²ç½‘ç»œæ’ä»¶(å¦‚ä¸Šè¿°1,2æ­¥éª¤å·²å®Œæˆåˆ™ç›´æ¥è·³è¿‡)1234567891011k8s@master01:/$ kubectl apply -f kube-flannel.ymlpodsecuritypolicy.policy/psp.flannel.unprivileged createdclusterrole.rbac.authorization.k8s.io/flannel createdclusterrolebinding.rbac.authorization.k8s.io/flannel createdserviceaccount/flannel createdconfigmap/kube-flannel-cfg createddaemonset.apps/kube-flannel-ds-amd64 createddaemonset.apps/kube-flannel-ds-arm64 createddaemonset.apps/kube-flannel-ds-arm createddaemonset.apps/kube-flannel-ds-ppc64le createddaemonset.apps/kube-flannel-ds-s390x created Step 5: æŸ¥çœ‹ç½‘ç»œæ’ä»¶æ˜¯å¦éƒ¨ç½²å®Œæˆ(ä¸‹é¢æœ‰ä¸€ä¸ªå«kube-flannel-ds-amd64çš„Pod)å¦‚æœå‘ç°ä½ çš„ flannel Pod å¤„äº ImagePullBackOff çŠ¶æ€ï¼Œé‚£ä¹ˆå°±æ˜¯ flannel é•œåƒæœªæ‹‰å–æˆåŠŸï¼Œè€Œæ­£å¸¸çš„åˆ™ä¸º RunningçŠ¶æ€12k8s@master01:/$ kubectl get pods -n kube-system | grep flannelkube-flannel-ds-amd64-hx9cr 1/1 Running 0 2m3s Step 6: æŸ¥çœ‹ç›®å‰k8sèŠ‚ç‚¹ä¿¡æ¯123k8s@master01:/$ kubectl get nodesNAME STATUS ROLES AGE VERSIONmaster01 Ready master 65m v1.18.6 å­èŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤masterèŠ‚ç‚¹æŸ¥çœ‹joinå‚æ•°1kubeadm token create --print-join-command å­èŠ‚ç‚¹è¿è¡Œ1kubeadm join master01:6443 --token 8z8ot9.ylyj39j1po0hgyun --discovery-token-ca-cert-hash sha256:e0bb3c41**********************************813c84472f65c 04.png å®‰è£…Dashboardå®˜æ–¹æ–‡æ¡£æ–¹å¼å¯åŠ¨(ä¸å»ºè®®)ä¸ç«¯å£+ipåªèƒ½é€‰æ‹©ä¸€ç§ä½¿ç”¨ï¼ï¼ï¼1kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml å¦‚é‡åˆ°æ— æ³•è®¿é—®æˆ–è€…ç½‘ç»œè¿æ¥é—®é¢˜å¯ä»¥ä½¿ç”¨æˆ‘çš„å¤‡ä»½æ–‡ä»¶1kubectl apply -f https://api.0161.org/resources/recommended.yaml ä»£ç†æ–¹å¼å¯åŠ¨1kubectl proxy 05.png ç«¯å£+IPå¯åŠ¨(æ¨è)ç¯å¢ƒéƒ¨ç½²ä¸‹è½½æ–‡ä»¶1wget https://k8s-1252147235.cos.ap-chengdu.myqcloud.com/dashboard/dashboard.yaml æ‹‰å–é•œåƒ1sudo docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kubernetes-dashboard-amd64:v1.10.1 åˆ›å»ºæœåŠ¡1sudo kubectl apply -f dashboard.yaml æµè§ˆå™¨è¾“å…¥ https://IP:30001 æ‰“å¼€ ï¼ˆå¯ä»¥ä½¿ç”¨Safariæˆ–è€…ç«ç‹ï¼ŒChromeæ— æ³•è®¿é—®ï¼‰ 06.png ç»‘å®šç”¨æˆ·12sudo kubectl create serviceaccount dashboard-admin -n kube-systemkubectl create clusterrolebinding dashboard-admin --clusterrole=cluster-admin --serviceaccount=kube-system:dashboard è·å–Token1kubectl describe secrets -n kube-system $(kubectl -n kube-system get secret | awk &apos;/dashboard-admin/&#123;print $1&#125;&apos;) æŒ‰Tokenå¯åŠ¨ 07.png èµ‹äºˆç”¨æˆ·æƒé™å•å‘½åç©ºé—´æƒé™æ–‡ä»¶åŠç»‘å®šåˆ›å»º role.yaml123456789101112kind: RoleapiVersion: rbac.authorization.k8s.io/v1metadata: namespace: kube-system name: role-dashboard-adminrules:- apiGroups: [&quot;&quot;] resources: [&quot;pods&quot;,&quot;services&quot;] verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]- apiGroups: [&quot;extensions&quot;, &quot;apps&quot;] resources: [&quot;deployments&quot;] verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;, &quot;delete&quot;] åˆ›å»º role-bind.yaml12345678910111213kind: RoleBindingapiVersion: rbac.authorization.k8s.io/v1metadata: name: role-bind-dashboard-admin namespace: kube-systemsubjects:- kind: ServiceAccount name: dashboard-admin namespace: kube-systemroleRef: kind: Role name: role-dashboard-admin apiGroup: rbac.authorization.k8s.io é›†ç¾¤æƒé™é…ç½®åŠç»‘å®šåˆ›å»º cluster-role.yaml12345678kind: ClusterRoleapiVersion: rbac.authorization.k8s.io/v1metadata: name: cluster-role-dashboard-adminrules:- apiGroups: [&quot;&quot;] resources: [&quot;pods&quot;] verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;] åˆ›å»º cluster-role-bind.yaml123456789101112kind: ClusterRoleBindingapiVersion: rbac.authorization.k8s.io/v1metadata: name: cluster-role-bind-dashboard-adminsubjects:- kind: ServiceAccount name: dashboard-admin apiGroup: rbac.authorization.k8s.ioroleRef: kind: ClusterRole name: cluster-role-dashboard-admin apiGroup: rbac.authorization.k8s.io æ‰§è¡Œå‘½ä»¤1234kubectl create -f role.yamlkubectl create -f role-bind.yamlkubectl create -f cluster-role.yamlkubectl create -f cluster-role-bind.yaml å®Œæˆæƒé™é…ç½®ï¼Œå¯æ ¹æ®è‡ªèº«æƒ…å†µå¢åŠ é…ç½®ï¼ å¸¸ç”¨k8så‘½ä»¤ æŸ¥çœ‹podåˆ—è¡¨ 12kubectl get pods --all-namespaces # æŸ¥çœ‹æ‰€æœ‰sudo kubectl get pod -n kube-system # æŸ¥çœ‹æŒ‡å®šå‘½åç©ºé—´ æŸ¥çœ‹serviceåˆ—è¡¨ 1kubectl get service --all-namespaces # æŸ¥çœ‹æ‰€æœ‰ åˆ é™¤æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„service 1kubectl delete service serviceName --namespace=namespaceName åˆ é™¤æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„pod 1kubectl delete pod podName --namespace=namespaceName æŸ¥çœ‹æ‰€æœ‰deployment 1kubectl get deployment -A åˆ é™¤æŒ‡å®šdeployment 1kubectl delete deployment podName æŸ¥çœ‹æŒ‡å®šå‘½åç©ºé—´ç«¯å£ 1sudo kubectl get pod,svc -n kube-system","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://sbcoder.cn/tags/Docker/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/tags/æ¶æ„/"}]},{"title":"RedisæŒä¹…åŒ–åŠæ•°æ®å¤‡ä»½","slug":"RedisæŒä¹…åŒ–åŠæ•°æ®å¤‡ä»½","date":"2020-06-10T08:14:42.000Z","updated":"2020-07-23T07:15:15.894Z","comments":true,"path":"2020/06/10/Redis-Backup.html","link":"","permalink":"https://sbcoder.cn/2020/06/10/Redis-Backup.html","excerpt":"","text":"RedisæŒä¹…åŒ–Redisä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œæ•°æ®çš„å®‰å…¨æ€§ä¸€å®šè¦å¾—åˆ°ç¡®åˆ‡çš„ä¿éšœï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼ŒRedisæ˜¯ä½œä¸ºå­˜å‚¨æ•°æ®åº“æ¥ç”¨çš„ï¼Œå¦‚æœé‡åˆ°æ–­ç”µï¼Œå…³æœºç­‰çªå‘æƒ…å†µï¼Œåˆ™å®¹æ˜“ä¸¢å¤±å…³é”®æ•°æ®ï¼Œå¯¹æ­¤ï¼ŒRedisçš„æŒä¹…åŒ–å°±æ˜¾å¾—å°¤ä¸ºå…³é”®ï¼Œç”šè‡³æŸäº›æƒ…å†µä¸‹ï¼Œéœ€è¦å®šæ—¶å»åšå¤‡ä»½ RDBå¯ä»¥åœ¨æ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡å¤‡ä»½æ“ä½œï¼Œæ€§èƒ½æ¯”AOFæ–¹å¼æ›´å¥½ï¼ŒRDBæ˜¯ç´§å‡‘å‹æ–‡ä»¶ï¼Œä½†æ˜¯æœ€å¤šå¯ä»¥æ‰§è¡Œåˆ°5åˆ†é’Ÿå·¦å³ï¼Œå¦‚æœå†ä½å¯èƒ½ä¼šå½±å“æ€§èƒ½RDBç›¸å½“äº å¤‡ä»½æ•°æ® æ¢å¤æ•°æ®å¿« æ€§èƒ½æ›´å¥½ å¯ä»¥åˆ†æ—¶é—´èŠ‚ç‚¹å¤‡ä»½æ–‡ä»¶ å®¹æ˜“ä¸¢å¤±æ•°æ® AOFå¯ä»¥æŒ‰ç§’çº§å­˜å‚¨æ•°æ®ï¼Œç”±äºé•¿æœŸå­˜å‚¨ï¼Œå¦‚æœå‘ç”Ÿå´©æºƒäº‹ä»¶ï¼Œå®ƒå¯èƒ½åªä¼šä¸¢å¤±å‡ ç§’çš„æ•°æ®ï¼Œç›¸æ¯”è¾ƒæ¥è¯´ï¼Œå¯èƒ½æ›´å®‰å…¨AOFç›¸å½“äº å¤‡ä»½æ‰§è¡Œè¯­å¥ æ•°æ®å®‰å…¨æ€§æ›´é«˜ å­˜å‚¨æ—¶ä¸å ç”¨èµ„æº å¯è‡ªå®š fsync ç­–ç•¥ æ¢å¤é€Ÿåº¦æ…¢ Dockerå®‰è£…12docker pull redis:latestdocker run -itd --name redis01 -p 6379:6379 redis 1.png æœªå®Œï¼ï¼ï¼","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sbcoder.cn/tags/æ•°æ®åº“/"},{"name":"Redis","slug":"Redis","permalink":"https://sbcoder.cn/tags/Redis/"}]},{"title":"MySQLä¸»ä»åŒæ­¥ è¯»å†™åˆ†ç¦» é›†ç¾¤éƒ¨ç½²","slug":"MySQL-ä¸»ä»åŒæ­¥-è¯»å†™åˆ†ç¦»","date":"2020-06-10T06:25:42.000Z","updated":"2020-06-10T06:28:17.018Z","comments":true,"path":"2020/06/10/MySQL-Cluster-MySQLProxy.html","link":"","permalink":"https://sbcoder.cn/2020/06/10/MySQL-Cluster-MySQLProxy.html","excerpt":"","text":"ç®€ä»‹å¯ä»¥ä½¿ç”¨ä¹‹å‰å†™çš„Canalé˜¿é‡Œå·´å·´å¢é‡è®¢é˜…æ›´æ–°åšç®€å•çš„ä¸»ä»å¤‡ä»½ï¼Œç”±äºCanalåªè¯»å– binary log æ—¥å¿—åšå¢é‡æ›´æ–° canalå·¥ä½œæµç¨‹å›¾.png é€šè¿‡canalå¯ä»¥åšç®€å•çš„æŒ‰æ›´æ–°å¤‡ä»½ä¹Ÿå¯ä»¥é€šè¿‡canalåšæ•°æ®æ›´æ–°ï¼Œæ ¹æ®æ›´æ–°çš„å†…å®¹å»æ›´æ–°æ•°æ®åº“ä¸­å…¶ä»–çš„å­—æ®µå€¼ä¹Ÿå¯ä»¥é€šè¿‡canalå®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ç»™ ElasticSearch ç­‰æœåŠ¡ï¼Œé€‚åˆå¤šæ ·åŒ–å¤æ‚çš„MySQLä¸»ä»æ“ä½œé€šè¿‡ä¼ªé€ slaveçš„æ–¹å¼è¯·æ±‚binary logæ¶ˆæ¯ é˜¿é‡Œå·´å·´ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¥½çš„åŸºäºCanalçš„åˆ†å¸ƒå¼æ•°æ®åº“åŒæ­¥ç³»ç»Ÿ otter otterå·¥ä½œåŸç†.jpg æœ¬æ–‡æ‰€ç”¨Dockerç›®çš„æ˜¯ä¸€å°æœºå™¨æå®šé›†ç¾¤åŠŸèƒ½ï¼Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸å»ºè®®ä½¿ç”¨Docker å‚è€ƒé¡¹ç›®ï¼šalibaba/otter - é˜¿é‡Œå·´å·´åˆ†å¸ƒå¼æ•°æ®åº“åŒæ­¥ç³»ç»Ÿ(è§£å†³ä¸­ç¾å¼‚åœ°æœºæˆ¿)alibaba/canal - é˜¿é‡Œå·´å·´ MySQL binlog å¢é‡è®¢é˜…&amp;æ¶ˆè´¹ç»„ä»¶ é€šè¿‡MySQLé…ç½®ä¸»ä»å¤‡ä»½ä¸»ä»å¤‡ä»½ï¼Œé€šè¿‡é…ç½®MySQLåšä¸»ä»å¤‡ä»½ ä¸»ä»å¤‡ä»½æµç¨‹å›¾.jpg æ³¨æ„äº‹é¡¹ ä¸»ä»æ•°æ®åº“ç‰ˆæœ¬ä¿æŒä¸€è‡´ éœ€è¦å•ç‹¬çš„ä¸¤å°æœåŠ¡å™¨ï¼ˆå•å°æœºå™¨å¯ä½¿ç”¨Dockerï¼Œæ²¡æœ‰æµ‹è¯•è¿‡ï¼‰ éœ€è¦ç½‘ç»œç›¸è¿ï¼Œä¿è¯ä¸»ä»æœåŠ¡å™¨é€šä¿¡ è¡¨ç»“æ„ä¸ä½¿ç”¨å¤–é”®ï¼Œä½¿ç”¨å¤–é”®å®¹æ˜“é€ æˆåŒæ­¥å¤±è´¥ ä¸»é”®ä½¿ç”¨æ— æ„ä¹‰è‡ªå¢å­—æ®µ åŒæ­¥æ•°æ®åº“æ‰€ç”¨çš„è´¦å·æ‹¥æœ‰ä¸€å®šçš„æƒé™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨root å®‰è£…MySQLå‚ç…§ä¹‹å‰çš„æ–‡ç«  MySQL Dockerå¯åŠ¨å¯åŠ¨ä¸¤ä¸ªä¸åŒçš„ MySQL æ˜ å°„ä¸åŒçš„ç«¯å£123docker run --restart=always --name mysql5.7-1 -p 3307:3306 -v /Users/XXX/Downloads/Docker/mysql5.7-1:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_cidocker run --restart=always --name mysql5.7 -p 3306:3306 -v /Users/XXX/Downloads/Docker/mysql5.7:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci è¿›å…¥å®¹å™¨å†…éƒ¨ å®‰è£…vim æˆ–è€…æ˜ å°„ ä½¿ç”¨å‚æ•° -v æ˜ å°„ä½ç½® /etc/mysql/my.cnf é…ç½®æ–‡ä»¶äº¦å¯ å®‰è£… vim æ–¹å¼ ç¼–è¾‘ my.cnf12apt-get installapt-get install vim æŒ‚è½½ æœ¬åœ°æ–‡ä»¶ å†…å®¹123456789101112131415161718192021222324# Copyright (c) 2016, Oracle and/or its affiliates. All rights reserved.## This program is free software; you can redistribute it and/or modify# it under the terms of the GNU General Public License, version 2.0,# as published by the Free Software Foundation.## This program is also distributed with certain software (including# but not limited to OpenSSL) that is licensed under separate terms,# as designated in a particular file or component or in included license# documentation. The authors of MySQL hereby grant you an additional# permission to link the program and your derivative works with the# separately licensed software that they have included with MySQL.## This program is distributed in the hope that it will be useful,# but WITHOUT ANY WARRANTY; without even the implied warranty of# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the# GNU General Public License, version 2.0, for more details.## You should have received a copy of the GNU General Public License# along with this program; if not, write to the Free Software# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA!includedir /etc/mysql/conf.d/!includedir /etc/mysql/mysql.conf.d/ é…ç½®ä¸»ä»å¤‡ä»½ä¸»èŠ‚ç‚¹ ä½¿ç”¨root ç”¨æˆ· é…ç½® ä¿®æ”¹é…ç½®æ–‡ä»¶ /etc/mysql/my.cnf123[mysqld]log-bin=mysql-binserver-id=1 æ‰§è¡Œå‘½ä»¤ input123GRANT REPLICATION SLAVE ON *.* to &apos;root&apos;@&apos;%&apos; identified by &apos;123456&apos;;FLUSH PRIVILEGES;SHOW MASTER STATUS; output12345+------------------+----------+--------------+------------------+-------------------+| File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |+------------------+----------+--------------+------------------+-------------------+| mysql-bin.000001 | 589 | | | |+------------------+----------+--------------+------------------+-------------------+ ä»èŠ‚ç‚¹ ä½¿ç”¨root ç”¨æˆ· é…ç½®ä¿®æ”¹é…ç½®æ–‡ä»¶ /etc/mysql/my.cnf123[mysqld]log-bin=mysql-binserver-id=2 æ‰§è¡Œå‘½ä»¤ input123change master to master_host=&apos;172.17.0.2&apos;,master_user=&apos;root&apos;,master_password=&apos;123456&apos;,master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=589;start slave;show slave status\\G; output1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859*************************** 1. row *************************** Slave_IO_State: Waiting for master to send event Master_Host: 172.17.0.2 Master_User: root Master_Port: 3306 Connect_Retry: 60 Master_Log_File: mysql-bin.000001 Read_Master_Log_Pos: 589 Relay_Log_File: f919535d2d58-relay-bin.000002 Relay_Log_Pos: 320 Relay_Master_Log_File: mysql-bin.000001 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: Replicate_Ignore_DB: Replicate_Do_Table: Replicate_Ignore_Table: Replicate_Wild_Do_Table: Replicate_Wild_Ignore_Table: Last_Errno: 0 Last_Error: Skip_Counter: 0 Exec_Master_Log_Pos: 589 Relay_Log_Space: 534 Until_Condition: None Until_Log_File: Until_Log_Pos: 0 Master_SSL_Allowed: No Master_SSL_CA_File: Master_SSL_CA_Path: Master_SSL_Cert: Master_SSL_Cipher: Master_SSL_Key: Seconds_Behind_Master: 0Master_SSL_Verify_Server_Cert: No Last_IO_Errno: 0 Last_IO_Error: Last_SQL_Errno: 0 Last_SQL_Error: Replicate_Ignore_Server_Ids: Master_Server_Id: 1 Master_UUID: 380e925e-a645-11ea-a304-0242ac110004 Master_Info_File: /var/lib/mysql/master.info SQL_Delay: 0 SQL_Remaining_Delay: NULL Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates Master_Retry_Count: 86400 Master_Bind: Last_IO_Error_Timestamp: Last_SQL_Error_Timestamp: Master_SSL_Crl: Master_SSL_Crlpath: Retrieved_Gtid_Set: Executed_Gtid_Set: Auto_Position: 0 Replicate_Rewrite_DB: Channel_Name: Master_TLS_Version:1 row in set (0.00 sec) æµ‹è¯• åˆ›å»ºä¸€ä¸ª testæ•°æ®åº“ ä¸»ä»æ•°æ®åº“åŒæ­¥.png ç›‘æ§çŠ¶æ€å¯ä»¥ä½¿ç”¨crontab é…åˆé’‰é’‰é€šçŸ¥ ä½¿ç”¨ curlå‘½ä»¤é€šçŸ¥ ä¸»ä»åŒæ­¥æ˜¯å¦æˆåŠŸ 12345678# !/bin/basharray=($(mysql -uroot -p -e \"show slave status\\G\" | grep \"Running\" | awk '&#123;print $2&#125;'))if [ \"$&#123;array[0]&#125;\" == \"Yes\" ] || [ \"$&#123;array[1]&#125;\" == \"Yes\" ] then echo \"Slave is OK\" else echo \"Slave is error\"fi è¯»å†™åˆ†ç¦»masteræ•°æ®åº“å¤„ç†å†™æ“ä½œï¼Œslaveæ•°æ®åº“å¤„ç†è¯»æ“ä½œã€‚åˆ©ç”¨ä¸Šé¢é…ç½®çš„ä¸»ä»æ•°æ®åº“ï¼Œä½¿masteræ•°æ®åº“çš„å˜æ›´å®æ—¶æ›´æ–°åˆ°slaveèŠ‚ç‚¹ä¸Šï¼Œæ”¯æŒäº‹åŠ¡ï¼Œä½†å¯èƒ½ä¼šå› ä¸ºæŸäº›åŸå› æœ‰é˜»å¡ç°è±¡å‘ç”Ÿï¼Œä¸å¯é¿å…çš„å¯èƒ½ä¼šå‡ºç°æ•°æ®åŒæ­¥æ…¢çš„æƒ…å†µ è¯»å†™åˆ†ç¦».png ä½¿ç”¨ MySQLProxy åšè¯»å†™åˆ†ç¦» MySQLProxyå®é™…ä¸Šæ˜¯åœ¨å®¢æˆ·ç«¯è¯·æ±‚ä¸MySQLServerä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªè¿æ¥æ± ã€‚æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚éƒ½æ˜¯å‘å‘MySQLProxyï¼Œç„¶åç»ç”±MySQLProxyè¿›è¡Œç›¸åº”çš„åˆ†æï¼Œåˆ¤æ–­å‡ºæ˜¯è¯»æ“ä½œè¿˜æ˜¯å†™æ“ä½œï¼Œåˆ†å‘è‡³å¯¹åº”çš„MySQLServerä¸Šã€‚å¯¹äºå¤šèŠ‚ç‚¹Slaveé›†ç¾¤ï¼Œä¹Ÿå¯ä»¥èµ·åšåˆ°è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚ MySQLProxy.png ä¸ºä½•è¦ä½¿ç”¨MySQLProxyï¼Ÿå…¶å®å¯ä»¥ä¸ä½¿ç”¨ï¼Œä½†ä¸ºäº†å‡å°‘ä»£ç é‡ï¼Œå‡å°‘å¼€å‘æˆæœ¬ï¼Œå¯ä»¥é€šè¿‡è¿ç»´çš„æ‰‹æ®µå»åšåˆ†å‘å¤„ç†ã€‚å¸¸è§çš„å¼€å‘æ¡†æ¶å®é™…ä¸Šå¾ˆå¤šæ˜¯æ”¯æŒè¯»å†™åˆ†ç¦»æ“ä½œä¸åŒæ•°æ®åº“çš„ï¼Œè€Œä»£ç†æœåŠ¡å™¨åšçš„åˆ™æ˜¯å°†è¿™äº›æ¡†æ¶å°è£…å¥½çš„ä¸œè¥¿é€šè¿‡ä»£ç†åˆ†å‘çš„æ–¹å¼ï¼Œåˆ†åˆ«ç»™ä¸åŒçš„æ•°æ®åº“å‘é€è¯·æ±‚ï¼Œä¸»åº“åªä¿®æ”¹ï¼Œä»åº“åªè¯» ç¼ºç‚¹ ç›®å‰MySQLProxyä»ç„¶æ˜¯ alphaï¼ˆå†…æµ‹ï¼‰ ç‰ˆ é€šè¿‡luaè„šæœ¬åšçš„è¯»å†™åˆ†ç¦»ï¼ŒMySQLå®˜æ–¹å¹¶ä¸å»ºè®®ä½¿ç”¨ é…ç½®MySQLProxyè¯»å†™åˆ†ç¦»å‡å®š ä¸Šè¿°ä¸¤å°æœåŠ¡å™¨ åˆ†åˆ«ä¸º master slave é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨éœ€è¦ç¬¬ä¸‰å°æœåŠ¡å™¨ proxyproxyéœ€è¦åšä¸­è½¬ä»£ç†ï¼Œå°†æ¥æ”¶åˆ°çš„æ•°æ®åº“è¯·æ±‚åˆ†åˆ«æŒ‡å‘ master å’Œ slave ä¸‹è½½ MySQLProxyä¸‹è½½åœ°å€ï¼šMySQL Product Archives ç”±äºæˆ‘çš„ç¯å¢ƒä¸ºMACæ–°ç‰ˆï¼Œå¯¹ MySQLProxy çš„æ”¯æŒåº¦å¹¶ä¸å¥½ï¼Œå› æ­¤å¹¶ä¸åœ¨æœ¬æœºä½¿ç”¨å¯ä»¥å‚ç…§ä¸‹é¢å¼•ç”¨çš„æ–‡ç« å‚è€ƒé…ç½® å‚è€ƒæ–‡ç«  Mysql ä¸»ä»å¤‡ä»½å®Œæ•´ç‰ˆ MySQLä¸»ä»å¤‡ä»½é…ç½® MySQLè¯»å†™åˆ†ç¦»ä»‹ç»åŠæ­å»º MySQL Proxy","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://sbcoder.cn/tags/MySQL/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://sbcoder.cn/tags/è¿ç»´/"}]},{"title":"ElasticSearch & ELKæ—¥å¿—åˆ†æ ä»é›¶å¼€å§‹æ­å»ºåˆ°ä½¿ç”¨","slug":"ElasticSearch-Kibana-ä»é›¶å¼€å§‹æ­å»ºåˆ°ä½¿ç”¨","date":"2020-05-27T12:34:16.000Z","updated":"2020-06-04T08:31:49.232Z","comments":true,"path":"2020/05/27/ELK_Stack.html","link":"","permalink":"https://sbcoder.cn/2020/05/27/ELK_Stack.html","excerpt":"","text":"å¼•è¨€ä»‹ç»åŸºäºLuceneçš„æœç´¢æœåŠ¡å™¨ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäºRESTful webæ¥å£ã€‚æ›´é€‚ç”¨äºé›†ç¾¤éƒ¨ç½²ï¼Œé€‚åˆå„ç±» åˆ†è¯ï¼Œå…¨æ–‡æœç´¢ï¼Œé€šè¿‡å»ºç«‹ç´¢å¼•ï¼ˆåˆ†ç‰‡ï¼ŒæŒ‰èŠ‚ç‚¹åˆ†ç‰‡ï¼‰æ¥å®ç°æ›´å¿«çš„æœç´¢Elasticsearchæ˜¯ä¸Logstashçš„æ•°æ®æ”¶é›†å’Œæ—¥å¿—è§£æå¼•æ“ä»¥åŠKibanaçš„åˆ†æå’Œå¯è§†åŒ–å¹³å°ä¸€èµ·å¼€å‘çš„ã€‚è¿™ä¸‰ä¸ªäº§å“è¢«è®¾è®¡æˆä¸€ä¸ªé›†æˆè§£å†³æ–¹æ¡ˆï¼Œç§°ä¸ºâ€œElastic Stackâ€ï¼ˆä»¥å‰ç§°ä¸ºâ€œELK stackâ€ï¼‰ã€‚æœ¬æ–‡åªåšå•èŠ‚ç‚¹è¿è¡Œ ELK.png å®˜æ–¹ä»‹ç» Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œèƒ½å¤Ÿè§£å†³ä¸æ–­æ¶Œç°å‡ºçš„å„ç§ç”¨ä¾‹ã€‚ ä½œä¸º Elastic Stack çš„æ ¸å¿ƒï¼Œå®ƒé›†ä¸­å­˜å‚¨æ‚¨çš„æ•°æ®ï¼Œå¸®åŠ©æ‚¨å‘ç°æ„æ–™ä¹‹ä¸­ä»¥åŠæ„æ–™ä¹‹å¤–çš„æƒ…å†µã€‚ æ³¨æ„äº‹é¡¹ å•ç‚¹æœåŠ¡å™¨ç»´æŒç¨³å®šå¯èƒ½éœ€è¦å¸¸é©»å†…å­˜ 4G ä»¥ä¸Š å•ç‚¹ELKç»´æŒç¨³å®šå¯èƒ½éœ€è¦CPU 4æ ¸å¿ƒ ä»¥ä¸Š å‚è€ƒæ–‡ç«  Dockerå®‰è£…éƒ¨ç½²ELKæ•™ç¨‹ (Elasticsearch+Kibana+Logstash+Filebeat) é›¶é—¨æ§›ï¼åŸºäºDockerå¿«é€Ÿéƒ¨ç½²ESé›†ç¾¤ ä¸‹è½½é›†ç¾¤æ‰€éœ€é•œåƒ zookeeper kafka12docker pull zookeeperdocker pull wurstmeister/kafka å•èŠ‚ç‚¹æ— å†…ç½‘IPä½¿ç”¨1docker network create elkwork åˆ›å»ºå†…éƒ¨ç½‘ç»œååœ¨æ¯æ¬¡ docker run çš„æ—¶å€™ å¢åŠ å‚æ•° --net elkwork elasticç›¸å…³ æ—§ç‰ˆæœ¬ 123docker pull docker.elastic.co/elasticsearch/elasticsearch:5.6.8docker pull docker.elastic.co/kibana/kibana:5.6.8docker pull docker.elastic.co/logstash/logstash:5.6.8 æ–°ç‰ˆæœ¬ 1234docker pull docker.elastic.co/elasticsearch/elasticsearch:7.7.0docker pull docker.elastic.co/kibana/kibana:7.7.0docker pull docker.elastic.co/logstash/logstash:7.7.0docker pull store/elastic/filebeat:7.7.0 å¯åŠ¨elasticsearch è‡ªè¡Œæ›¿æ¢ç‰ˆæœ¬&quot;discovery.type=single-node&quot; å•èŠ‚ç‚¹1docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; docker.elastic.co/elasticsearch/elasticsearch:5.6.8 é»˜è®¤ç”¨æˆ·å é»˜è®¤å¯†ç elastic changeme æµ‹è¯•æ˜¯å¦å·²ç»è¿é€š-u elastic:changeme éªŒæƒ1curl -u elastic:changeme localhost:9200 æµè§ˆå™¨ç«¯å£è®¿é—®æµ‹è¯• elasticsearch.png elasticsearch å„ç±»è¯­æ³•åŸºæœ¬æµè§ˆå™¨è®¿é—®http://xxx.xx.xxx.xx:9200/_cat/indices?v æŸ¥çœ‹å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ Indexhttp://xxx.xx.xxx.xx:9200/_mapping?pretty=true åˆ—å‡ºæ¯ä¸ª Index æ‰€åŒ…å«çš„ Type éªŒæƒæœºåˆ¶å¢åŠ å‚æ•° -u elastic:changeme éªŒæƒ å‘½ä»¤è¡Œè®¿é—®curl -u elastic:changeme -X PUT &#39;localhost:9200/weather&#39; å¯ä»¥ç›´æ¥å‘ Elastic æœåŠ¡å™¨å‘å‡º PUT è¯·æ±‚curl -u elastic:changeme -X DELETE &#39;localhost:9200/weather&#39; å‘å‡º DELETE è¯·æ±‚ï¼Œåˆ é™¤è¿™ä¸ª Index æ’å…¥æ•°æ®123456curl -X POST &apos;localhost:9200/account/person&apos; -d &apos;&#123; &quot;user&quot;: &quot;æå››&quot;, &quot;title&quot;: &quot;å·¥ç¨‹å¸ˆ&quot;, &quot;desc&quot;: &quot;ç³»ç»Ÿç®¡ç†&quot;&#125;&apos; è¯»å–æ•°æ®1curl &apos;localhost:9200/account/person/1?pretty=true&apos; ç¤ºä¾‹ 123456789101112&#123; \"_index\" : \"accounts\", \"_type\" : \"person\", \"_id\" : \"1\", \"_version\" : 1, \"found\" : true, \"_source\" : &#123; \"user\" : \"å¼ ä¸‰\", \"title\" : \"å·¥ç¨‹å¸ˆ\", \"desc\" : \"æ•°æ®åº“ç®¡ç†\" &#125;&#125; åˆ é™¤è®°å½•1curl -X DELETE &apos;localhost:9200/accounts/person/1&apos; æ›´æ–°è®°å½•123456curl -X PUT &apos;localhost:9200/accounts/person/1&apos; -d &apos;&#123; &quot;user&quot; : &quot;å¼ ä¸‰&quot;, &quot;title&quot; : &quot;å·¥ç¨‹å¸ˆ&quot;, &quot;desc&quot; : &quot;æ•°æ®åº“ç®¡ç†ï¼Œè½¯ä»¶å¼€å‘&quot;&#125;&apos; è¿”å›æ‰€æœ‰è®°å½•1curl &apos;localhost:9200/accounts/person/_search&apos; ç´¢å¼• ï¼š/Index/Type/_search totalï¼šè¿”å›è®°å½•æ•°ï¼Œæœ¬ä¾‹æ˜¯2æ¡ã€‚ max_scoreï¼šæœ€é«˜çš„åŒ¹é…ç¨‹åº¦ï¼Œæœ¬ä¾‹æ˜¯1.0ã€‚ hitsï¼šè¿”å›çš„è®°å½•ç»„æˆçš„æ•°ç»„ã€‚ æŸ¥è¯¢è®°å½•123456curl &apos;localhost:9200/accounts/person/_search&apos; -d &apos;&#123; &quot;query&quot; : &#123; &quot;match&quot; : &#123; &quot;desc&quot; : &quot;è½¯ä»¶ ç³»ç»Ÿ&quot; &#125;&#125;, &quot;from&quot;: 1 &quot;size&quot;: 1&#125;&apos; size è¿”å›æ•°é‡ from å¼€å§‹ä½ç½® ORæœç´¢ï¼Œå½“å‰æœç´¢çš„ç¤ºä¾‹æ˜¯ è½¯ä»¶æˆ–ç³»ç»Ÿ ANDæœç´¢ç¤ºä¾‹12345678910&#123; &quot;query&quot;: &#123; &quot;bool&quot;: &#123; &quot;must&quot;: [ &#123; &quot;match&quot;: &#123; &quot;desc&quot;: &quot;è½¯ä»¶&quot; &#125; &#125;, &#123; &quot;match&quot;: &#123; &quot;desc&quot;: &quot;ç³»ç»Ÿ&quot; &#125; &#125; ] &#125; &#125;&#125; å‚è€ƒæ–‡ç«  å…¨æ–‡æœç´¢å¼•æ“ Elasticsearch å…¥é—¨æ•™ç¨‹ å¯åŠ¨kibana è‡ªè¡Œæ›¿æ¢ç‰ˆæœ¬1docker run -d --name kibana -p 8001:5601 docker.elastic.co/kibana/kibana:5.6.8 kibana å®¹å™¨å†…éƒ¨ä¿®æ”¹é…ç½®ip1Vi ./config/kibana.yml é‡å¯å®¹å™¨ä½¿é…ç½®ç”Ÿæ•ˆ kibana.png é…ç½® logstash123mkdir /home/tjy/docker/logstash/mkdir /home/tjy/docker/logstash/conf.d/vi /home/tjy/docker/logstash/logstash.yml 12path.config: /usr/share/logstash/conf.d/*.confpath.logs: /var/log/logstash 1vi /home/tjy/docker/logstash/conf.d/test.conf 123456789101112131415input &#123; beats &#123; port =&gt; 5044 codec =&gt; &quot;json&quot;&#125;&#125;output &#123; elasticsearch &#123; hosts =&gt; [&quot;xxx.xx.xxx.xx:9200&quot;] user =&gt; elastic password =&gt; changeme &#125; stdout &#123; codec =&gt; rubydebug &#125;&#125; å¯åŠ¨logstashå¹¶æŒ‚è½½1docker run -it -d -p 8011:5044 -p 9600:9600 --name logstash -v /home/tjy/docker/logstash/logstash.yml:/usr/share/logstash/config/logstash.yml -v /home/tjy/docker/logstash/conf.d/:/usr/share/logstash/conf.d/ docker.elastic.co/logstash/logstash:5.6.8 é…ç½® filebeatä¸‹è½½ é€šç”¨é…ç½®æ–‡ä»¶ 1234mkdir /Users/XXX/Downloads/Docker/filebeat/cd /Users/XXX/Downloads/Docker/filebeatwget https://raw.githubusercontent.com/elastic/beats/7.1/deploy/docker/filebeat.docker.ymlvi filebeat.docker.yml é…ç½®ç›‘å¬ Nginx log 123456789101112131415161718192021filebeat.config: modules: path: $&#123;path.config&#125;/modules.d/*.yml reload.enabled: falsefilebeat.autodiscover: providers: - type: docker hints.enabled: trueprocessors:- add_cloud_metadata: ~filebeat.inputs:- type: log enabled: true paths: - /var/log/nginx/*.logoutput.logstash: hosts: [&apos;logstash:5044&apos;] filebeat é…åˆ logstash æŒ‚è½½å¹¶å¯åŠ¨ä»¥ä¸‹æ˜ å°„çš„è·¯å¾„ä¸ºæˆ‘è‡ªå·±ç”µè„‘çš„è·¯å¾„ï¼Œéœ€è¦è‡ªè¡Œä¿®æ”¹ï¼1docker run --name filebeat --user=root -d --net elkwork -v /usr/local/var/log/nginx/:/var/log/nginx/ -v /Users/XXX/Downloads/Docker/filebeat/filebeat.docker.yml:/usr/share/filebeat/filebeat.yml -v /var/run/docker.sock:/var/run/docker.sock store/elastic/filebeat:7.7.0 success.png","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://sbcoder.cn/tags/ElasticSearch/"},{"name":"kibana","slug":"kibana","permalink":"https://sbcoder.cn/tags/kibana/"},{"name":"Logstash","slug":"Logstash","permalink":"https://sbcoder.cn/tags/Logstash/"}]},{"title":"Docker å®‰è£… PHP-fpm","slug":"Docker-å®‰è£…-PHP-fpm","date":"2020-05-17T04:54:47.000Z","updated":"2020-06-05T09:10:42.132Z","comments":true,"path":"2020/05/17/Docker_PHP_fpm.html","link":"","permalink":"https://sbcoder.cn/2020/05/17/Docker_PHP_fpm.html","excerpt":"","text":"åˆ›å»º uploads.ini12345file_uploads = Onmemory_limit = 64 Mupload_max_filesize = 20Mpost_max_size = 20Mmax_execution_time = 600 åˆ›å»º Dockerfile1234567891011121314151617FROM php:7.3-fpmRUN apt-get updateRUN apt-get install -y libwebp-dev libjpeg-dev libpng-dev libfreetype6-devEXPOSE 9000#ä¸Šä¼ é…ç½®æˆ20MCOPY uploads.ini /usr/local/etc/php/conf.dRUN docker-php-ext-install mysqliRUN docker-php-ext-install pdoRUN docker-php-ext-install pdo_mysqlRUN pecl install redis-4.2.0 &amp;&amp; docker-php-ext-enable redisRUN docker-php-ext-install bcmathRUN docker-php-ext-configure gd --with-webp-dir=/usr/include/webp --with-png-dir=/usr/include --with-jpeg-dir=/usr/include --with-freetype-dir=/usr/include/freetype2RUN docker-php-ext-install gd Docker build1docker build -t ai0by/php-fpm73:v1 . è¿è¡Œå®¹å™¨æŒ‚è½½ç‰©ç†æœºå†…å®¹åˆ° å®¹å™¨å†…éƒ¨ å¯ä»¥ä¿®æ”¹ä¸‹æ–¹çš„ /var/www/html/workspace ä¸ºä½ çš„é¡¹ç›®åœ°å€ 1docker run -v /var/www/html/workspace:/var/www/html/workspace -p 9002:9000 -d php73:0.1 Nginxé…ç½®ä¿®æ”¹ fastcgi_pass åé¢çš„ å€¼ä¸º 127.0.0.1:9002 LNMPç”¨æˆ· ä¿®æ”¹ /usr/local/nginx/conf/enable-php-pathinfo.conf å°† fastcgi_pass unix:/tmp/php-cgi.sock; ä¿®æ”¹ä¸º fastcgi_pass 127.0.0.1:9002; å…¶ä»–ç¯å¢ƒä¸æ­¤ç±»ä¼¼ï¼Œç›´æ¥æ”¹å³å¯ MySQL Dockerå¯åŠ¨è‡ªè¡Œä¿®æ”¹ æŒ‚è½½è·¯å¾„ ä»¥åŠ å¯†ç 1docker run --restart=always --name mysql5.7 -p 3306:3306 -v /Users/XXX/Downloads/Docker/mysql5.7:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci Nginx ä¸ªäººä¸ä¹ æƒ¯æ‰”Dockerä¸­ï¼Œå› æ­¤æš‚æ—¶ä¸ç®¡","categories":[{"name":"PHP","slug":"PHP","permalink":"https://sbcoder.cn/categories/PHP/"}],"tags":[{"name":"fpm","slug":"fpm","permalink":"https://sbcoder.cn/tags/fpm/"},{"name":"nginx","slug":"nginx","permalink":"https://sbcoder.cn/tags/nginx/"}]},{"title":"Workerman é€‚åˆPHPerä½¿ç”¨çš„Socketé€šè®¯æ¡†æ¶","slug":"Workerman-é€‚åˆPHPerä½¿ç”¨çš„Socketé€šè®¯æ¡†æ¶","date":"2020-05-14T13:48:33.000Z","updated":"2020-05-14T13:51:53.699Z","comments":true,"path":"2020/05/14/workerman.html","link":"","permalink":"https://sbcoder.cn/2020/05/14/workerman.html","excerpt":"","text":"ç®€ä»‹é€‚ç”¨äº å®¢æˆ·ç«¯-æœåŠ¡ç«¯ å®¢æˆ·ç«¯-å®¢æˆ·ç«¯ ä¸€å¯¹å¤š å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå¤šä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„é•¿è¿æ¥é€šä¿¡ï¼ŒèŠå¤©å®¤ï¼Œåœ¨çº¿å®¢æœï¼ŒæœåŠ¡ç«¯åå‘æ¨é€æ’­æŠ¥æ¶ˆæ¯ ç‰¹æ€§ï¼šå¤šè¿›ç¨‹ï¼Œé•¿è¿æ¥ï¼Œé«˜å¹¶å‘ï¼Œå¸¸é©»å†…å­˜â€¦ å®¢æˆ·ç«¯ä¸workerè¿›ç¨‹ å®¢æˆ·ç«¯ä¸workerè¿›ç¨‹.png ä¸»è¿›ç¨‹ä¸workerå­è¿›ç¨‹ ä¸»è¿›ç¨‹ä¸workerå­è¿›ç¨‹.png ä½¿ç”¨Workermanå¯ä»¥åšå¾ˆå¤šæœ‰è¶£çš„äº‹ã€‚ï¼ˆå·¥ä¸šè‡ªåŠ¨åŒ–ï¼Œäº’è”ç½‘å·¥ä¸šï¼ŒPLCæœºæ¢°æŠ¥è­¦â€¦ï¼‰ï¼Œé€šè¿‡é•¿è¿æ¥å–æ•°æ®ï¼Œæ“ä½œæ•°æ®ç­‰ï¼Œä½†PHPå¹¶ä¸é€‚ç”¨äºå·¥ä¸šé¢†åŸŸã€‚åšä¸€ä¸ªä»¿imèŠå¤©å·¥å…·ï¼Œé™¤äº†å‰ç«¯å±•ç¤ºç•Œé¢ï¼Œåç«¯ä¹Ÿè¦è€ƒè™‘å…¨é¢ï¼Œæ›´å¤šçš„ä¾èµ–äºé•¿è¿æ¥ã€‚ æœ¬æ–‡å‚è€ƒ workermanå®˜æ–¹æ–‡æ¡£æœ¬æ–‡å‚è€ƒ thinksocketio - åŸºäºsocketioçš„èŠå¤©å®¤Demo å®‰è£…Workermanæ¡†æ¶æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ æˆ‘è¿™é‡Œä½¿ç”¨ testWebSocket12mkdir testWebSocketcd testWebSocket gitå½¢å¼å®‰è£…(æ¨è)1git clone https://github.com/walkor/Workerman æ ¹æ®å®˜æ–¹æ–‡æ¡£åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ åœ¨ testWebSocket ä¸‹åˆ›å»ºä¸€ä¸ª PHPæ–‡ä»¶ test.php12345678910111213141516171819&lt;?phpuse Workerman\\Worker;require_once __DIR__ . '/Workerman/Autoloader.php';// æ³¨æ„ï¼šè¿™é‡Œä¸ä¸Šä¸ªä¾‹å­ä¸åŒï¼Œä½¿ç”¨çš„æ˜¯websocketåè®®$ws_worker = new Worker(\"websocket://0.0.0.0:2000\");// å¯åŠ¨4ä¸ªè¿›ç¨‹å¯¹å¤–æä¾›æœåŠ¡$ws_worker-&gt;count = 4;// å½“æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®åè¿”å›hello $dataç»™å®¢æˆ·ç«¯$ws_worker-&gt;onMessage = function($connection, $data)&#123; // å‘å®¢æˆ·ç«¯å‘é€hello $data $connection-&gt;send('hello ' . $data);&#125;;// è¿è¡ŒworkerWorker::runAll() å‰ç«¯æµ‹è¯•å‰ç«¯æµ‹è¯•ä¾‹å­ä»£ç  ç›´æ¥åœ¨Googleæµè§ˆå™¨æ‰§è¡Œ123456789ws = new WebSocket(\"ws://127.0.0.1:2000\");ws.onopen = function() &#123; alert(\"è¿æ¥æˆåŠŸ\"); ws.send('tom'); alert(\"ç»™æœåŠ¡ç«¯å‘é€ä¸€ä¸ªå­—ç¬¦ä¸²ï¼štom\");&#125;;ws.onmessage = function(e) &#123; alert(\"æ”¶åˆ°æœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼š\" + e.data);&#125;; æ•ˆæœå±•ç¤º æ‰§è¡Œç•Œé¢.png æœåŠ¡ç«¯ç•Œé¢.png Workermenæ¡†æ¶æ”¯æŒçš„åè®®1234567891011$websocket_worker = new Worker('websocket://0.0.0.0:2345');// textåè®®$text_worker = new Worker('text://0.0.0.0:2346');// frameåè®®$frame_worker = new Worker('frame://0.0.0.0:2347');// tcp Workerï¼Œç›´æ¥åŸºäºsocketä¼ è¾“ï¼Œä¸ä½¿ç”¨ä»»ä½•åº”ç”¨å±‚åè®®$tcp_worker = new Worker('tcp://0.0.0.0:2348');// udp Workerï¼Œä¸ä½¿ç”¨ä»»ä½•åº”ç”¨å±‚åè®®$udp_worker = new Worker('udp://0.0.0.0:2349');// unix domain Workerï¼Œä¸ä½¿ç”¨ä»»ä½•åº”ç”¨å±‚åè®®$unix_worker = new Worker('unix:///tmp/wm.sock'); æ•´åˆThinkPHPè¯´æ˜Workermenæ˜¯ä¸€ä¸ªæˆç†Ÿçš„å•ç‹¬æ¡†æ¶ï¼Œåœ¨ThinkPHPä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨Composerå®‰è£…å¯¹åº”çš„æ‰©å±•æ¥ä½¿ç”¨ï¼Œè¿™é‡Œä½¿ç”¨äº†é’ˆå¯¹PHPå¼€å‘çš„æ‰©å±• PHPSocket.IOã€‚PHPSocket.IOè®¾è®¡çš„ç›®æ ‡æ˜¯åˆ©ç”¨PHPæ„å»ºèƒ½å¤Ÿåœ¨ä¸åŒæµè§ˆå™¨å’Œç§»åŠ¨è®¾å¤‡ä¸Šè‰¯å¥½è¿è¡Œçš„å®æ—¶åº”ç”¨ï¼Œå¦‚å®æ—¶åˆ†æç³»ç»Ÿã€åœ¨çº¿èŠå¤©å®¤ã€åœ¨çº¿å®¢æœç³»ç»Ÿã€è¯„è®ºç³»ç»Ÿã€WebIMç­‰ã€‚ PHPSocket.IOä¸workermançš„åŒºåˆ«æ˜¯ï¼ŒPHPSocket.IOåŸºäºworkermanå¼€å‘ï¼Œworkermanæœ‰çš„ç‰¹æ€§PHPSocket.IOéƒ½æ”¯æŒã€‚ PHPSocket.IOæœ€å¤§çš„ä¼˜åŠ¿æ˜¯å¯¹å„ç§æµè§ˆå™¨çš„å…¼å®¹æ€§æ›´å¥½ã€‚ å®‰è£…åŠå¼•ç”¨ä½¿ç”¨Composer å®‰è£…å¯¹åº”çš„æ‰©å±•1composer require workerman/phpsocket.io åœ¨ç¼–è¾‘ä»£ç æ—¶å¼•ç”¨å¯¹åº”çš„æ‰©å±•å³å¯12use Workerman\\Worker;use PHPSocketIO\\SocketIO; æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯ application\\socketio\\controller\\server.php12345678910111213141516171819202122232425262728293031&lt;?phpnamespace app\\socketio\\controller;use Workerman\\Worker;use PHPSocketIO\\SocketIO;use think\\Db;class Server&#123; public function index()&#123; // åœ¨2021ç«¯å£åˆ›å»ºæœåŠ¡ $io = new SocketIO(2021); $io-&gt;on('connection', function($socket)use($io)&#123; $socket-&gt;on('chat message', function($msg)use($io)&#123; $io-&gt;emit('chat message', $msg); &#125;); // ç›‘å¬åˆ°æ–°çš„å®¢æˆ·ç«¯è¿æ¥å³åœ¨æœåŠ¡ç«¯è¾“å‡º'new connection' echo 'new connection'.\"\\n\"; // å¹¶å‘æœåŠ¡ç«¯å‘é€'è¿æ¥æˆåŠŸ' $socket-&gt;emit('success', 'è¿æ¥æˆåŠŸ'); // æœåŠ¡ç«¯å‘é€æ¶ˆæ¯è¿‡æ¥ $socket-&gt;on('sendMsg', function($msg)use($io)&#123; // åœ¨æœåŠ¡ç«¯è¾“å‡ºæ¶ˆæ¯ echo $msg.\"\\n\"; // åœ¨æ”¶åˆ°çš„æ¶ˆæ¯å‰é¢æ‹¼æ¥'æ”¶åˆ°'åå‘å®¢æˆ·ç«¯å‘é€å›å» $io-&gt;emit('sendMsg', 'æ”¶åˆ°\"'.$msg.'\"'); &#125;); &#125;); // å¯åŠ¨æœåŠ¡ Worker::runAll(); &#125;&#125; ç”±äº Workermen æ˜¯ä¸€ä¸ªç‹¬ç«‹äºPHPç¨‹åºä½¿ç”¨çš„å•ä¸€æ–‡ä»¶ï¼Œéœ€è¦å•ç‹¬ç”¨ä¸€ä¸ªå‘½ä»¤è¡Œæ¥å¯åŠ¨çš„ï¼Œä»–å®Œå…¨å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼Œå› æ­¤å¹¶ä¸æ¨èä½¿ç”¨TPæ¡†æ¶æ¥æ•´åˆï¼Œä½†å¦‚æœæœ‰è¿™ä¸ªéœ€æ±‚ï¼Œä¹Ÿå¯ä»¥åœ¨ /publicç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶æ¥ç»‘å®šæ§åˆ¶å™¨ï¼Œä¾‹å¦‚ç»‘å®š åˆ° socketio/Serveråˆ›å»ºæ–‡ä»¶ public/server.php , è¾“å…¥ä»¥ä¸‹å†…å®¹123456789&lt;?php// [ åº”ç”¨å…¥å£æ–‡ä»¶ ]namespace think;// åŠ è½½åŸºç¡€æ–‡ä»¶require __DIR__ . '/../thinkphp/base.php';// æ‰§è¡Œåº”ç”¨å¹¶å“åº”ï¼ˆç»‘å®šï¼‰Container::get('app')-&gt;bind('socketio/Server')-&gt;run()-&gt;send(); æ‰§è¡Œæ—¶ ç›´æ¥åœ¨Shellä¸­è¿è¡Œè¯¥PHPæ–‡ä»¶å³å¯ï¼Œå‰©ä¸‹çš„äº¤ç»™TPçš„æœºåˆ¶12cd /publicphp server.php æ‰§è¡Œç»“æœ.png ç»“è¯­æ ¹æ®é€šä¿¡è¡Œä¸ºå¯ä»¥è¡ç”Ÿå‡ºå„ç±»åº”ç”¨ï¼Œç›®å‰websocketå·²ç»æ˜¯å„å¤§å…¬å¸éƒ½éœ€è¦çš„æŠ€æœ¯ï¼Œä¼šwebsocketå°±å¤šäº†ä¸€ä»½æœºä¼šï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://sbcoder.cn/categories/PHP/"}],"tags":[{"name":"socket","slug":"socket","permalink":"https://sbcoder.cn/tags/socket/"},{"name":"é€šè®¯","slug":"é€šè®¯","permalink":"https://sbcoder.cn/tags/é€šè®¯/"},{"name":"workerman","slug":"workerman","permalink":"https://sbcoder.cn/tags/workerman/"}]},{"title":"UnblockNeteaseMusic è§£é”ç½‘æ˜“äº‘éŸ³ä¹ç°è‰²æ­Œæ›²","slug":"UnblockNeteaseMusic-è§£é”ç½‘æ˜“äº‘éŸ³ä¹ç°è‰²æ­Œæ›²","date":"2020-05-09T13:52:19.000Z","updated":"2020-05-09T13:53:34.444Z","comments":true,"path":"2020/05/09/UnblockNeteaseMusic.html","link":"","permalink":"https://sbcoder.cn/2020/05/09/UnblockNeteaseMusic.html","excerpt":"","text":"Docker å®‰è£…è¿è¡ŒæœåŠ¡ç«¯åŸºäºnondanee/UnblockNeteaseMusicçš„éŸ³ä¹è§£é”ä»£ç†æœåŠ¡ 1docker run --name=unblockneteasemusic -d -p 8888:8080 nondanee/unblockneteasemusic æ—¥å¿—ç•Œé¢ é…ç½®å®¢æˆ·ç«¯ å¹³å° åŸºç¡€è®¾ç½® Windows è®¾ç½® &gt; å·¥å…· &gt; è‡ªå®šä¹‰ä»£ç† (å®¢æˆ·ç«¯å†…) UWP Windows è®¾ç½® &gt; ç½‘ç»œå’Œ Internet &gt; ä»£ç† Linux ç³»ç»Ÿè®¾ç½® &gt; ç½‘ç»œ &gt; ç½‘ç»œä»£ç† macOS ç³»ç»Ÿåå¥½è®¾ç½® &gt; ç½‘ç»œ &gt; é«˜çº§ &gt; ä»£ç† Android WLAN &gt; ä¿®æ”¹ç½‘ç»œ &gt; é«˜çº§é€‰é¡¹ &gt; ä»£ç† iOS æ— çº¿å±€åŸŸç½‘ &gt; HTTP ä»£ç† &gt; é…ç½®ä»£ç† Windowsé…ç½®æˆªå›¾ å°†ipè®¾ç½®ä¸ºæœåŠ¡å™¨ipå³å¯ï¼Œæ˜ å°„å†…éƒ¨çš„8080åˆ°å¤–éƒ¨8888ç«¯å£ æ•ˆæœ å½“æ’­æ”¾æˆ–è€…ä¸‹è½½æ—¶ï¼Œæ—¥å¿—ä¼šè®°å½•ï¼Œè§£æè¿‡ç¨‹","categories":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"https://sbcoder.cn/categories/æŠ˜è…¾/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://sbcoder.cn/tags/Docker/"},{"name":"éŸ³ä¹","slug":"éŸ³ä¹","permalink":"https://sbcoder.cn/tags/éŸ³ä¹/"}]},{"title":"Aria2 + Rclone + Goindex å®ç°ç¦»çº¿ä¸‹è½½åœ¨çº¿è§‚çœ‹","slug":"Aria2-Rclone-Goindex-å®ç°ç¦»çº¿ä¸‹è½½åœ¨çº¿è§‚çœ‹","date":"2020-01-21T23:32:33.000Z","updated":"2020-01-23T00:48:01.000Z","comments":true,"path":"2020/01/22/aria_goindex.html","link":"","permalink":"https://sbcoder.cn/2020/01/22/aria_goindex.html","excerpt":"","text":"å‡†å¤‡å·¥ä½œ äº‘é˜€ 5R NATå°é¸¡ Google Drive è´¦å·ä¸€æš CloudFlare è´¦å· å…³äºäº‘é˜€çš„å°é¸¡ï¼Œæ€§ä»·æ¯”é«˜ï¼Œåªæä¾›ipv6å’Œipv4ç«¯å£ï¼Œå› æ­¤ä¸‹é¢çš„æ•™ç¨‹å¯èƒ½æŸäº›åœ°æ–¹åšäº†å¤šä½™çš„åŠ¨ä½œï¼Œä¾‹å¦‚ä¿®æ”¹ç«¯å£å·ç­‰ å®‰è£…Aria2ä¸€é”®è„šæœ¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤1wget -N git.io/aria2.sh &amp;&amp; chmod +x aria2.sh &amp;&amp; ./aria2.sh è¿›å…¥ä¸‹è½½è„šæœ¬çš„ç›®å½•è¿è¡Œè„šæœ¬123456789101112131415161718192021222324252627./aria2.shAria2 ä¸€é”®å®‰è£…ç®¡ç†è„šæœ¬ [vX.X.X]-- P3TERX.COM --1. å‡çº§è„šæœ¬â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”1. å®‰è£… Aria22. æ›´æ–° Aria23. å¸è½½ Aria2â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”4. å¯åŠ¨ Aria25. åœæ­¢ Aria26. é‡å¯ Aria2â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”7. ä¿®æ”¹ é…ç½®8. æŸ¥çœ‹ é…ç½®9. æŸ¥çœ‹ æ—¥å¿—10. æ¸…ç©º æ—¥å¿—â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”11. æ‰‹åŠ¨æ›´æ–° BT-Tracker12. è‡ªåŠ¨æ›´æ–° BT-Trackerâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å½“å‰çŠ¶æ€: å·²å®‰è£… å¹¶ å·²å¯åŠ¨è¯·è¾“å…¥æ•°å­— [0-12]: è¾“å…¥ 1 å›è½¦ 1.png ç­‰å¾…å®‰è£…å®Œæˆ å†æ‰§è¡Œ1./aria2.sh è¾“å…¥ 7 å›è½¦ 2.png å¦‚éœ€è¦å¯ä¿®æ”¹ RPC å¯†ç ï¼Œä¹Ÿå»ºè®®ä¿®æ”¹ å®‰è£… LNMP ä¸€é”®å®‰è£…åŒ… / Nginxæˆ‘è¿™é‡Œå®‰è£…LNMPï¼Œå…¶å®åªéœ€è¦ Nginxå°±è¡Œäº†å®‰è£…æ•™ç¨‹å‚è€ƒ å®‰è£… - LNMPä¸€é”®å®‰è£…åŒ… æˆ–è€… ç›´æ¥æ‰§è¡Œ1wget http://soft.vpser.net/lnmp/lnmp1.6.tar.gz -cO lnmp1.6.tar.gz &amp;&amp; tar zxf lnmp1.6.tar.gz &amp;&amp; cd lnmp1.6 &amp;&amp; ./install.sh lnmp æˆ‘è¿™é‡Œå®‰è£…çš„æ˜¯ 1.6 ï¼Œå¯è‡ªè¡Œä¿®æ”¹ç‰ˆæœ¬å· å®‰è£… Aria2NG ç•Œé¢ç®¡ç†æ‰“å¼€åœ°å€ Releases Â· mayswind/AriaNgé€‰æ‹©æœ€æ–°ç‰ˆæœ¬ä¸‹è½½åˆ° ç½‘ç«™ ç›®å½•ä¸‹ï¼Œå¦‚æœä¸çŸ¥é“ç½‘ç«™ç›®å½•é…ç½®ï¼Œå»ºè®®å­˜æ”¾åœ¨ LNMPçš„é»˜è®¤ç›®å½• /home/wwwroot/ æŒ‰ç…§å¦‚ä¸‹æ“ä½œ12345mkdir /home/wwwroot/Xcd /home/wwwroot/Xwget https://github.com/mayswind/AriaNg/releases/download/1.1.4/AriaNg-1.1.4.zipunzip AriaNg-1.1.4.ziprm AriaNg-1.1.4.zip é…ç½® Nginx12cd /usr/local/nginx/conf/vhost/vi X.conf è¾“å…¥ä»¥ä¸‹é…ç½®123456789101112131415161718192021222324252627282930313233343536373839404142server &#123; listen 10002 default_server reuseport; #listen [::]:80 default_server ipv6only=on; server_name _; index index.html index.htm index.php; root /home/wwwroot/x; #error_page 404 /404.html; # Deny access to PHP files in specific directory #location ~ /(wp-content|uploads|wp-includes|images)/.*\\.php$ &#123; deny all; &#125; include enable-php.conf; location /nginx_status &#123; stub_status on; access_log off; &#125; location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$ &#123; expires 30d; &#125; location ~ .*\\.(js|css)?$ &#123; expires 12h; &#125; location ~ /.well-known &#123; allow all; &#125; location ~ /\\. &#123; deny all; &#125; access_log /home/wwwlogs/access.log; &#125; ä¸»è¦å°±æ˜¯æŠŠç«¯å£æ”¹ä¸º 10002ï¼Œå…¶ä»–çš„å°±æ˜¯lnmpé»˜è®¤é…ç½®ä¸åŠ¨ é…ç½®å®Œæ¯•åï¼Œæ‰“å¼€ ç½‘å€ http://virt-nat-eu-1.cloudraft.cn:1XXX5å°†XXæ›¿æ¢æˆä½ çš„ å†…ç½‘IPæœ€åä¸€ä½ ä¾‹å¦‚ 2 åˆ™è®¿é—® http://virt-nat-eu-1.cloudraft.cn:10025 3.png ç‚¹å‡» Aria2NGé…ç½® - RPC(XXXX) 4.png ä¿®æ”¹ RPC åˆ«å RPC åœ°å€ RPC ç§˜é’¥å…¶ä»–ä¸åŠ¨ï¼ŒæŒ‰å›¾å¡«å†™å³å¯ å…è´¹ç”³è¯·ä¸€ä¸ªGoogleæ— é™å›¢é˜Ÿç›˜æ‰“å¼€åœ°å€ åˆ›å»ºGoogle TeamDriveGmailå¿…é¡»å¡«å†™æ­£ç¡®ï¼ ç­‰å¾…åˆ›å»ºå³å¯ï¼ å®‰è£…Rcloneæ‰§è¡Œ12curl https://rclone.org/install.sh | sudo bashrclone config é…ç½®è¯´æ˜å¦‚ä¸‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148e) Edit existing remoten) New remoted) Delete remoter) Rename remotec) Copy remotes) Set configuration passwordq) Quit confige/n/d/r/c/s/q&gt; n # é€‰æ‹©nï¼Œæ–°å»ºname&gt; Google # è¾“å…¥åç§°ï¼Œç±»ä¼¼äºæ ‡ç­¾ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„ç½‘ç›˜ã€‚Type of storage to configure.Enter a string value. Press Enter for the default (&quot;&quot;).Choose a number from below, or type in your own value 1 / A stackable unification remote, which can appear to merge the contents of several remotes \\ &quot;union&quot; 2 / Alias for a existing remote \\ &quot;alias&quot; 3 / Amazon Drive \\ &quot;amazon cloud drive&quot; 4 / Amazon S3 Compliant Storage Providers (AWS, Ceph, Dreamhost, IBM COS, Minio) \\ &quot;s3&quot; 5 / Backblaze B2 \\ &quot;b2&quot; 6 / Box \\ &quot;box&quot; 7 / Cache a remote \\ &quot;cache&quot; 8 / Dropbox \\ &quot;dropbox&quot; 9 / Encrypt/Decrypt a remote \\ &quot;crypt&quot;10 / FTP Connection \\ &quot;ftp&quot;11 / Google Cloud Storage (this is not Google Drive) \\ &quot;google cloud storage&quot;12 / Google Drive \\ &quot;drive&quot;13 / Hubic \\ &quot;hubic&quot;14 / JottaCloud \\ &quot;jottacloud&quot;15 / Local Disk \\ &quot;local&quot;16 / Mega \\ &quot;mega&quot;17 / Microsoft Azure Blob Storage \\ &quot;azureblob&quot;18 / Microsoft OneDrive \\ &quot;onedrive&quot;19 / OpenDrive \\ &quot;opendrive&quot;20 / Openstack Swift (Rackspace Cloud Files, Memset Memstore, OVH) \\ &quot;swift&quot;21 / Pcloud \\ &quot;pcloud&quot;22 / QingCloud Object Storage \\ &quot;qingstor&quot;23 / SSH/SFTP Connection \\ &quot;sftp&quot;24 / Webdav \\ &quot;webdav&quot;25 / Yandex Disk \\ &quot;yandex&quot;26 / http Connection \\ &quot;http&quot;Storage&gt; 12 # é€‰æ‹©12ï¼ŒGoogle Drive** See help for drive backend at: https://rclone.org/drive/ **Google Application Client IdLeave blank normally.Enter a string value. Press Enter for the default (&quot;&quot;).client_id&gt; # ç•™ç©ºï¼Œå›è½¦Google Application Client SecretLeave blank normally.Enter a string value. Press Enter for the default (&quot;&quot;).client_secret&gt; # ç•™ç©ºï¼Œå›è½¦Scope that rclone should use when requesting access from drive.Enter a string value. Press Enter for the default (&quot;&quot;).Choose a number from below, or type in your own value 1 / Full access all files, excluding Application Data Folder. \\ &quot;drive&quot; 2 / Read-only access to file metadata and file contents. \\ &quot;drive.readonly&quot; / Access to files created by rclone only. 3 | These are visible in the drive website. | File authorization is revoked when the user deauthorizes the app. \\ &quot;drive.file&quot; / Allows read and write access to the Application Data folder. 4 | This is not visible in the drive website. \\ &quot;drive.appfolder&quot; / Allows read-only access to file metadata but 5 | does not allow any access to read or download file content. \\ &quot;drive.metadata.readonly&quot;scope&gt; 1ID of the root folderLeave blank normally.Fill in to access &quot;Computers&quot; folders. (see docs).Enter a string value. Press Enter for the default (&quot;&quot;).root_folder_id&gt; # ç•™ç©ºï¼Œå›è½¦Service Account Credentials JSON file pathLeave blank normally.Needed only if you want use SA instead of interactive login.Enter a string value. Press Enter for the default (&quot;&quot;).service_account_file&gt;Edit advanced config? (y/n)y) Yesn) Noy/n&gt; nRemote configUse auto config? * Say Y if not sure * Say N if you are working on a remote or headless machine or Y didn&apos;t worky) Yesn) Noy/n&gt; nIf your browser doesn&apos;t open automatically go to the following link: https://accounts.google.com/o/oauth2/auth?access_type=offline&amp;client_id=XXXXXXXXXXX.apps.googleusercontent.com&amp;redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&amp;response_type=code&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&amp;state=XXXXXXXXXXXXXXXXXXXXLog in and authorize rclone for access # ä¼šå¼¹å‡ºæµè§ˆå™¨ï¼Œè¦æ±‚ä½ ç™»å½•è´¦å·è¿›è¡Œæˆæƒã€‚å¦‚æœæ²¡æœ‰å¼¹å‡ºï¼Œå¤åˆ¶ä¸Šé¢çš„é“¾æ¥åˆ°æµè§ˆå™¨ä¸­æ‰“å¼€è¿›è¡Œæˆæƒã€‚Enter verification code&gt; # åœ¨è¿™é‡Œè¾“å…¥ç½‘é¡µä¸Šæ˜¾ç¤ºçš„éªŒè¯ç Configure this as a team drive?y) Yesn) Noy/n&gt; yFetching team drive list...No team drives found in your account--------------------[Google]type = drivescope = drivetoken = &#123;&quot;access_token&quot;:&quot;XXXXXXXXXXXXXXXXXXXXX&quot;&#125;--------------------y) Yes this is OKe) Edit this remoted) Delete this remotey/e/d&gt; yCurrent remotes:Name Type==== ====Google driveOne onedrivee) Edit existing remoten) New remoted) Delete remoter) Rename remotec) Copy remotes) Set configuration passwordq) Quit confige/n/d/r/c/s/q&gt; q å‚è€ƒ:P3TERX - Rclone å®‰è£…é…ç½®æ•™ç¨‹ - è¿æ¥ OneDrive å’Œ Google Drive é…ç½® Aira2 è‡ªåŠ¨ä¸Šä¼ æ‰§è¡Œ æŒ‰å›¾ä¿®æ”¹1vi /root/.aria2/autoupload.sh 5.png æ‰§è¡Œ æŒ‰å›¾ä¿®æ”¹1vi /root/.aria2/aria2.conf 6.png é‡å¯ Aria21service aria2 restart ä½¿ç”¨Goindex + CloudFlareæä¸€ä¸ªåœ¨çº¿è§‚çœ‹å®˜æ–¹è¯´æ˜ donwa/Github å¤åˆ¶ index.js é‡Œé¢çš„ä»£ç  æ‰“å¼€ CloudFlare ï¼Œåˆ›å»ºWorkers 7.png å°†ä¸Šé¢å¤åˆ¶çš„å†…å®¹é»è´´åˆ°Scriptä¸­ æ‰§è¡Œ å¹¶ æŸ¥çœ‹ rclone.conf è·¯å¾„ã€‚1rclone config file 8.png å¤åˆ¶ root_folder_id å’Œ refresh_token çš„å€¼å¡«å…¥ CloudFlare Workers Scriptå¯¹åº”çš„ä»£ç ä½ç½®é‡Œé¢ 9.png é…ç½®å¥½åç‚¹å‡»ä¿å­˜ï¼Œç„¶åæ‰“å¼€CloudFlare Workersæä¾›çš„åŸŸåå³å¯çœ‹åˆ°å¯¹åº”çš„ç½‘ç›˜å†…å®¹ ä½œè€…åšå®¢ é£å‘æ ‡åšå®¢","categories":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"https://sbcoder.cn/categories/æŠ˜è…¾/"}],"tags":[{"name":"ç¦»çº¿ä¸‹è½½","slug":"ç¦»çº¿ä¸‹è½½","permalink":"https://sbcoder.cn/tags/ç¦»çº¿ä¸‹è½½/"},{"name":"Google","slug":"Google","permalink":"https://sbcoder.cn/tags/Google/"}]},{"title":"Canal æ ¹æ® binlogæ—¥å¿—æ•°æ®åŒæ­¥","slug":"Canal-æ ¹æ®-binlogæ—¥å¿—æ•°æ®åŒæ­¥","date":"2020-01-21T23:32:09.000Z","updated":"2020-01-21T23:33:46.000Z","comments":true,"path":"2020/01/22/canal_go.html","link":"","permalink":"https://sbcoder.cn/2020/01/22/canal_go.html","excerpt":"","text":"åˆ›å»ºmysqlè´¦æˆ·å¦‚æœä½¿ç”¨çš„æ˜¯rootç”¨æˆ·ï¼Œåˆ™ä¸éœ€è¦æ“ä½œè¿™ä¸ªæ­¥éª¤ grant all privileges on . to â€˜jccâ€™@â€™%â€™ identified by â€˜jccâ€™;flush privileges; é…ç½®mysql (å‚è§canal Quickstart)å¯ç”¨binlogæ—¥å¿—æ‰“å¼€ mysql.cnf æ–‡ä»¶1234[mysqld] log-bin=mysql-bin binlog-format=ROW #é€‰æ‹©rowæ¨¡å¼ server_id=9527 #é…ç½®mysql replactionéœ€è¦å®šä¹‰ï¼Œä¸èƒ½å’Œcanalçš„slaveIdé‡å¤ æ·»åŠ slaveæƒé™å¦‚æœä½¿ç”¨çš„æ˜¯rootç”¨æˆ·ï¼Œåˆ™ä¸éœ€è¦æ“ä½œè¿™ä¸ªæ­¥éª¤12CREATE USER canal IDENTIFIED BY 'canal'; GRANT SELECT, SHOW VIEW, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';FLUSH PRIVILEGES; åˆ›å»ºcanal server æœåŠ¡ç«¯éœ€è¦æå‰å®‰è£…å¥½Dockerï¼Œå¦‚æœä¸ä¼šå®‰è£…ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„æ–‡ç«  CentOS7 å®‰è£… Docker 1docker run -p 11111:11111 -e canal.auto.scan=false -e canal.instance.master.address=127.0.0.1:3306 -e canal.instance.dbUsername=test -e canal.instance.dbPassword=test -e canal.instance.connectionCharset=UTF-8 -e canal.instance.tsdb.enable=true -e canal.instance.gtidon=false -e canal.instance.filter.regex=.*\\\\..* -e canal.destinations=test -d canal/canal-server éœ€è¦æ›¿æ¢ä»¥ä¸‹å‚æ•° canal.instance.master.address=127.0.0.1:3306 åœ°å€ipæ›´æ¢ï¼ˆå°½é‡ç”¨å†…ç½‘ï¼‰ canal.instance.dbUsername=test æ•°æ®åº“è´¦æˆ· canal.instance.dbPassword=test æ•°æ®åº“å¯†ç  canal.destinations=test testä¸ºåç§° å¯ä»¥ä¿®æ”¹ 11111:11111 æœåŠ¡å™¨ç«¯å£ï¼šdockerç«¯å£ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰€å¡«å†™çš„æ•°æ®åº“è´¦æˆ·å¿…é¡»æ‹¥æœ‰æ•°æ®åº“çš„æ“ä½œæƒé™ï¼Œå¦‚æœä¸çŸ¥é“æƒé™å¦‚ä½•é…ç½®ï¼Œåˆ™å»ºè®®ç›´æ¥ä½¿ç”¨rootç”¨æˆ· canal å®¢æˆ·ç«¯æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Goå®¢æˆ·ç«¯ï¼Œå› ä¸ºGoè¯­è¨€çš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½çš„è¿è¡Œåœ¨Dockerä¸Š canal-go æ–‡æ¡£: withlin/canal-go å¼€å‘è¿‡ç¨‹å¯ä»¥å‚ç…§æ–‡æ¡£ Dockerå¯åŠ¨canalå®¢æˆ·ç«¯æ¨èä½¿ç”¨Jenkinsé…ç½® canal-goæ„å»ºæˆåŠŸåæ‰§è¡Œshell 12docker build -t canal_prod:v1 $&#123;WORKSPACE&#125;docker service update --image canal_prod:v1 --force --no-resolve-image canal_prod å¦‚æœçœ‹è¿‡æˆ‘ä¹‹å‰çš„ ä»£ç æ¶æ„æ–‡ç« ï¼Œå¯ä»¥åœ¨Portainerä¸­çœ‹åˆ°æ‰“å°åœ¨æ§åˆ¶å°çš„æ–‡å­—ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°è¿è¡ŒçŠ¶æ€ FAQé—®é¢˜è§£å†³Q:å¦‚æœæœåŠ¡åœæ­¢äº†ï¼Œå¦‚ä½•è§£å†³A:é“¾æ¥åˆ°canal-serverçš„Dockerå†…éƒ¨ï¼ŒæŸ¥çœ‹ canal-server - logs ä¸­çš„æ—¥å¿— Q:å¦‚æœæ•°æ®åŒæ­¥å¤±è´¥äº†å¦‚ä½•è§£å†³A:å¾ˆå¤§å¯èƒ½æ˜¯ç”±äºæ”¹å˜äº†æ•°æ®åº“ç»“æ„å¯¼è‡´çš„ï¼Œéœ€è¦é‡å¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°è¯• Q:ä¸€å¼€å§‹æ•°æ®å°±ä¸åŒæ­¥A:æŸ¥çœ‹ä½ çš„æ•°æ®åº“è´¦æˆ·æ˜¯å¦æœ‰æƒé™ï¼Œå¦‚æ— æƒé™åˆ™ä¿®æ”¹æœåŠ¡ç«¯å¯åŠ¨æ—¶é™„å¸¦çš„æ•°æ®åº“è´¦æˆ·å‚æ•°","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://sbcoder.cn/tags/æ•°æ®åº“/"},{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"}]},{"title":"ThinkPHPä½¿ç”¨RabbitMQè¿›è¡Œæ•°æ®è§£è€¦ ä»å®‰è£…åˆ°ç›‘å¬å®Œå…¨ç‰ˆ","slug":"ThinkPHPä½¿ç”¨RabbitMQè¿›è¡Œæ•°æ®è§£è€¦-ä»å®‰è£…åˆ°ç›‘å¬å®Œå…¨ç‰ˆ","date":"2020-01-07T15:32:40.000Z","updated":"2020-01-07T15:33:42.000Z","comments":true,"path":"2020/01/07/rabbitmq_thinkphp.html","link":"","permalink":"https://sbcoder.cn/2020/01/07/rabbitmq_thinkphp.html","excerpt":"","text":"ä»‹ç»åˆ†å¸ƒå¼éƒ¨ç½²ï¼ŒRabbitMQ(ç®€ç§°MQ)ä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©ï¼Œå¯ä»¥å®ç°å¼‚æ­¥äº’ä¸å¹²æ‰°çš„è§£è€¦æ“ä½œã€‚ è§£å†³éœ€æ±‚å½“æœ‰ä¸¤å¥—ç³»ç»Ÿåˆ†åˆ«éƒ¨ç½²æ—¶ï¼Œéœ€è¦åŒæ­¥ä¸€éƒ¨åˆ†æ•°æ®ï¼Œæˆ–è€…éœ€è¦äº’ä¸å¹²æ‰°è§£å†³å¼‚æ­¥ç‹¬ç«‹è¿è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨RebbitMQæ¥ç»™ä¸¤å¥—ç³»ç»Ÿè§£è€¦ï¼Œä½¿ç”¨RebbitMQä½œä¸ºä¸­é—´ä»¶ï¼Œåªåšæ¶ˆæ¯ä¼ è¾“ä½¿ç”¨ï¼Œå½“ç³»ç»ŸAå®•æœºæˆ–è€…å› æ•…éšœæ— æ³•ä½¿ç”¨æ—¶ï¼Œä¸ä¼šå½±å“åˆ°ç³»ç»ŸBçš„æ­£å¸¸è¿è¡Œï¼ éƒ¨ç½²MQä½¿ç”¨Dockeréƒ¨ç½²ï¼Œå®‰è£…Dockerå¯ä»¥å‚ç…§ä¹‹å‰å†™çš„ CentOS7 å®‰è£… Dockerï¼Œæˆ–è€…Ubuntu16.04/Ubuntu18.04 å®‰è£… Dockerã€‚ ä¸‹è½½é•œåƒé•œåƒåœ°å€ rabbitmq1docker pull rabbitmq:management 1.png 1234# åˆ›å»ºå®¹å™¨å¹¶è¿è¡Œdocker run -d -p 5672:5672 -p 15672:15672 --name rabbitmq rabbitmq:management# æŸ¥çœ‹ å½“å‰è¿è¡Œçš„å®¹å™¨docker ps 2.png é…ç½®MQå®‰è£…MQæ‰“å¼€ http://IP:15672 3.png ä½¿ç”¨é»˜è®¤ç”¨æˆ·åå¯†ç ç™»å½•username:guest password:guest 4.png çº¢æ¡†å†…ä¸ºä½ çš„rabbitmqç‰ˆæœ¬å·ï¼Œæˆ‘è¿™é‡Œæ˜¯3.8.2 åˆ›å»ºä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ· 5.png ä¿®æ”¹guestçš„å¯†ç ï¼Œè¯·å°†123456ä¿®æ”¹ä¸ºä½ éœ€è¦ä¿®æ”¹çš„å¯†ç 123docker exec -it rabbitmq /bin/bashrabbitmqctl list_usersrabbitmqctl change_password guest &apos;123456&apos; ä¿®æ”¹guesté»˜è®¤å¯†ç ä»¥é˜²æ­¢è¢«äººæ¶æ„åˆ©ç”¨ 6.png åˆ›å»ºé˜Ÿåˆ—åŠäº¤æ¢æœºåˆ›å»ºé˜Ÿåˆ—å¯ä»¥åœ¨mqé¡µç«¯åˆ›å»ºä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­è‡ªåŠ¨åˆ›å»ºï¼Œæˆ‘è¿™é‡Œç›´æ¥åœ¨é¡µç«¯åˆ›å»º åˆ›å»ºQueen åˆ›å»ºäº¤æ¢æœºï¼Œä¹Ÿåœ¨é¡µç«¯åˆ›å»ºå¥½ åˆ›å»ºExchange ThinkPHPå®ç°è¿‡ç¨‹Composerå®‰è£…php-amqplibç•¥ ç”Ÿäº§è€…å®ç° åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€…ç±»æ”¾ç½®äº common ç›®å½•ä¸‹ï¼Œæ–¹ä¾¿è°ƒç”¨ 123456789101112131415161718192021222324252627282930313233343536class RabbitMq&#123; protected $connection; protected $channel; //protected $exchange = 'router'; // //protected $queue = 'msgs'; public function __construct()&#123; $this-&gt;connection = new AMQPStreamConnection(config('rabbit_mq.host'), config('rabbit_mq.port'), config('rabbit_mq.user'), config('rabbit_mq.password')); $this-&gt;channel = $this-&gt;connection-&gt;channel(); &#125; /* * å‘é˜Ÿåˆ—å‘é€ä¿¡æ¯ï¼ˆç”Ÿäº§è€…ï¼‰ * $data å‘é˜Ÿåˆ—å‘é€å‚æ•° * $code è·¯ç”±å * $queue ä¸»é¢˜ * */ public function send($data,$exchange,$routing_key='order')&#123;// $this-&gt;channel-&gt;queue_declare($this-&gt;queue, false, true, false, false);// $this-&gt;channel-&gt;exchange_declare($this-&gt;exchange, AMQPExchangeType::DIRECT, false, true, false);// $this-&gt;channel-&gt;queue_bind($this-&gt;queue, $this-&gt;exchange); $messageBody = json_encode($data);//å°†è¦å‘é€æ•°æ®å˜ä¸ºjsonå­—ç¬¦ä¸² $message = new AMQPMessage($messageBody, array('content_type' =&gt; 'text/plain', 'delivery_mode' =&gt; AMQPMessage::DELIVERY_MODE_PERSISTENT)); $this-&gt;channel-&gt;basic_publish($message,$exchange,$routing_key); $this-&gt;stop(); &#125; //å…³é—­è¿›ç¨‹ public function stop()&#123; $this-&gt;channel-&gt;close(); $this-&gt;connection-&gt;close(); &#125;&#125; å®ç°è¿‡ç¨‹å¦‚ä¸‹ 123456789101112131415161718192021222324252627class RabbitMq extends controller&#123; private $rabbitMq; /** * Unit constructor. * @param Request $request * @throws \\think\\db\\exception\\DataNotFoundException * @throws \\think\\db\\exception\\ModelNotFoundException * @throws \\think\\exception\\DbException */ public function __construct(Request $request)&#123; parent::__construct(); $this-&gt;rabbitMq = new \\app\\common\\RabbitMq(); &#125; /** * æ·»åŠ  * @throws \\think\\db\\exception\\DataNotFoundException * @throws \\think\\db\\exception\\ModelNotFoundException * @throws \\think\\exception\\DbException */ public function add()&#123; $params = $this-&gt;request-&gt;param(); $this-&gt;rabbitMq-&gt;send($params,'testMq'); &#125;&#125; æ¶ˆè´¹è€…å®ç° åˆ›å»ºä¸€ä¸ªRabbitMqç±»,æ–¹ä¾¿ä¹‹åè°ƒç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768class RabbitMq extends controller&#123; protected $connection; protected $channel; protected $exchange; // protected $queue; protected $vhost; protected $consumerTag; protected $routeKey; // æ­¤å¤„ä½¿ç”¨é…ç½®æ–‡ä»¶é…ç½®ï¼Œå…·ä½“å¯è‡ªè¡Œé…ç½® public function __construct() &#123; //è¿æ¥RabbitMQ $this-&gt;queue = Config::get('database.RabbitMQ')['queue']; $this-&gt;exchange = Config::get('database.RabbitMQ')['exchange']; $this-&gt;vhost = Config::get('database.RabbitMQ')['vhost']; $this-&gt;consumerTag = 'AgentOrder'; $this-&gt;routeKey = 'addOrderAndSub'; $host = Config::get('database.RabbitMQ')['host']; $port = Config::get('database.RabbitMQ')['port']; $username = Config::get('database.RabbitMQ')['username']; $password = Config::get('database.RabbitMQ')['password']; $this-&gt;connection = new AMQPStreamConnection($host, $port, $username, $password); $this-&gt;channel = $this-&gt;connection-&gt;channel(); $this-&gt;logMqWright('MQå·²è¿æ¥'); &#125; // æ¶ˆè´¹ä¿¡æ¯ public function getMessage($callback) &#123; // é˜Ÿåˆ—å£°æ˜ï¼Œåˆ›å»ºé˜Ÿåˆ—ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºï¼Œå¦‚å·²åˆ›å»ºåˆ™ä¸éœ€è¦ä½¿ç”¨ // $this-&gt;channel-&gt;queue_declare($this-&gt;queue, false, true, false, false); // ç»‘å®šäº¤æ¢æœº $this-&gt;channel-&gt;exchange_declare($this-&gt;exchange, 'direct', false, true, false); $this-&gt;logMqWright('---MQäº¤æ¢æœºç»‘å®šå®Œæˆ---'); // ç»‘å®šé˜Ÿåˆ— $this-&gt;channel-&gt;queue_bind($this-&gt;queue, $this-&gt;exchange, $this-&gt;routeKey); $this-&gt;logMqWright('---MQé˜Ÿåˆ—ç»‘å®šå®Œæˆ---'); // ä¿¡æ¯æ¶ˆè´¹ï¼Œno_ack ä¸ºtrueæ—¶ä¸ºè‡ªåŠ¨åº”ç­” $this-&gt;channel-&gt;basic_consume($this-&gt;queue, $this-&gt;consumerTag, false, true, false, false, $callback); $i = 0; while (count($this-&gt;channel-&gt;callbacks)) &#123; $this-&gt;logMqWright('---MQæ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡[' . $i . ']---'); $i++; $this-&gt;channel-&gt;wait(); &#125; &#125; // æ—¥å¿—å†™å…¥å‡½æ•° ç›®å½•/runtime/agent_log/å½“å‰å¹´æœˆ/å½“å‰æ—¥æœŸMQ.txt protected function logMqWright($msg) &#123; $val = \"\"; $currentDateTime = date('Y-m-d H:i:s', time()); $currentDate = date('Ymd', time()); $fileDir = __DIR__ . '/../../runtime/' . 'agentlog/' . date('Ym', time()); if (!file_exists($fileDir)) &#123; mkdir($fileDir, 0777, true); &#125; $fileName = $fileDir . '/' . $currentDate . \"MQ.txt\";//æ–‡ä»¶åç§° $data = fopen($fileName, 'a+');//æ·»åŠ ä¸è¦†ç›–ï¼Œé¦–å…ˆä¼šåˆ¤æ–­è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥æ–‡ä»¶ï¼Œå³æ¯å¤©éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶è®°å½•çš„ä¿¡æ¯ $val = '[' . $currentDateTime . ']:' . $msg; $val .= \"\\n\"; fwrite($data, $val);//å†™å…¥æ–‡æœ¬ä¸­ &#125; //å…³é—­è¿›ç¨‹ public function stop() &#123; $this-&gt;channel-&gt;close(); $this-&gt;connection-&gt;close(); &#125;&#125; æ¶ˆè´¹è€…æ¶ˆè´¹è¿‡ç¨‹ 1234567891011// CLIæ¥å£,éœ€è¦å¼€å¯å®ˆæŠ¤è¿›ç¨‹ public function catch() &#123; //è¿æ¥RabbitMQ $RabbitMq = new \\app\\common\\RabbitMq();//é˜Ÿåˆ— $this-&gt;logAgentWrite('------------------MQé“¾æ¥æˆåŠŸ å¼€å§‹æ•´ç†MQæ¶ˆæ¯------------------'); $callback = function ($msg) &#123; echo $msg; // msgä¸ºé˜Ÿåˆ—å†…çš„ä¿¡æ¯æµï¼Œåœ¨æ­¤å¤„å¡«å†™æ¶ˆè´¹è¿‡ç¨‹å³å¯ &#125;; $RabbitMq-&gt;getMessage($callback); &#125; æ¶ˆè´¹è€…åˆ›å»ºç›‘å¬æ¥å£ï¼Œç”¨äºå®ˆæŠ¤è¿›ç¨‹è°ƒç”¨ 12345678class MqService&#123; public function __construct() &#123; &#125; public function mqAction() &#123; $this-&gt;catch(); // è°ƒç”¨ä¸Šé¢çš„catchå‡½æ•°ï¼Œè‡ªè¡Œä¿®æ”¹ &#125;&#125; è‡³æ­¤æ‰€éœ€è¦çš„ä»£ç å°±å®Œæˆäº† æ¶ˆè´¹è€…è„šæœ¬å®ˆæŠ¤è¿›ç¨‹tips:åªé€‚ç”¨äºLinux æˆ‘ä»¬åœ¨ä½¿ç”¨PHPä½œä¸ºæ¶ˆè´¹è€…æ—¶ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨PHPç›´æ¥æ‰§è¡Œæ–‡ä»¶ï¼Œä½¿ç”¨nohupå®ˆæŠ¤è¿›ç¨‹è°ƒç”¨ï¼Œä½†æ˜¯å½“ç³»ç»Ÿä¸ç¨³å®šæ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å„ç§é—®é¢˜å¯¼è‡´mqé˜Ÿåˆ—å¤±æ•ˆï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨è„šæœ¬ç›‘å¬ï¼Œå¦‚æœå®ˆæŠ¤è¿›ç¨‹ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨é‡å¯å®ˆæŠ¤è¿›ç¨‹ é¦–å…ˆæµ‹è¯•æ—¶å¯ä»¥å…ˆæ‰§è¡Œå®ˆæŠ¤è¿›ç¨‹å‘½ä»¤ï¼Œä¾‹å¦‚1nohup /usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction &amp; è·¯å¾„è¯·è‡ªè¡Œä¿®æ”¹ ç›‘å¬ä¿¡æ¯ç¼–å†™Shellå¦‚ä¸‹ 1234567891011121314151617181920#!/bin/shfile_name=\"/root/restartMqService.log\" #é‡å¯è„šæœ¬çš„æ—¥å¿—ï¼Œä¿è¯å¯å†™å…¥ï¼Œä¿é™©ä¸€ç‚¹æ‰§è¡Œ chmod 777 restartMqService.logpid=0proc_num() &#123; num=`ps -ef | grep '/usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction' | grep -v grep | wc -l` #æ­¤å¤„'nohup /usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction &amp;'æ›¿ä»£ä¸ºå®é™…çš„ï¼Œå°½é‡å‡†ç¡®ï¼Œé¿å…è¯¯kill return $num &#125;proc_id()&#123; pid=`ps -ef | grep '/usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction' | grep -v grep | awk '&#123;print $2&#125;'` #æ­¤å¤„'nohup /usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction &amp;'ä¹Ÿæ›¿ä»£ä¸ºå®é™…çš„&#125; proc_num #æ‰§è¡Œproc_num()ï¼Œè·å–è¿›ç¨‹æ•°number=$? #è·å–ä¸Šä¸€å‡½æ•°è¿”å›å€¼if [ $number -eq 0 ] #å¦‚æœæ²¡æœ‰è¯¥è¿›ç¨‹ï¼Œåˆ™é‡å¯then nohup /usr/bin/php7.2 /alidata/workspace/test/public/index.php /api_comm/mq_service/mqAction &amp; #å¯åŠ¨ç¨‹åºçš„å‘½ä»¤ proc_id echo $&#123;pid&#125;, `date` &gt;&gt; $file_name #æŠŠé‡å¯çš„è¿›ç¨‹å·ã€æ—¶é—´ å†™å…¥æ—¥å¿—fi å°†è¯¥è„šæœ¬é‡å‘½åä¸º mqMonitor.sh é…ç½®Crontabåœ¨crontabé…ç½®æ–‡ä»¶ä¸‹åŠ ä¸Šä¸€è¡Œ1*/2 * * * * sh /root/mqMonitor.sh ä¿å­˜åé‡å¯ç”Ÿæ•ˆï¼Œå¤§è‡´æ˜¯2åˆ†é’Ÿç›‘æµ‹ä¸€æ¬¡ï¼Œå¯è‡ªè¡Œä¿®æ”¹","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"æ¶ˆæ¯é˜Ÿåˆ—","slug":"æ¶ˆæ¯é˜Ÿåˆ—","permalink":"https://sbcoder.cn/tags/æ¶ˆæ¯é˜Ÿåˆ—/"},{"name":"è§£è€¦","slug":"è§£è€¦","permalink":"https://sbcoder.cn/tags/è§£è€¦/"}]},{"title":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(å››)","slug":"å…¬å¸ä»£ç æ¶æ„-Docker-Jenkins-Gogs-Portainer-å››","date":"2019-12-13T23:35:13.000Z","updated":"2019-12-18T12:51:18.000Z","comments":true,"path":"2019/12/14/docker_swarm.html","link":"","permalink":"https://sbcoder.cn/2019/12/14/docker_swarm.html","excerpt":"","text":"Portainer + Swarm ç®¡ç†Dockeré›†ç¾¤ä»‹ç»Portaineræ˜¯ä¸€ä¸ªDockerç®¡ç†å·¥å…·ï¼Œå®ƒæ”¯æŒå¤šç§æ–¹å¼ï¼Œæˆ‘ä»¬è¿™é‡Œåªå†™ï¼Œè¿œç¨‹é“¾æ¥å½¢å¼å’Œæœ¬åœ°å½¢å¼ æ­å»ºç¯å¢ƒ æœåŠ¡å™¨1 ï¼šVirmach æ°´ç‰›åŸ RAM1.8G 2C 10GSSDï¼ˆé»‘äº”æœºå™¨ï¼‰ æ“ä½œç³»ç»Ÿ ï¼šUbuntu16.04 éƒ¨ç½²ç¯å¢ƒ ï¼šLNMP1.6 ï¼ˆæˆ‘æ˜¯å†›å“¥é“ç²‰ï¼‰ æœåŠ¡å™¨1ï¼šæ­å»ºJenkinsä¸­è½¬æœåŠ¡å™¨ï¼Œåšä»£ç è‡ªåŠ¨æ„å»ºä½¿ç”¨æœåŠ¡å™¨2ï¼šç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ï¼Œå®åˆ™æµ‹è¯•æœåŠ¡å™¨ï¼Œéƒ¨ç½²ä»£ç ä½¿ç”¨æœåŠ¡å™¨3ï¼šGogsæœåŠ¡å™¨ï¼ŒGitç‰ˆæœ¬åº“æœåŠ¡å™¨ï¼Œåšä»£ç ç‰ˆæœ¬æ§åˆ¶ä½¿ç”¨ é…ç½®Portainerå¼€æ”¾DockerAPIç«¯å£å°†éœ€è¦åŠ å…¥Portainerç®¡ç†çš„æœåŠ¡å™¨ï¼ˆéœ€è¦å®‰è£…è¿‡Dockerï¼‰ï¼Œæ‰“å¼€2375ç«¯å£ï¼Œæ–¹ä¾¿ç®¡ç† åˆ›å»ºä¸€ä¸ªå¤‡ä»½ï¼Œå¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶12cp /lib/systemd/system/docker.service /lib/systemd/system/docker.service.bak vi /lib/systemd/system/docker.service æ–¹æ³•ä¸€ï¼šåœ¨ExecStartæ•´è¡Œåé¢æ·»åŠ  -H tcp://0.0.0.0:2375ï¼Œæœ‰çš„æ—¶å€™ä»–å¯èƒ½ä¸æ­¢ä¸€è¡Œï¼Œåˆ™åœ¨æœ€åé¢å¢åŠ è¿™ä¸€æ®µå³å¯ï¼Œå¦‚ä¸‹ 2.png :wq ä¿å­˜é€€å‡º æ–¹æ³•äºŒï¼ˆæ¨èï¼‰ï¼šæœ¬æ–¹æ³•å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰çš„Dockerç‰ˆæœ¬1vi /etc/docker/daemon.json å¤åˆ¶ä»¥ä¸‹å†…å®¹123456&#123; \"hosts\": [ \"tcp://0.0.0.0:2375\", \"unix:///var/run/docker.sock\" ]&#125; é…ç½®å®Œåé‡å¯Docker12systemctl daemon-reload systemctl restart docker è¿™é‡Œæ¨èå¤§å®¶ä½¿ç”¨iptablesé˜²ç«å¢™é™åˆ¶ä¸€ä¸‹2375ç«¯å£çš„è®¿é—®ï¼Œå¦‚æœå°†2375æš´éœ²åœ¨å…¬ç½‘åˆ™å¯èƒ½å‡ºç°ä¸€ç³»åˆ—å®‰å…¨é—®é¢˜ï¼Œå¦‚æœæ˜¯å›½å†…çš„è…¾è®¯æˆ–è€…é˜¿é‡Œï¼Œåˆ™å¯ä»¥ç›´æ¥åœ¨åå°é…ç½®å®‰å…¨ç»„ï¼Œå®‰å…¨ç»„é‡Œé™åˆ¶ æŒ‡å®šIPè®¿é—®æŒ‡å®šç«¯å£å³å¯ï¼Œå¦‚æœå°†2375æš´éœ²åœ¨å¤–ï¼Œåˆ™å¯èƒ½å—åˆ°é»‘å®¢æ¶æ„æ”»å‡»ï¼ å¦‚æœä¸æ˜¯å›½å†…æœºå™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡iptablesé™åˆ¶è®¿é—®1234iptables -I INPUT -s 107.173.XXX.XXX -p tcp --dport 2375 -j ACCEPTsystemctl iptables.service savesystemctl restart iptables.service# systemctl stop iptables.service å¦‚æœé…ç½®æœ‰è¯¯å¯ä»¥åœæ­¢iptableså°è¯• éå¸¸ä¸æ¨èç›´æ¥å°†2375æš´éœ²åœ¨å…¬ç½‘ï¼Œç§’è¢«é»‘~ é…ç½®åçš„æ•ˆæœå¦‚ä¸‹å›¾ 3.png å®‰è£…Portaineråˆ›å»ºæ•°æ®1docker volume create portainer_data åˆ›å»ºPortainerå¹¶è¿è¡Œ1docker run -d -p 8000:8000 -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer æ‰§è¡Œåè®¿é—® http://ip:9000å³å¯çœ‹åˆ° 1.png åˆšåˆ›å»ºå®Œä¼šæç¤ºåˆ›å»ºä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ï¼ŒæŒ‰ç…§æç¤ºåˆ›å»ºå³å¯ é€‰æ‹©åˆ›å»ºDockeræ—¶ä½¿ç”¨Remoteï¼Œè¿œç¨‹è¿æ¥ï¼ŒæŒ‰ä¸‹å›¾å¡«å†™ 4.png æ·»åŠ å®Œæˆåå¦‚ä¸‹å›¾ï¼Œç‚¹å‡»è®¿é—®åˆ›å»ºå¥½çš„èŠ‚ç‚¹åˆ™å¯ä»¥æ“ä½œé‡Œé¢çš„å†…å®¹ 5.png åˆ›å»ºSwarmé›†ç¾¤åœ¨ç®¡ç†èŠ‚ç‚¹ä¸Šå¢åŠ Swarmé›†ç¾¤managerèŠ‚ç‚¹12docker swarm init --advertise-addr [IP ADDRESS]# ä¾‹å¦‚ docker swarm init --advertise-addr 107.173.XXX.XXX è¿”å›ç»“æœå¦‚ä¸‹ï¼Œä¸ºäº†å®‰å…¨ï¼Œå…³é”®ä½ç½®å·²æ‰“ç 1234567Swarm initialized: current node (mjjrpuemaukx5a185iqd54mka) is now a manager.To add a worker to this swarm, run the following command: docker swarm join --token SWMTKN-1-1zd********2oci43nbf1jjhlng8k********fhfzqw2-1ywv79qnvmlb*******h3gs35r 107.173.XXX.XXX:2377To add a manager to this swarm, run &apos;docker swarm join-token manager&apos; and follow the instructions. å½“ManagerèŠ‚ç‚¹å¢åŠ å®Œæˆåï¼Œå¯ä»¥åœ¨å­èŠ‚ç‚¹ä¸­è¾“å…¥ä¸Šé¢æç¤ºçš„å‘½ä»¤ä»¥workerå½¢å¼åŠ å…¥é›†ç¾¤1docker swarm join --token SWMTKN-1-1zd********2oci43nbf1jjhlng8k********fhfzqw2-1ywv79qnvmlb*******h3gs35r 107.173.XXX.XXX:2377 å­èŠ‚ç‚¹åŠ å…¥æˆåŠŸåå¯ä»¥åœ¨çˆ¶èŠ‚ç‚¹ä¸­æŸ¥çœ‹å­èŠ‚ç‚¹ä¿¡æ¯1docker node ls 6.png å¦‚æœåœ¨Portainerå¢åŠ managerèŠ‚ç‚¹ï¼Œåˆ™ä¼šè‡ªåŠ¨å‡ºç° Swarm å’Œ Serviceé€‰é¡¹ï¼Œå¦‚å›¾ 7.png ç»“è¯­æœ¬æ¬¡æ­å»ºè¿‡ç¨‹å°±åŸºæœ¬å®Œæˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Portainerç®¡ç†ä¹‹å‰æ­å»ºçš„ä¸€ç³»åˆ—ç¯å¢ƒï¼Œè‡³æ­¤ï¼Œä¸€å¥—ç®€å•çš„å…¬å¸æ¶æ„å°±å®Œæˆäº†ï¼Œç”Ÿäº§ç¯å¢ƒä¹Ÿå¯ä»¥åšåˆ°å®æ—¶æ„å»ºï¼Œåªéœ€è¦åœ¨Gogsä¸Šé¢å‘å¸ƒç‰ˆæœ¬å°±å¯ä»¥äº†ï¼Œé€‰æ‹©æ‰‹åŠ¨æ„å»ºï¼Œæ„å»ºæ—¶é€‰æ‹©ç‰ˆæœ¬å·å³å¯ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å¦‚æœæ­£å¼ç¯å¢ƒæœ‰bugæ—¶å¯ä»¥éšæ—¶å›æ»šåˆ°ç¨³å®šç‰ˆæœ¬ï¼Œå½“ç„¶ï¼Œå‘å¸ƒç‰ˆæœ¬ä¹Ÿæ˜¯å»ºç«‹åœ¨æµ‹è¯•å®Œåçš„åœºæ™¯ï¼","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/tags/æ¶æ„/"},{"name":"ç‰ˆæœ¬æ§åˆ¶","slug":"ç‰ˆæœ¬æ§åˆ¶","permalink":"https://sbcoder.cn/tags/ç‰ˆæœ¬æ§åˆ¶/"}]},{"title":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(ä¸‰)","slug":"å…¬å¸ä»£ç æ¶æ„-Docker-Jenkins-Gogs-Portainer-ä¸‰","date":"2019-12-11T11:09:38.000Z","updated":"2019-12-11T11:10:26.000Z","comments":true,"path":"2019/12/11/jenkins_docker.html","link":"","permalink":"https://sbcoder.cn/2019/12/11/jenkins_docker.html","excerpt":"","text":"é…ç½®Jenkinså®ç°è‡ªåŠ¨æ„å»ºä»‹ç»å‰é¢å·²ç»æ­å»ºå¥½äº†åŸºæœ¬ç¯å¢ƒï¼Œå‰©ä¸‹çš„å°±æ˜¯è‡ªåŠ¨æ„å»ºäº†ï¼Œè¿™é‡Œå°±éœ€è¦ä½¿ç”¨æˆ‘ä»¬çš„æ„å»ºå·¥å…·Jenkinsï¼ŒJenkinsæ˜¯ä¸€ä¸ªéå¸¸ç‰›é€¼çš„ä¸œè¥¿ï¼Œå®ƒå¯ä»¥å®ç°ä»£ç åŒæ­¥æ„å»ºï¼Œå½“ä½ ä¿®æ”¹ä½ çš„ä»£ç å¹¶ä¼ åˆ°gitæ—¶ï¼ŒJenkinså¯ä»¥è‡ªåŠ¨å°†ä½ çš„ä»£ç åŒæ­¥åˆ°æœåŠ¡å™¨ä¸Šé¢ï¼Œå½“ç„¶è¿™åªæ˜¯Jenkinsçš„åŸºæœ¬åŠŸèƒ½ä¹‹ä¸€ï¼Œä»–è¿˜æœ‰éå¸¸å¤šçš„ä¸œè¥¿å€¼å¾—æˆ‘ä»¬å­¦ä¹ ~ æ­å»ºç¯å¢ƒ æœåŠ¡å™¨2 ï¼šPacificrack æ´›æ‰çŸ¶ RAM2G 2C 35GSSDï¼ˆåœ£è¯æœºå™¨ï¼‰18åˆ€ æ“ä½œç³»ç»Ÿ ï¼šCentOS7.5 éƒ¨ç½²ç¯å¢ƒ ï¼šLNMP1.6 ï¼ˆæˆ‘æ˜¯å†›å“¥é“ç²‰ï¼‰ + Java8 æœåŠ¡å™¨1ï¼šæ­å»ºJenkinsä¸­è½¬æœåŠ¡å™¨ï¼Œåšä»£ç è‡ªåŠ¨æ„å»ºä½¿ç”¨æœåŠ¡å™¨2ï¼šç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ï¼Œå®åˆ™æµ‹è¯•æœåŠ¡å™¨ï¼Œéƒ¨ç½²ä»£ç ä½¿ç”¨æœåŠ¡å™¨3ï¼šGogsæœåŠ¡å™¨ï¼ŒGitç‰ˆæœ¬åº“æœåŠ¡å™¨ï¼Œåšä»£ç ç‰ˆæœ¬æ§åˆ¶ä½¿ç”¨ ç”Ÿäº§ç¯å¢ƒæ­å»ºæœåŠ¡å™¨2çš„ç”Ÿäº§ç¯å¢ƒæ­å»ºã€‚ ç”Ÿäº§ç¯å¢ƒï¼Œä¸»è¦å°±æ˜¯LNMPå’ŒJava8ï¼ŒLNMPæ˜¯å¯é€‰çš„ï¼Œçœ‹éœ€è¦éƒ¨ç½²çš„ç¨‹åºç¯å¢ƒï¼Œä¾‹å¦‚éœ€è¦éƒ¨ç½²node.jsåˆ™åªéœ€è¦node.jsç¯å¢ƒå³å¯ï¼Œå…¶ä»–åŒç†ï¼Œæˆ‘è¿™è¾¹æ˜¯å‡†å¤‡è‡ªåŠ¨éƒ¨ç½²PHPç¨‹åºï¼Œå› æ­¤å°±è¿˜æ˜¯ä½¿ç”¨LNMPï¼› Java8æ˜¯å¿…é¡»çš„ï¼ŒJenkinsä½¿ç”¨SSHè¿æ¥åˆ°æœåŠ¡å™¨æ—¶æ˜¯éœ€è¦æºæœåŠ¡å™¨æœ‰Javaç¯å¢ƒçš„ å®‰è£…LNMPLNMPç¯å¢ƒå®‰è£…æ•™ç¨‹ : LNMPä¸€é”®å®‰è£…åŒ… - å®‰è£…æ•™ç¨‹ å®‰è£…Java8Jenkinsè¿æ¥èŠ‚ç‚¹çš„æœåŠ¡å™¨å¿…é¡»å®‰è£…ï¼å…¶ä»–æœåŠ¡å™¨æ— éœ€å®‰è£…ï¼ é¦–å…ˆæ›´æ–° yum æº1yum update å®‰è£… jdk1.81yum install java-1.8.0-openjdk java-1.8.0-openjdk-devel è¿™é‡Œæ³¨æ„ï¼Œæ˜¯å¯ä»¥é€‰æ‹©Javaç‰ˆæœ¬çš„ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†8æ‰€ä»¥æŒ‰ç…§8çš„æ–¹å¼å®‰è£…çš„ å¯ä»¥æœç´¢yumé€‰æ‹©éœ€è¦å®‰è£…çš„ç‰ˆæœ¬1yum search java | grep jdk ä¸€èˆ¬ ä½¿ç”¨ä¸Šé¢æ–¹æ³•å®‰è£…çš„Javaé…ç½®æ–‡ä»¶éƒ½åœ¨ /etc/profile ç¼–è¾‘é…ç½®1vi /etc/profile åœ¨æœ«å°¾æ·»åŠ  ç¯å¢ƒå˜é‡ï¼Œæ³¨æ„ä¿®æ”¹è‡ªå·±çš„ç‰ˆæœ¬å·12345JAVA_HOME=/user/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64JRE_HOME=$JAVA_HOME/jreCLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASS_PATH PATH é‡ç½® profile1source /etc/profile æŸ¥çœ‹Javaç‰ˆæœ¬1java -version Jenkinsé…ç½®å®‰è£…å¿…è¦çš„æ’ä»¶æ‰“å¼€Jenkinsç™»å½•å æ‰“å¼€ ç³»ç»Ÿç®¡ç† - æ’ä»¶ç®¡ç† - å¯é€‰æ’ä»¶ æœç´¢ å®‰è£… ä»¥ä¸‹æ’ä»¶ æ±‰åŒ–è¯­è¨€åŒ…(å¯é€‰) Locale plugin Localization: Chinese (Simplified) Dockerå®¹å™¨(å¯é€‰) Docker Pipeline è¿œç¨‹è¿æ¥(å¿…é¡») SSH plugin SSH Slaves plugin Oracle Java SE Development Kit Installer Plugin GitæœåŠ¡(æ¨è) GitHub plugin Gogs plugin æ¨èå®‰è£…(å¯é€‰) bouncycastle API Plugin Branch API Plugin Command Agent Launcher Plugin æ’ä»¶å±äºæŒ‰éœ€é…ç½®ï¼Œä¸é€‚åˆè‡ªå·±çš„æ’ä»¶æ— éœ€å®‰è£… å¢åŠ èŠ‚ç‚¹å¢åŠ èŠ‚ç‚¹å¿…é¡»è¦å…ˆåœ¨èŠ‚ç‚¹æœåŠ¡å™¨é…ç½®Javaç¯å¢ƒï¼Œå‚ç…§ä¸Šé¢çš„é…ç½®Java8ç¯å¢ƒé…ç½®ï¼å¦‚æœæ²¡æœ‰é…ç½®Javaç¯å¢ƒåˆ™ä¼šæŠ¥é”™ï¼ å¢åŠ èŠ‚ç‚¹å¿…é¡»è¦æœ‰SSHæ’ä»¶ï¼Œå› æ­¤å¦‚æœç•Œé¢ä¸æˆ‘ä¸ä¸€æ ·è¯·æ£€æŸ¥è‡ªå·±æ˜¯å¦å®‰è£…äº†ä¸Šé¢çš„æ’ä»¶ æ‰“å¼€Jenkins ç³»ç»Ÿç®¡ç† - èŠ‚ç‚¹ç®¡ç† - æ–°å»ºèŠ‚ç‚¹ 1.png æ–°å»ºèŠ‚ç‚¹é¡µé¢å¦‚ä¸‹ 2.png å¦‚æœæ²¡æœ‰è®¾ç½®è¿‡å‡­è¯åˆ™é€‰æ‹©æ·»åŠ ï¼Œç•Œé¢å¦‚ä¸‹ 3.png å…¨éƒ¨è®¾ç½®å®Œç‚¹ä¿å­˜ï¼Œä»–ä¼šè‡ªåŠ¨å¯åŠ¨ä»£ç†èŠ‚ç‚¹ é¦–é¡µå·¦ä¸‹è§’ä¼šæ˜¾ç¤ºçŠ¶æ€ 4.png æˆ–è€…åœ¨èŠ‚ç‚¹ç®¡ç†é‡Œé¢ä¹Ÿå¯ä»¥çœ‹åˆ° é…ç½®Gogs WebHookæ ¹æ®ä¸Šä¸€èŠ‚æˆ‘ä»¬é…ç½®å¥½çš„Gogsï¼Œæ–°å»ºä¸€ä¸ªä»“åº“ï¼Œè¿™é‡Œä¸å¤šè¯´ï¼Œç›´æ¥ç‚¹åŠ å·å°±è¡Œï¼Œç”¨è¿‡Githubçš„éƒ½æ‡‚ å¯ä»¥é€‰æ‹©å…¬æœ‰ä»“åº“æˆ–è€…ç§æœ‰ä»“åº“ï¼Œæˆ‘è¿™é‡Œéƒ½æ˜¯ç§æœ‰ä»“åº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Gogsçš„è¿ç§»å¤–éƒ¨ä»“åº“åŠŸèƒ½ç›´æ¥è¿ç§»ï¼Œè¿ç§»æ—¶å¯èƒ½ä¼šå‡ºç°504é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºNginxçš„åå‘ä»£ç†æ—¶æœ‰è¶…æ—¶è®¾ç½®ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´åˆ™ç›´æ¥504ï¼Œæˆ‘ä»¬åœ¨è¿ç§»ä»“åº“æ—¶ç»å¸¸ä¼šè¶…æ—¶ï¼Œå› æ­¤å»ºè®®ä¿®æ”¹ä¸€ä¸‹é»˜è®¤è¶…æ—¶æ—¶é—´ï¼Œå…·ä½“é…ç½®å¯ä»¥è‡ªè¡Œæœç´¢ï¼Œä¸å¤šèµ˜è¿°ã€‚ æ‰¾åˆ°éœ€è¦è‡ªåŠ¨æ„å»ºçš„ä»“åº“ï¼Œé€‰æ‹© ä»“åº“è®¾ç½® - ç®¡ç† Web é’©å­ - æ·»åŠ Webé’©å­ 6.png æ³¨æ„ï¼šå›¾ä¸­çº¢æ¡†å¤„çš„testéœ€è¦è·Ÿåé¢é…ç½®çš„Jenkinså¯¹åº”ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºçš„Jenkinsä»»åŠ¡åä¸º test åˆ™æ­¤å¤„å¡«å†™testï¼Œä¿®æ”¹åŸŸåä¸ºä½ çš„JenkinsåŸŸåï¼Œå…¶ä»–æ ¼å¼ä¸€è‡´ æ³¨æ„ï¼šå›¾ä¸­ç§˜é’¥å¯éšä¾¿å¡«å†™ï¼Œè®°å½•ä¸‹æ¥ï¼Œé…ç½®Jenkinsä»»åŠ¡æ—¶ä¼šç”¨åˆ° é…ç½®Jenkinsä»»åŠ¡æ‰“å¼€ Jenkins æ–°å»ºä»»åŠ¡ï¼Œå¦‚æœä»¥å‰æ²¡æœ‰ä»»åŠ¡åˆ™é¦–é¡µä¼šæ˜¾ç¤º åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡ 5.png é…ç½®Jenkinsä»»åŠ¡ 7.png æè¿°éƒ¨åˆ†å¯éšä¾¿å¡«å†™ï¼Œè¿™é‡Œä¸»è¦é…ç½®ä¸€ä¸‹ Gogs Webhook å‹¾é€‰ Use Gogs secretï¼ŒSecretå¡«å†™ä¸Šé¢åˆ›å»ºGogs WebHookæ—¶çš„ç§˜é’¥ å‹¾é€‰ é™åˆ¶é¡¹ç›®çš„è¿è¡ŒèŠ‚ç‚¹ ï¼Œæ ‡ç­¾è¡¨è¾¾å¼å¡«å†™ä½ çš„èŠ‚ç‚¹åå­—ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œçš„èŠ‚ç‚¹åå­—å°±æ˜¯æˆ‘çš„æœåŠ¡å™¨ipåœ°å€ï¼Œç›´æ¥å¡«å†™ipåœ°å€å³å¯ 8.png æºç ç®¡ç†é€‰æ‹©Gitï¼ŒRepository URLé€‰æ‹©éœ€è¦è‡ªåŠ¨æ„å»ºçš„Gité¡¹ç›®åœ°å€ï¼Œhttpå½¢å¼çš„ï¼ŒCredentialså¤„ä¸ºéªŒè¯ï¼Œå¦‚æœæ˜¯å…¬å…±ä»“åº“åˆ™æ— éœ€é…ç½®ï¼Œå¦‚æœæ˜¯ç§æœ‰åº“åˆ™éœ€è¦å¡«å†™ç™»å½•åˆ° Gogs çš„è´¦æˆ·å’Œå¯†ç ï¼Œé…ç½®ä¸ä¹‹å‰çš„èŠ‚ç‚¹é…ç½®å‡­æ®ä¸€æ ·ï¼Œä¸å¤šèµ˜è¿° æŒ‡å®šåˆ†æ”¯å¡«å†™éœ€è¦è‡ªåŠ¨æ„å»ºçš„åˆ†æ”¯ï¼Œæˆ‘è¿™é‡Œå¡«å†™çš„æ˜¯devåˆ†æ”¯ï¼Œç”¨æ¥åšå¼€å‘ç‰ˆæµ‹è¯•ä½¿ç”¨ï¼Œæ ¹æ®è‡ªå·±æƒ…å†µæ¥å³å¯ é…ç½®ä¸Šçº¿Nginxé…ç½®ç”±äºæˆ‘åˆ›å»ºçš„èŠ‚ç‚¹ ç›®å½•åœ°å€æ˜¯ /home/wwwroot åœ¨é¡¹ç›®è‡ªåŠ¨æ„å»ºæ—¶ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºç›®å½• /home/wwwroot/workspace/[JOB NAME]JOB NAME ä¸º ä»»åŠ¡åï¼Œä¾‹å¦‚æˆ‘çš„ test åˆ™è‡ªåŠ¨åˆ›å»ºç›®å½• /home/wwwroot/workspace/test Nginxåˆ™åªéœ€è¦é…ç½® åŸŸåè§£æå³å¯ 1lnmp vhost add 9.png æŒ‰å›¾ä¸Šé…ç½®å³å¯ï¼Œå»ºè®®å¢åŠ SSLè¯ä¹¦ï¼Œå¢åŠ è¯ä¹¦å‰è®°å¾—å…ˆæŠŠåŸŸåè§£æåˆ°æŒ‡å®šæœåŠ¡å™¨IPä¸Šï¼Œå¦åˆ™ä¼šç”Ÿæˆè¯ä¹¦å¤±è´¥ è®°å¾—ç»™æ–‡ä»¶å¤¹åŠ ä¸Šæƒé™ï¼Œ755 æ„å»ºè¿”å›Jenkinsï¼Œç‚¹å‡»ç«‹å³æ„å»ºï¼Œç¬¬ä¸€æ¬¡æ„å»ºæ—¶é—´å¯èƒ½ä¼šé•¿ä¸€äº›ï¼Œç­‰å¾…å³å¯! æ„å»ºå®Œæˆååˆ™ä¼šåœ¨ é…ç½®çš„ç›®å½•ä¸‹åˆ›å»ºworkspaceç›®å½•ï¼Œå¹¶å°†ä»£ç æ”¾å…¥ /home/wwwroot/workspace/test ç›®å½•ä¸­ï¼Œæ ¹æ®è‡ªå·±çš„é…ç½®è‡ªè¡Œä¿®æ”¹ç›®å½• ç”±äºæˆ‘çš„ç¨‹åºæ¶‰åŠåˆ°è·¨ç›®å½•è®¿é—®ï¼Œå› æ­¤éœ€è¦æ›´æ”¹ fastcgi.conf æ–‡ä»¶ï¼Œä¸æœ¬æ–‡æ— å…³è¿™é‡Œä¸å¤šè¯´~ é™„ä¸€å¼ æˆåŠŸæˆªå›¾ï¼Œç”±äºæˆ‘è¿™æ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œå› æ­¤æ²¡æœ‰ç•Œé¢~ 10.png è‡ªåŠ¨æ„å»ºä¸Šé¢å·²ç»é…ç½®å¥½äº†è‡ªåŠ¨æ„å»ºï¼Œæˆ‘ä»¬æ¯æ¬¡åˆå¹¶ä»£ç æˆ–è€…æäº¤ä»£ç å˜æ›´åˆ°devåˆ†æ”¯æ—¶ï¼ŒGogsåˆ™ä¼šä»¥Webhookçš„å½¢å¼å°†å†…å®¹æ¨é€åˆ°Jenkinsä¸Šé¢å»ï¼Œå®ç°æ¯æ¬¡æ›´æ–°ä»£ç è‡ªåŠ¨æ„å»ºæœåŠ¡å™¨ä»£ç ã€‚ ç»“è¯­ç›®å‰æ­å»ºå¥½çš„æ¶æ„ï¼Œé€‚åˆè¿˜åœ¨å¼€å‘æµ‹è¯•ç¨‹åºçš„å¼€å‘å°ç»„ï¼Œé…åˆæµ‹è¯•äººå‘˜ä½¿ç”¨ï¼Œä¹Ÿèƒ½è®©äº§å“ä»¬åœ¨æ±‡æŠ¥å·¥ä½œè¿›åº¦çš„æ—¶å€™æ›´å¾—å¿ƒåº”æ‰‹ï¼Œäº†è§£å¼€å‘è¿›åº¦ï¼Œå½“ç„¶ä¹Ÿä¸æ˜¯ç‰¹åˆ«å‡†ç¡®çš„å¼€å‘è¿›åº¦ï¼Œæ‘¸é±¼è¿˜æ˜¯è¦æ‘¸çš„ã€‚åé¢åº”è¯¥ä¼šå†™ä¸€ä¸‹ Portainer + Swarm ç®¡ç†Dockeré›†ç¾¤ï¼Œæ…¢æ…¢å†™~","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/tags/æ¶æ„/"},{"name":"ç‰ˆæœ¬æ§åˆ¶","slug":"ç‰ˆæœ¬æ§åˆ¶","permalink":"https://sbcoder.cn/tags/ç‰ˆæœ¬æ§åˆ¶/"}]},{"title":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(äºŒ)","slug":"å…¬å¸ä»£ç æ¶æ„-Docker-Jenkins-Gogs-Portainer-äºŒ","date":"2019-12-10T11:05:36.000Z","updated":"2019-12-10T11:07:02.000Z","comments":true,"path":"2019/12/10/gogs_docker.html","link":"","permalink":"https://sbcoder.cn/2019/12/10/gogs_docker.html","excerpt":"","text":"å®‰è£… Gogs + Dockerå¸¸ç”¨å‘½ä»¤ä»‹ç»æœ¬èŠ‚ä¸»è¦å†™ä¸€ä¸‹Jenkinsçš„é…ç½®ä¸è‡ªåŠ¨æ„å»ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬ä½¿ç”¨Gogsä½œä¸ºgitæœåŠ¡å™¨ï¼Œé…ç½®è‡ªåŠ¨æ„å»ºç­‰ã€‚æœ¬èŠ‚éœ€è¦é…åˆä¸Šä¸€èŠ‚çš„å†…å®¹ä½¿ç”¨ï¼Œå³ å®‰è£… Docker + Jenkins çš„æœåŠ¡å™¨ä¸€å° æ­å»ºç¯å¢ƒ æœåŠ¡å™¨3 ï¼šTencentCloud åŒ—äº¬ RAM4G 2C 40GSSDï¼ˆæ–°ç”¨æˆ·æœºå™¨ï¼‰998RMB/3Year æ“ä½œç³»ç»Ÿ ï¼šCentOS7.5 éƒ¨ç½²ç¯å¢ƒ ï¼šLNMP1.6 ï¼ˆæˆ‘æ˜¯å†›å“¥é“ç²‰ï¼‰ æœåŠ¡å™¨1ï¼šæ­å»ºJenkinsä¸­è½¬æœåŠ¡å™¨ï¼Œåšä»£ç è‡ªåŠ¨æ„å»ºä½¿ç”¨æœåŠ¡å™¨2ï¼šç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ï¼Œå®åˆ™æµ‹è¯•æœåŠ¡å™¨ï¼Œéƒ¨ç½²ä»£ç ä½¿ç”¨æœåŠ¡å™¨3ï¼šGogsæœåŠ¡å™¨ï¼ŒGitç‰ˆæœ¬åº“æœåŠ¡å™¨ï¼Œåšä»£ç ç‰ˆæœ¬æ§åˆ¶ä½¿ç”¨ é…ç½®æ— éœ€å¯¹æ ‡ï¼Œéƒ½æ˜¯ä½é…ç½®å°é¸¡ï¼Œå”¯ä¸€ä¸€ä¸ªè…¾è®¯äº‘ 2C4G çš„æœºå™¨æ˜¯æˆ‘ä¹‹å‰æ”¾å…¶ä»–ä¸šåŠ¡çš„æœºå™¨ï¼Œç”±äºgitç»å¸¸éœ€è¦ä½¿ç”¨å› æ­¤æ­å»ºåœ¨å›½å†…å¥—CloudFlareä½¿ç”¨ï¼Œå®åˆ™Gogsåªéœ€è¦ 2C1G æœºå™¨å³å¯ï¼Œå®˜æ–¹æ¨èé…ç½®æ˜¯2C512Mï¼Œæ˜¯ä¸€ä¸ªä¸åƒå†…å­˜çš„ç¨‹åºï¼Œç›®å‰è…¾è®¯äº‘çš„ 1C2G åªéœ€è¦99/å¹´ï¼Œå±äºå¤§ä¼—æ‰€æ‰¿å—çš„èµ·çš„ä»·æ ¼ï¼Œç”±äºæˆ‘ä¸æ˜¯ä¸“èŒAFFMANï¼Œå› æ­¤ä¸è´´é“¾æ¥ CentOS7 å®‰è£… Docker1yum -y install docker 1.png 12start dockerenable docker 2.png æŸ¥çœ‹ç‰ˆæœ¬å·ï¼ŒæŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼1docker -v 3.png Docker å¸¸ç”¨å‘½ä»¤è®°å½•ä¸€ä¸‹å®‰è£…æ—¶å¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜ï¼Œä»¥åŠå¸¸ç”¨çš„Dockerå‘½ä»¤ æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨1docker ps æŸ¥çœ‹æ‰€æœ‰å®¹å™¨1docker ps -a åœæ­¢å®¹å™¨12docker stop [DOCKER NAME] # ä¾‹å¦‚ï¼šdocker stop gogs åˆ é™¤å®¹å™¨(å¿…é¡»åœ¨Stopä¹‹åæ‰å¯ä»¥åˆ é™¤)12docker rm [DOCKER NAME] # ä¾‹å¦‚ï¼šdocker rm gogs è¿›å…¥å®¹å™¨1234docker attach [DOCKER NAME] # ä¾‹å¦‚ï¼š docker attach gogsdocker exec -it [DOCKER IMAGE ID] /bin/bash# ä¾‹å¦‚ï¼š docker exec -it ef5cb0692b57 /bin/bash é€€å‡ºå®¹å™¨1exit æŸ¥çœ‹å®¹å™¨å˜åŠ¨æ—¥å¿—12docker diff [DOCKER NAME]# ä¾‹å¦‚ï¼šdocker diff gogs æŸ¥çœ‹å®¹å™¨æˆ–è€…é•œåƒè¯¦ç»†ä¿¡æ¯12sudo docker inspect [IMAGE NAME]:0.1 # ä¾‹å¦‚ï¼š sudo docker inspect gogs å‘å®¹å™¨å†…éƒ¨å‘é€æŒ‡ä»¤12docker exec [DOCKER NAME] [COMMAND]# ä¾‹å¦‚ docker exec gogs ls å®‰è£… Gogså®‰è£…ä¸‹è½½é•œåƒ Gogs1docker pull gogs/gogs 4.png åˆ›å»ºç›®å½•12mkdir -p /home/Gogscd /home/Gogs 5.png å¼€å¯Docker1234# ç›´æ¥å¯åŠ¨docker run --name=gogs -p 10022:22 -p 10080:3000 -v /home/Gogs:/data gogs/gogs# åå°å¯åŠ¨docker run --name=gogs -d -p 10022:22 -p 10080:3000 -v /home/Gogs:/data gogs/gogs é…ç½®æ­£å¸¸å¯åŠ¨åç›´æ¥æ‰“å¼€ http://ip:10080å³å¯ å¦‚å›¾ï¼š 6.png æ¥ä¸‹æ¥æŒ‰ç…§æç¤ºé…ç½®å³å¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨SQLite3 åº”ç”¨é…ç½®éœ€è¦æ³¨æ„ä¸€ä¸‹ åŸŸåå¡«å†™ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP SSHç«¯å£å·å¡«å†™ æ˜ å°„çš„ç«¯å£å· 10022 HTTPç«¯å£å·å¡«å†™ 3000 åº”ç”¨URLå¡«å†™ ip + æ˜ å°„çš„ç«¯å£å· 10080 è®¿é—® 7.png é…ç½®å®Œæˆåå¦‚æœè®¾ç½®å¥½ç®¡ç†å‘˜è´¦æˆ·çš„ä¼šè‡ªåŠ¨ç™»å½•è¿›å»ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®çš„å¯ä»¥è‡ªè¡Œæ³¨å†Œã€‚ æ³¨æ„ï¼šæ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªç”¨æˆ·å°±æ˜¯ç®¡ç†å‘˜è´¦æˆ· 8.png Tipsï¼šGogsçš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ Dockerä¸­çš„ /data/gogs/conf/app.ini å¦‚æœæƒ³è¦æ›´æ”¹å¯ä»¥ åå‘ä»£ç†ç»‘å®šåŸŸååŒ å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(ä¸€)ä¸€æ ·ï¼Œåœ¨åº”ç”¨é…ç½®é˜¶æ®µä¿®æ”¹æˆ–è€…ä¿®æ”¹é…ç½®æ–‡ä»¶éƒ½å¯ä»¥ ç»“è¯­Gogs æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ GitæœåŠ¡å™¨ï¼Œé€‚ç”¨äºä¸€äº›å°å…¬å¸å°å›¢é˜Ÿä½¿ç”¨ï¼Œå¤§å…¬å¸ä½¿ç”¨Gitlabçš„æƒ…å†µå¯èƒ½æ›´å¤šä¸€äº›ï¼Œä½†æ˜¯ä¸œè¥¿å®é™…éƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œä¸ºäº†å ç”¨èµ„æºæ›´å°ä¸€äº›ï¼Œæˆ‘è¿™é‡Œè¿˜æ˜¯é€‰ç”¨äº†æ¯”è¾ƒè½»é‡çº§çš„Gogs","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/tags/æ¶æ„/"},{"name":"ç‰ˆæœ¬æ§åˆ¶","slug":"ç‰ˆæœ¬æ§åˆ¶","permalink":"https://sbcoder.cn/tags/ç‰ˆæœ¬æ§åˆ¶/"}]},{"title":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(ä¸€)","slug":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(ä¸€)","date":"2019-12-09T11:47:26.000Z","updated":"2019-12-10T11:07:37.000Z","comments":true,"path":"2019/12/09/code_build.html","link":"","permalink":"https://sbcoder.cn/2019/12/09/code_build.html","excerpt":"","text":"å…¬å¸ä»£ç æ¶æ„ - Docker + Jenkins + Gogs + Portainer(ä¸€)ä»‹ç»å…¬å¸ç ”å‘é¡¹ç›®æ—¶ï¼Œé‡åˆ°gitä½œä¸ºç‰ˆæœ¬æ§åˆ¶æ—¶ï¼Œå¾ˆå¸¸è§çš„é—®é¢˜æ˜¯éƒ¨ç½²æ¯”è¾ƒéº»çƒ¦ï¼ˆç›¸æ¯”è¾ƒéº»çƒ¦ï¼‰ï¼Œéœ€è¦å…ˆå…‹éš†åœ¨æ‹‰åˆ°æœåŠ¡å™¨éƒ¨ç½²ï¼Œä»£ç æäº¤é¢‘ç‡è¿‡é«˜æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸€å¤©å¾ˆå¤šæ¬¡æäº¤ä»£ç ï¼Œéƒ¨ç½²ä»£ç ï¼Œæµªè´¹äº†å¤§é‡çš„äººåŠ›ç‰©åŠ›ï¼Œäºæ˜¯ä¹å¤§é‡çš„æ¶æ„å¸ˆæŠ€æœ¯æ€»ç›‘ä»¬å¼€å§‹ç ”ç©¶å„ç±»è§£å†³æ–¹æ¡ˆï¼Œå„ç§ä¸Šçº¿å‰reviewä»£ç ï¼Œè¿™æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„äº‹æƒ…ï¼Œè¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹å…¬å¸ä»£ç æ¶æ„çš„éƒ¨ç½²ï¼Œæ¥è§£å†³å…¬å¸ä»£ç æ¶æ„ä¸Šçš„è¯¸å¤šé—®é¢˜ï¼Œä¹Ÿæ˜¯è‡ªå·±åšä¸€ä¸ªç¬”è®°ï¼Œæ–‡ç« å†…å¦‚æœ‰é”™è¯¯ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºã€‚ Tipsï¼šè¯¥ç¯å¢ƒå¹¶ä¸é€‚ç”¨äºä¸ªäººç”¨æˆ·ä»¥åŠå°å¾®ä¼ä¸šï¼Œé€‚ç”¨äºé¡¹ç›®ä¼—å¤šä¸”å¼€å‘äººå‘˜å¤§äº30äººçš„å…¬å¸ æ­å»ºç¯å¢ƒ æœåŠ¡å™¨1 ï¼šVirmach æ°´ç‰›åŸ RAM1.8G 2C 10GSSDï¼ˆé»‘äº”æœºå™¨ï¼‰ æ“ä½œç³»ç»Ÿ ï¼šUbuntu16.04 éƒ¨ç½²ç¯å¢ƒ ï¼šLNMP1.6 ï¼ˆæˆ‘æ˜¯å†›å“¥é“ç²‰ï¼‰ è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œå¤šå°æœåŠ¡å™¨æ˜¯ä¸ºäº†è§£è€¦ï¼Œè¯´æ˜¯è§£è€¦ï¼Œå®åˆ™è®¤ä¸ºæ‰¿å—ä¸ä½ï¼Œä¸”å¤§éƒ¨åˆ†å…¬å¸å·²ç»æœ‰ä¸€å¥—å®Œæ•´çš„gitæœåŠ¡å™¨äº†ï¼Œæœ¬èŠ‚è¦åšçš„å°±æ˜¯åŠ ä¸ªè‡ªåŠ¨æ„å»ºè€Œå·²ï¼ŒgitæœåŠ¡å™¨å¯è‡ªé€‰ç¯å¢ƒï¼Œåé¢ä¼šè®²å¦‚ä½•æ­å»ºGogsï¼Œå¦‚æœæœ‰é«˜é…ç½®æœåŠ¡å™¨çš„å…¬å¸æˆ–ä¸ªäººï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å•æœåŠ¡å™¨å¤šéƒ¨ç½²ï¼Œæœ¬æ–‡æ‰€éœ€å…±ä¸‰å°æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨1ï¼šæ­å»ºJenkinsä¸­è½¬æœåŠ¡å™¨ï¼Œåšä»£ç è‡ªåŠ¨æ„å»ºä½¿ç”¨æœåŠ¡å™¨2ï¼šç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ï¼Œå®åˆ™æµ‹è¯•æœåŠ¡å™¨ï¼Œéƒ¨ç½²ä»£ç ä½¿ç”¨æœåŠ¡å™¨3ï¼šGogsæœåŠ¡å™¨ï¼ŒGitç‰ˆæœ¬åº“æœåŠ¡å™¨ï¼Œåšä»£ç ç‰ˆæœ¬æ§åˆ¶ä½¿ç”¨ æœåŠ¡å™¨1çš„é…ç½®å±äºä¸­ä¸‹é…ç½®ï¼Œè¯¥æœºå‹ä¸€å¹´ 13åˆ€ï¼Œå±äºå¤§éƒ¨åˆ†äººéƒ½æ‰¿å—çš„èµ·çš„ä»·æ ¼ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡æ ‡æ³¨çš„é…ç½®ä»…ç”¨äºé…ç½®è‡ªåŠ¨æ„å»ºæœåŠ¡å™¨ï¼Œå¹¶ä¸ç”¨äºéƒ¨ç½²ä»£ç ä»¥åŠGitæœåŠ¡ï¼Œä¸ªäººç”¨æˆ·å°é¸¡å¤šçš„å¯ä»¥å°è¯• Ubuntu16.04/Ubuntu18.04 å®‰è£… DockerDockerå¯ä»¥è¯´æ˜¯éå¸¸çš„ç‰›Xäº†ï¼Œå…³äºä»–çš„æ¦‚å¿µä¸å¤šè¯´ï¼Œç‰›å°±ç‰›åœ¨ç®¡ç†å¤ªæ–¹ä¾¿äº†ï¼Œå°±å¥½åƒæ˜¯ WHMCS ç”¨æ¯é¸¡å¼€å°é¸¡ä¸€æ ·ï¼Œæ¯é¸¡æ°¸è¿œä¸è€ƒè™‘å°é¸¡çš„è¿ä½œï¼Œåªéœ€è¦é…åˆå°±å¥½ï¼ŒDockerä¹Ÿä¸€æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºå®¹å™¨ï¼Œç®¡ç†å®¹å™¨å°±å¤Ÿäº†ï¼Œå‰©ä¸‹çš„äº¤ç»™Dockeræ¥å¤„ç†ï¼Œä¸”Dockerå¯ä»¥åšè´Ÿè½½å‡è¡¡ï¼Œåç»­åšæ¶æ„çš„æ—¶å€™å¯ä»¥å¼€å¤šä¸ªDockeråšé›†ç¾¤ï¼ŒæŒ‰éœ€æ¥åš å®‰è£…åˆ é™¤æ—§ç‰ˆæœ¬ï¼Œæ›´æ–°apt-getï¼Œå®‰è£…docker123sudo apt-get remove docker docker-engine docker-ce docker.iosudo apt-get updatesudo apt install docker.io å¯åŠ¨Dockerå¹¶æŸ¥çœ‹ç‰ˆæœ¬å¯åŠ¨docker123systemctl start dockersystemctl enable dockerdocker --version æˆ‘è¿™é‡Œå®‰è£…çš„æ˜¯ 18.09ç‰ˆæœ¬ Docker1.png å®‰è£…Jenkinså®‰è£…å®‰è£…Jenkinså¯ä»¥é€‰æ‹©å¤šç§æ–¹å¼å®‰è£…ï¼Œæˆ‘è¿™é‡Œé‡‡ç”¨çš„æ˜¯Dockerçš„æ–¹å¼å®‰è£…çš„ï¼Œç”±äºæˆ‘ä»¬ä¸Šé¢å·²ç»å®‰è£…è¿‡Dockerï¼ŒæŒ‰ç…§Jenkinså®˜æ–¹ç»™çš„å®‰è£…æ–¹æ¡ˆå°±å¯ä»¥äº†ï¼Œé¦–å…ˆpullä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„ Jenkins é•œåƒé•œåƒåœ°å€ : jenkinsci/blueocean12docker pull jenkinsci/blueoceandocker images Docker2.png æŸ¥çœ‹å½“å‰Jenkinsç‰ˆæœ¬1docker inspect [IMAGE ID] è¿™é‡Œçš„ IMAGE ID åˆ™æ˜¯ä¸Šé¢ æŸ¥çœ‹é•œåƒçš„ IMAGE ID Jenkins1.png çº¢æ¡†å†…åˆ™æ˜¯ å¯¹åº”ç‰ˆæœ¬å· 123456# åˆ›å»ºä¸€ä¸ªå­˜æ”¾Jenkins Dockerçš„ç›®å½•mkdir /home/root/Jenkins# å¯åŠ¨ä¸€ä¸ªDockerdocker run -d --name jenkins -p 8081:8080 -v /home/jenkins:/home/jenkins jenkins/jenkins:lts# æŸ¥çœ‹jenkinsæœåŠ¡docker ps | grep jenkins Jenkins2.png æ‰“å¼€ http://IP:8081 Jenkins3.png è¾“å…¥å‘½ä»¤è¿›å…¥ Dockerå†…éƒ¨123docker exec -it jenkins bash# è·å–å¯†ç cat /var/jenkins_home/secrets/initialAdminPassword é‡å¯Docker1docker restart [CONTAINER ID] [CONTAINER ID] ä¸ºå½“å‰Jenkinsçš„ç‰ˆæœ¬å· ä¾‹å¦‚ 2.164.3 åˆ™è¾“å…¥ docker restart 2.164.3 Nginxåä»£Jenkinsï¼Œç»‘å®šåŸŸåç”±äºä¼—æ‰€å‘¨çŸ¥çš„æ°´ç‰›åŸæœåŠ¡å™¨å¡ï¼Œå›½å†…ç¯å¢ƒå¿…é¡»æ­é…CloudFlareæ‰å¯ä»¥ä½¿ç”¨ï¼Œå¦åˆ™å¤ªå¡äº†ï¼Œå› æ­¤å®‰è£…LNMPç¯å¢ƒï¼Œåç»­è‡ªåŠ¨æ„å»ºæ—¶ä¹Ÿå¯ä»¥æ„å»ºåˆ°è¿™é‡Œ å®‰è£…æ–¹æ³•ä¸€ï¼š LNMPç¯å¢ƒå®‰è£…æ•™ç¨‹ : LNMPä¸€é”®å®‰è£…åŒ… - å®‰è£…æ•™ç¨‹ æ‡’å¾—æ‰“å¼€çš„è¯ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥1wget http://soft.vpser.net/lnmp/lnmp1.6.tar.gz -cO lnmp1.6.tar.gz &amp;&amp; tar zxf lnmp1.6.tar.gz &amp;&amp; cd lnmp1.6 &amp;&amp; ./install.sh lnmp æˆ‘è¿™é‡Œå®‰è£…çš„æ˜¯ 1.6ç¨³å®šç‰ˆï¼Œéœ€è¦å…¶ä»–ç‰ˆæœ¬çš„å¯ä»¥è‡ªè¡Œä¿®æ”¹ç‰ˆæœ¬å·å®‰è£… å®‰è£…æ–¹æ³•äºŒï¼š apt-getå®‰è£…ï¼Œå»ºè®®å…ˆæ›´æ–°apt-get1apt-get install nginx æ‰“å¼€NGINXé…ç½®æ–‡ä»¶ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶(è¿™é‡Œæ˜¯lnmpç¯å¢ƒçš„é…ç½®æ–‡ä»¶åœ°å€ï¼Œapt-getå®‰è£…çš„nginxé…ç½®æ–‡ä»¶å­˜æ”¾äº /etc/nginx/conf.d ä¸­) 1vi /usr/local/nginx/conf/vhost/jenkins.conf è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œè¯·æ³¨æ„æ›¿æ¢æ‰ä¸‹é¢çš„ jenkins.0161.org1234567891011121314server &#123; listen 80; server_name jenkins.0161.org; client_max_body_size 60M; client_body_buffer_size 512k; location / &#123; proxy_pass http://localhost:8081; proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125;&#125; é‡å¯lnmpä½¿é…ç½®ç”Ÿæ•ˆ1lnmp reload æ‰“å¼€CloudFlareç»‘å®šåŸŸåï¼Œå¢åŠ CDNæ”¯æŒï¼Œæ­¤å¤„æ¯”è¾ƒç®€å•ï¼Œä¸å¤šèµ˜è¿° ç»“è¯­ä¸€ä¸ªå®Œæ•´çš„æ¶æ„ï¼Œéœ€è¦å¾ˆå¤šçš„ä»˜å‡ºï¼Œå¹¶éä¸€æœä¸€å¤•ï¼Œæœ¬æ–‡æ‰€å±æ¶æ„å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰å…¬å¸æˆ–è€…ä¸ªäººï¼Œå¤§å‹å…¬å¸è¿˜éœ€è¦K8sé›†ç¾¤ï¼Œæ‰¿å—å¤šå°‘å¹¶å‘å–å†³äºå¾ˆå¤šå› ç´ ï¼Œä»»ä½•æ¶æ„éƒ½ä¸èƒ½é€šæ€æ‰€æœ‰ç±»å‹çš„å…¬å¸","categories":[{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/categories/æ¶æ„/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"https://sbcoder.cn/tags/æ¶æ„/"},{"name":"ç‰ˆæœ¬æ§åˆ¶","slug":"ç‰ˆæœ¬æ§åˆ¶","permalink":"https://sbcoder.cn/tags/ç‰ˆæœ¬æ§åˆ¶/"}]},{"title":"å¼€å‘ä¸­å¸¸è§çš„MySQLæ•°æ®åº“ä¼˜åŒ–ç»†èŠ‚","slug":"å¼€å‘ä¸­å¸¸è§çš„MySQLæ•°æ®åº“ä¼˜åŒ–ç»†èŠ‚","date":"2019-06-20T10:17:03.000Z","updated":"2019-12-09T11:51:26.000Z","comments":true,"path":"2019/06/20/mysql_optimize.html","link":"","permalink":"https://sbcoder.cn/2019/06/20/mysql_optimize.html","excerpt":"","text":"å‰è¨€ä»¥æˆ‘çš„ä¹ æƒ¯æ¥è®²ï¼Œæ¯å¼€å§‹ä¸€ä¸ªæ–°çš„é¡¹ç›®éƒ½éœ€è¦å…ˆæŠŠæ€è·¯å®Œå–„ï¼Œç´§æ¥ç€å°±éœ€è¦å»ºç«‹æ•°æ®åº“ï¼Œåœ¨ç ä»£ç çš„æ—¶å€™ï¼Œå°±ä¸€èˆ¬ä¸ä¼šåœ¨ä¿®æ”¹æ•°æ®åº“çš„æ„é€ äº†ï¼Œå› æ­¤ï¼Œæ•°æ®åº“çš„ç»“æ„é€šå¸¸å…³ä¹ç€æŸ¥è¯¢çš„é€Ÿåº¦ä»¥åŠç¨‹åºçš„å®Œå–„ç¨‹åº¦ï¼Œä¸€ä¸ªå¥½çš„ç»“æ„å¯ä»¥è®©ä½ å°‘å†™å¾ˆå¤šä»£ç ï¼Œä¹Ÿèƒ½è®©ç¨‹åºçš„è¿è¡Œé€Ÿåº¦æ›´åŠ å¿«ï¼Œé€šå¸¸åœ¨å¤§å…¬å¸éƒ½æ˜¯ç”±DBAæ¥åšè¿™ä»¶äº‹ï¼Œä½†æ˜¯äº‹æ— ç»å¯¹ï¼Œä½œä¸ºä¸€ååˆæ ¼çš„åç«¯ï¼ŒæŒæ¡ä¸€äº›å°‘é‡çš„æ•°æ®åº“ä¼˜åŒ–ä¹Ÿæ˜¯å¾ˆéœ€è¦çš„ã€‚ MySQLä¼˜åŒ– - æ•°æ®ç±»å‹åŠCURDPROCEDURE ANALYSE()PROCEDURE ANALYSE() [prÉ™ËˆsÄ“jÉ™r ËˆÃ¦nÉ™laÉªz]æ˜¯ä¸€ä¸ªMySQLè‡ªå¸¦çš„ç»™æˆ‘ä»¬æä¾›æ•°æ®åº“ä¼˜åŒ–å»ºè®®çš„å‡½æ•°ï¼Œä»–å¯ä»¥ç›´æ¥è¿è¡Œåœ¨MySQLä¸­ï¼Œç›´æ¥åœ¨æ‰§è¡Œè¯­å¥ä¸­åŠ ä¸Šè¿™ä¸ªå‡½æ•°å³å¯1SELECT * FROM `list` WHERE 1 PROCEDURE ANALYSE ( ) è¿™æ®µSQLæ‰§è¡Œè¿‡åï¼Œå°†ä¼šæŠŠlistè¡¨ä¸­çš„æ•°æ®åˆ†æä¸€éï¼Œå¹¶æŠŠä»–çš„åˆ†æç»“æœå±•ç¤ºå‡ºæ¥ Field_nameMin_valueMax_valueMin_lengthMax_lengthEmpties_or_zerosNullsAvg_value_oravg_lengthstdOptimal_fieldtype ä»–å°†ä¼šæŠŠåˆ†æå‡ºæ¥çš„ å­—æ®µå æœ€çŸ­å€¼ æœ€å¤§å€¼ ä»¥åŠæœ€åä¸€åˆ—å°±æ˜¯MySQLç»™å‡ºçš„åˆ†æç»“æœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ‰ä¸€å®šæ•°æ®çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ†æï¼Œè¿™æ ·ç»™å‡ºçš„ç»“æœä¼šæ›´ç²¾ç¡®ä¸€äº›ï¼Œåªéœ€è¦æŸ¥çœ‹æœ€åä¸€åˆ—Optimal_fieldtypeçš„å€¼å³å¯ï¼Œè¿™ä¸ªå‡½æ•°å¹¶ä¸é€‚ç”¨äºæ•°æ®åº“è®¾è®¡é˜¶æ®µï¼Œå®ƒé€‚ç”¨äºåæœŸä½¿ç”¨ EXPLAINEXPLAINæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„MySQLè¯­æ³•ï¼Œåœ¨æˆ‘ä»¬åŠŸèƒ½æµ‹è¯•é˜¶æ®µï¼Œå¦‚æœå‘ç°æŸé¡µé¢éå¸¸æ…¢ï¼Œæ’é™¤é™æ€èµ„æºé—®é¢˜åå°±å¯ä»¥è¯•è¯•ä½¿ç”¨EXPLAINï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ‰§è¡Œè¯­å¥å‰é¢åŠ ä¸Š EXPLAIN æ¥è·å¾—æ‰§è¡Œè¿‡ç¨‹ï¼Œé€šè¿‡è¯¥ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°SQLå¦‚ä½•æ”¹å˜ä¼šå‡å°‘æŸ¥è¯¢æ—¶é—´å’Œæ¬¡æ•°ã€‚1EXPLAIN SELECT * FROM `list` WHERE 1 è¿™æ®µSQLæ‰§è¡Œåï¼Œå°†ä¼šè¿”å›å¦‚ä¸‹æ ¼å¼çš„åˆ†æç»“æœ idselect_typetabletypepossible_keyskeykey_lenrefrowsExtra æˆ‘ä»¬ä¸»è¦çœ‹rowså°±è¡Œï¼Œä¸ºäº†å¾—åˆ°æƒ³è¦çš„ç»“æœï¼Œrowsçš„å€¼è¶Šå°è¶Šå¥½ï¼Œä½¿ç”¨EXPLAINæ¥è°ƒè¯•ç®€ç›´æ˜¯å†å¥½ä¸è¿‡äº†ï¼ ENUM(æšä¸¾)ç±»å‹å¾ˆå¤šç¨‹åºå‘˜å¾€å¾€å–œæ¬¢ç»Ÿä¸€ä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œæ¯”å¦‚è¯´ â€˜varcharâ€™ ï¼Œè¿™å¯èƒ½æ˜¯æˆ‘è§è¿‡æœ€å¤šçš„æ•°æ®ç±»å‹äº†ï¼Œæ—©äº›æ—¶æœŸï¼Œçš„ç¡®æ˜¯æœ‰å¾ˆå¤šçš„å…¬å¸æˆ–è€…ç¨‹åºéƒ½æ˜¯å¤§é¢ç§¯ä½¿ç”¨ï¼Œéšç€MySQLçš„é©æ–°æ¢ä»£ï¼Œå¾ˆå¤šçš„ç±»å‹éƒ½å¯ä»¥é¿å…ä½¿ç”¨å®ƒã€‚æˆ‘åœ¨å¾ˆå¤šå¾—ç¨‹åºä¸Šæµ‹è¯•è¿‡ï¼ˆæœ‰æ•°æ®ï¼‰PROCEDURE ANALYSE()æ–¹æ³•ï¼Œä»–ç»™å‡ºäº†å¾ˆå¤š â€˜varcharâ€™ æ›¿æ¢ä¸º â€˜enumâ€™ çš„å»ºè®®ï¼Œè¿™è¯´æ˜ï¼Œenumç±»å‹çš„ç¡®æ˜¯ä¸€ä¸ªåº”è¯¥è¢«é‡è§†çš„æ•°æ®ç±»å‹ï¼Œä½†ç”±äºä»–æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰æ•°æ®ç±»å‹çš„æ—¶å€™å¹¶ä¸é€‚åˆç›´æ¥ä¸Šæ‰‹å®šä¹‰ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™éƒ½æ˜¯åœ¨æœ‰ä¸€å®šçš„æ•°æ®é‡çš„æ—¶å€™æ‰æƒ³è¦æ¢æ•°æ®ç±»å‹çš„ã€‚å¯ä»¥ç†è§£ä¸ºæšä¸¾å³æ—¶ç´¢å¼•ï¼Œæšä¸¾å°±ç›¸å½“äºç»™è¿™ä¸ªå­—æ®µçš„å¯èƒ½å€¼éƒ½åŠ ä¸Šäº†ä¸€ä¸ªç´¢å¼•ï¼Œä¸æˆ‘ä»¬ä¸ºäº†ä¼˜åŒ–æŸ¥è¯¢åŠ ç´¢å¼•æ˜¯ä¸€æ ·çš„æ¦‚å¿µã€‚enumæ›´é€‚ç”¨äºé€‰é¡¹å¡ç±»å­—æ®µï¼Œä¾‹å¦‚æ€§åˆ«ï¼Œè®¢å•çŠ¶æ€ç­‰ï¼Œå¦‚æœæ‚¨å­—æ®µä¸­åªæœ‰å‡ ä¸ªé‡å¤çš„å€¼ä¹Ÿæ˜¯éå¸¸æ¨èä½¿ç”¨çš„ã€‚ JOINé“¾æ¥æŸ¥è¯¢ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨å¼€å‘ä¸­éå¸¸å¸¸ç”¨çš„æŸ¥è¯¢æ–¹å¼ï¼Œé¦–å…ˆè¦çŸ¥é“ï¼Œæˆ‘ä»¬åœ¨å­¦æ ¡é‡Œå­¦ä¹ çš„å¤§å¤šæ•°æ˜¯ AND é“¾æ¥å¤šè¡¨æŸ¥è¯¢ï¼Œè™½ç„¶èƒ½å¤Ÿå°†ç»“æœæ— è¯¯çš„æŸ¥è¯¢å‡ºæ¥ï¼Œä½†æ˜¯é€Ÿåº¦å°±å½±å“çš„éå¸¸å¤šäº†ï¼Œè¿™é‡Œè¿˜æ˜¯æ¨èå¤§å®¶ä½¿ç”¨JOINæ¥è¿æ¥æŸ¥è¯¢æœ‰äº›åŒå­¦å¯èƒ½ä¸å¤ªç†è§£JOINï¼Œç®€å•è¯´ä¸€ä¸‹JOINçš„å†…è¿æ¥å’Œå¤–é“¾æ¥ï¼Œå·¦å¤–é“¾æ¥å’Œå³å¤–é“¾æ¥å§ å†…è¿æ¥å³æ˜¯A Bä¸¤è¡¨é“¾æ¥ï¼Œåªå–ä¸¤è¡¨å…±æœ‰çš„æ•°æ®ï¼Œå‡è®¾ B ä¸­ æœ‰çš„æ•°æ® A è¡¨å†…æ²¡æœ‰å¯¹åº”çš„æ•°æ®åˆ™æ— æ³•æŸ¥è¯¢åˆ° 1SELECT * FROM list1 INNER JOIN list2 on list1.id = list2.id å¤–è¿æ¥ï¼ˆFULL JOIN ä¹Ÿç§°ä½œå…¨è¿æ¥ï¼‰å³æ˜¯A Bä¸¤è¡¨é“¾æ¥ï¼Œå–ä¸¤è¡¨æ‰€æœ‰çš„æ•°æ®ï¼Œå³ä½¿ B è¡¨ä¸­çš„æŸäº›æ•°æ®æ— æ³•åŒ¹é…é“¾æ¥æ¡ä»¶æ—¶ï¼Œä¹Ÿæ­£å¸¸é“¾æ¥ 1SELECT * FROM list1 FULL JOIN list2 on list1.id = list2.id å·¦å¤–è¿æ¥ï¼Œå³æ˜¯ A Bä¸¤è¡¨é“¾æ¥ï¼Œå–ä¸¤è¡¨æ‰€æœ‰æ•°æ®ï¼Œè‹¥Aè¡¨ä¸­æœ‰Bè¡¨ä¸åŒ¹é…çš„æ•°æ®ï¼ŒåŒæ ·å±•ç¤ºå‡ºæ¥ï¼ŒBè¡¨å¦‚æœæœ‰Aä¸åŒ¹é…çš„æ•°æ®ï¼Œåˆ™ä¸å±•ç¤º 1SELECT * FROM list1 LEFT OUTER JOIN list2 on list1.id = list2.id å³å¤–è¿æ¥ï¼Œå³æ˜¯ A Bä¸¤è¡¨é“¾æ¥ï¼Œå–ä¸¤è¡¨æ‰€æœ‰æ•°æ®ï¼Œè‹¥Bè¡¨ä¸­æœ‰Aè¡¨ä¸åŒ¹é…çš„æ•°æ®ï¼ŒåŒæ ·å±•ç¤ºå‡ºæ¥ï¼ŒAè¡¨å¦‚æœæœ‰Bä¸åŒ¹é…çš„æ•°æ®ï¼Œåˆ™ä¸å±•ç¤ºï¼Œä¸å·¦å¤–è¿æ¥ç›¸å VvmQFU.png MySQLä¼˜åŒ– - ç»“æ„FULLTEXT INDEXFULLTEXT INDEX(å…¨æ–‡ç´¢å¼•)ï¼Œæ›´é€‚ç”¨äºæ–‡ç« å†…å®¹æœç´¢çš„ç´¢å¼•ï¼Œæˆ‘ä»¬åœ¨ä½œæœç´¢åŠŸèƒ½çš„æ—¶å€™ï¼Œå¾ˆå¤šäººå–œæ¬¢å°†æ–‡ç« å†…å®¹(content)å»ºç«‹æ™®é€šç´¢å¼•ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œè¿™ç§åšæ³•å¹¶ä¸ä¼šå¢åŠ æŸ¥è¯¢é€Ÿåº¦ï¼Œé€šå¸¸æˆ‘ä»¬åšæœç´¢çš„æ—¶å€™ï¼Œæ‰§è¡Œä¸‹åˆ—è¯­å¥ã€‚ 1SELECT content FROM `list` WHERE content LIKE '%é£å‘æ ‡%' å¦‚æœæœç´¢åŠŸèƒ½æƒé‡æ¯”è¾ƒé«˜çš„ç½‘ç«™ï¼Œå°±éœ€è¦å°†contentè¿™ä¸ªå­—æ®µå»ºç«‹ç´¢å¼•ã€‚ 1ALTER TABLE `list` ADD FULLTEXT (`content`) å¦‚æœæ˜¯phpmyadminç”¨æˆ·ï¼Œåœ¨phpmyadminä¸­ç›´æ¥ç‚¹å‡»â€™å…¨æ–‡æœç´¢â€™å³å¯ã€‚ MyISAM OR InnoDBï¼Ÿå°±æˆ‘ç°é˜¶æ®µå†™å‡ºæ¥çš„ä¸œè¥¿æ¥çœ‹ï¼ˆæ•°æ®é‡å°ï¼ŒæŸ¥è¯¢æ¬¡æ•°å°‘ï¼Œç”¨æˆ·é‡è¾ƒå°‘ï¼‰ï¼ŒMyISAMè‚¯å®šæ˜¯æœ€é€‚åˆæˆ‘çš„ï¼Œå®ƒæ›´é€‚ç”¨äºå°å‹ç½‘ç«™ï¼Œä»¥åŠäº‹åŠ¡å¤„ç†è¾ƒå°‘çš„ç½‘ç«™InnoDBåˆ™ä¸ä¹‹ç›¸åï¼Œå¦‚æœä½ çš„ä¸šåŠ¡æ¯”è¾ƒå¤æ‚ï¼Œé’ˆå¯¹æ•°æ®åº“çš„æ“ä½œè¾ƒå¤šçš„æ—¶å€™ï¼ŒInnoDBå°±ä¼šæ›´é€‚åˆä¸€äº›ã€‚ä½¿ç”¨INSERTæ’å…¥æ•°æ®æ—¶ MyISAM å°±æ¯” InnoDB æ›´å¿«ä¸€äº›ï¼Œè€Œ UPDATE æ—¶ InnoDB å°±ä¼šæ¯” MyISAM å¿«ä¸€äº› å¦‚æœæ‚¨æ˜¯è½»åº¦SQLç”¨æˆ·ï¼Œé‡åŠŸèƒ½ä¸é‡è§†ä¸šåŠ¡çš„é¡¹ç›®ï¼Œé‚£ä¹ˆæˆ‘ä¸ªäººä»¥ä¸º MyISAM æ›´é€‚åˆä¸€äº›å¦‚æœæ‚¨æ„Ÿè§‰ä¸šåŠ¡é€»è¾‘å¤æ‚ï¼Œç»å¸¸ä½¿ç”¨SQLï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨ InnoDB æœ€åä¹Ÿæ˜¯è§ä»è§æ™ºï¼Œæ²¡æœ‰å¥½åï¼Œå¦‚æœæ‚¨å¸Œæœ›æµ‹è¯•ï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç›´æ¥ä¿®æ”¹æ•°æ®åº“å¼•æ“æ¥æµ‹è¯•é€Ÿåº¦çš„ MySQLä¼˜åŒ– - å°çŸ¥è¯†ç‚¹ ä¸è¦ä½¿ç”¨ SELECT * æŸ¥è¯¢ ä¸è¦ä½¿ç”¨ NULL é¢‘ç¹æŸ¥è¯¢çš„å­—æ®µå»ºç«‹ç´¢å¼• ç´¢å¼•è¿‡å¤šæ—¶ä¼šå½±å“ UPDATE å’Œ INSERT çš„æ‰§è¡Œé€Ÿåº¦ é¿å…åœ¨ WHERE æ—¶ä½¿ç”¨ != &lt;&gt; ç­‰æ“ä½œç¬¦ï¼ŒMySQLä¼šè‡ªåŠ¨æ”¾å¼ƒç´¢å¼•ï¼Œç›´æ¥å…¨è¡¨æ‰«æ é¿å…ä½¿ç”¨ IN å’Œ NOT INï¼Œå°½é‡ä½¿ç”¨BETWEENï¼ŒMySQLä¼šè‡ªåŠ¨æ”¾å¼ƒç´¢å¼•ï¼Œç›´æ¥å…¨è¡¨æ‰«æ å¯ä»¥ä½¿ç”¨ EXISTS æ¥ä»£æ›¿ IN ä½¿ç”¨ æŸäº›æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ SELECT * FROM list with(index(ç´¢å¼•å)) WHERE â€¦. é¿å…ä½¿ç”¨ OR ä½œä¸ºè°ƒä»¶ï¼Œå¯ä»¥ä½¿ç”¨ UNION å¹¶é›†æŸ¥è¯¢å°†ä¸¤æ¬¡æŸ¥è¯¢ç»“æœåˆå¹¶ å°½å¯èƒ½å°†è¡¨å†…å®¹é•¿åº¦å›ºå®š æŸ¥è¯¢æ—¶å¦‚æœåªæŸ¥è¯¢ä¸€æ¡ä¿¡æ¯ï¼Œå°±ä½¿ç”¨ LIMIT 1 é¿å…ä½¿ç”¨æ¯”è¾ƒè¡¨è¾¾å¼ å¦‚ 10000+1 = id å¯ä»¥ä½¿ç”¨ id = 10000+1 è®°å¾—å°†æŸ¥è¯¢é“¾æ¥å³æ—¶å…³é—­æ‰ ä½¿ç”¨å˜é‡æ¥ç»™MySQLå¼€å¯æŸ¥è¯¢ç¼“å­˜ï¼Œé¿å…ä½¿ç”¨MySQLå†…ç½®å˜é‡å‡½æ•° è®¾ç½®çš„ä¸»é”®å°½é‡ä½¿ç”¨é•¿åº¦çŸ­ä¸”æœ€å¥½æ˜¯intç±»å‹ å‚ç›´åˆ†å‰²ï¼Œå°†å¤§é‡çš„å­—æ®µçš„è¡¨ä¼˜åŒ–æˆå¤šä¸ªå°‘å­—æ®µçš„è¡¨ INSERT å’Œ DELETE æ˜¯ä¸€ä¸ªå¯ä»¥é”å®šæ•°æ®è¡¨çš„SQLè¯­å¥ï¼Œå¿…é¡»ç­‰å¾…æ‰§è¡Œå®Œæ¯•åæ‰ä¼šè§£é™¤é”å®šï¼Œå¦‚æœè¿™æ¡è¯­å¥æ‰§è¡Œèµ·æ¥è¿‡äºç¼“æ…¢ï¼Œè¯·è°¨æ…ä½¿ç”¨ Object Relational Mapper Prepared Statements å‚è€ƒ: Top 20+ MySQL Best Practiceså‚è€ƒ: å»–é›ªå³°çš„ä¸ªäººç½‘ç«™ - é“¾æ¥æŸ¥è¯¢","categories":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/categories/ä¼˜åŒ–/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"MySQL","slug":"MySQL","permalink":"https://sbcoder.cn/tags/MySQL/"}]},{"title":"mm131å…¨æ ˆå¤šçº¿ç¨‹çˆ¬è™«","slug":"mm131å…¨æ ˆå¤šçº¿ç¨‹çˆ¬è™«","date":"2019-06-19T14:34:31.000Z","updated":"2019-06-19T14:56:33.000Z","comments":true,"path":"2019/06/19/mm131_spider.html","link":"","permalink":"https://sbcoder.cn/2019/06/19/mm131_spider.html","excerpt":"","text":"èµ·å› LOCçš„å¤§ä½¬ä»¬æœ€è¿‘å¼€å§‹ç–¯ç‹‚çš„çˆ¬å–mm131ï¼Œä½œä¸ºä¸€ä¸ªPythonåˆå¿ƒè€…ï¼Œä½œä¸ºæŠ€æœ¯ä¸Šçš„å­¦ä¹ ï¼Œä¹Ÿè¦ä¸æ—¶ä¿±è¿›ï¼Œç®€å•å†™äº†ä¸€ä¸ªå›¾ç‰‡ä¸‹è½½çˆ¬è™«ï¼Œçœ‹åˆ°å¤§ä½¬ä»¬ä¼¼ä¹æ˜¯åšäº†ä¸€ä¸ªtypechooçš„å¯¹æ¥æ¥å£ï¼Œæˆ‘è¿™è¾¹å›å¤´æœ‰ç©ºä¹Ÿæä¸€ä¸ªwordpressçš„æ¥å£ï¼ˆåªåœ¨åšå®¢å†…å‘å¸ƒï¼‰ï¼Œä¹‹å‰å†™è¿‡ä¸€ä¸ªæ–°æµªè¿œç¨‹ä¸Šä¼ çš„æ¥å£ï¼Œç”±äºç§ç§åŸå› ï¼Œæ–°æµªå·²ç»ä¸æ”¯æŒå¤–é“¾äº†ï¼Œå› æ­¤è¿™ä¸ªwordpressæ¥å£å¯èƒ½å°±æœ‰æ—¶é—´å†åšäº†ï¼Œä¸ç„¶åšå‡ºæ¥ä¹Ÿæ˜¯ä¸ªæ‘†è®¾ï¼Œæ²¡åœ°æ–¹æ”¾ã€‚ ä»£ç è§£æç½‘å€ä¸å‘äº†ï¼Œç›´æ¥è®²ï¼Œæˆ–è€…å¤§å®¶ç›´æ¥ç™¾åº¦è°·æ­Œéƒ½å¯ä»¥æœå¾—åˆ°ã€‚æ‰“å¼€ç½‘ç«™,æ€»å…±æœ‰å¦‚ä¸‹å…­ä¸ªåˆ†ç±» mm131.jpg æ¯ä¸ªåˆ†ç±»ä¸‹é¢éƒ½æœ‰ä¸€å †çš„å›¾é›†ï¼Œæœ‰Nä¸ªåˆ†é¡µçš„å›¾é›†ï¼Œä½†æ˜¯ç¬¬ä¸€é¡µè·Ÿç¬¬äºŒé¡µçš„åœ°å€è¿˜ä¸å¤ªä¸€æ ·ï¼Œè¿™ç‚¹è·Ÿ192ttåšçš„å¾ˆç›¸ä¼¼ï¼Œæ„Ÿè§‰è¿™å‡ ä¸ªç«™é•¿æ˜¯ä¸æ˜¯éƒ½æ˜¯ç”¨çš„åŒä¸€å¥—ç¨‹åºï¼Œå¦‚æœæ˜¯çš„è¯å¯ä»¥é€šæ€äº†ã€‚ã€‚ã€‚é¦–å…ˆéå†å›¾é›†çš„åœ°å€ï¼Œåˆ°ç›®å‰æ›´æ–°æ–‡ç« æˆªæ­¢ï¼Œä¸€å…±å¤§æ¦‚5000å¤šå¥—æŒ‰åˆ†ç±»ç»™ä»–æä¸€ä¸ªåˆ†ç±»å¾ªç¯ 1234list = &#123;'xinggan':6,'qingchun':1,'xiaohua':2,'chemo':3,'qipao':4,'mingxing':5&#125; # list = &#123;'mingxing':5&#125; for key in list: getPageUrl(key,list[key]) è§£æå›¾ç‰‡urlï¼Œç”¨æ­£åˆ™è·å–å°±è¡Œï¼Œç”¨bs4å–åˆ°æœ«é¡µçš„åœ°å€ï¼Œç„¶åéå†å¾ªç¯å–å›¾é›†åœ°å€ 1234567try: i.find('img').get('src')except Exception as e: for s in i.find_all('a'): endPage = s.get('href') endPage = rex('list_%s_(\\d+).html'%num,endPage) continue è·å–å›¾é›†åœ°å€12345678910nextUrl = \"%s/list_%s_%s.html\"%(url,num,i+2)response = requests.get(nextUrl, headers=headers)response.encoding = 'gb2312'soup = BeautifulSoup(response.text, 'html.parser')for i in soup.find('dl', &#123;'class': 'public-box'&#125;).find_all('dd'): try: i.find('img').get('src') except Exception as e: continue print(i.find('a').get('href')) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmm131çš„å›¾ç‰‡æ˜¯æœ‰é˜²ç›—é“¾çš„ï¼Œæ ¹æ®refereråˆ¤æ–­ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªå›¾é›†çš„åœ°å€è®¾ç½®ä¸Šå³å¯1234headers = &#123; \"User-Agent\": \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", 'referer': \"http://www.mm131.com/xinggan/4995.html\",&#125; çº¿ç¨‹æ± åº”ç”¨ä¹‹å‰çš„çˆ¬è™«é™¤äº†Scrapyæå‡ºæ¥çš„ä¹‹å¤–éƒ½æ˜¯å•çº¿ç¨‹çš„çˆ¬è™«ï¼Œä¼˜ç‚¹æ˜¯æ¯”è¾ƒç¨³å®šï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå¤ªæ…¢äº†ï¼Œmm131è¿™ä¸ªç«™çš„å›¾å¤§éƒ½æ¯”è¾ƒå°ï¼Œå¦‚æœæ˜¯ä¸€å¼ ä¸€å¼ ä¸‹è½½ç¡®å®æ˜¯ä¸å¤ªåˆ’ç®—ï¼Œäºæ˜¯æäº†ä¸ªçº¿ç¨‹æ± ã€‚Pythonçš„çº¿ç¨‹æ± å¾ˆç®€å•ï¼Œåªéœ€è¦å¼•å…¥ threadpool å³å¯ï¼Œå¦‚æœæŠ¥é”™ï¼Œè¯· pip install threadpool,12345678910# å¼•å…¥threadpoolimport threadpool# åˆ›å»ºçº¿ç¨‹æ± ï¼Œè®¾ç½®ä¸º12çº¿ç¨‹ï¼Œå¯ä»¥æ ¹æ®è‡ªèº«æƒ…å†µä¿®æ”¹pool = threadpool.ThreadPool(12)# åˆ›å»ºcallbackå‡½æ•°ï¼Œå‚æ•°1 getSingleData æ˜¯éœ€è¦è°ƒç”¨çš„å‡½æ•°åï¼Œlistæ˜¯å‡½æ•°getSingleDataçš„å‚æ•°ï¼Œè¯¥æ–¹æ³•é€‚ç”¨äºå•ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œlistæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„æˆ–å¯¹è±¡pageTask = threadpool.makeRequests(getSingleData, list)# æ‰§è¡Œçº¿ç¨‹æ± [pool.putRequest(req) for req in pageTask]# ç­‰å¾…å®Œæˆåé€€å‡ºpool.wait() æ¼”ç¤ºå’Œä¸‹è½½æ¼”ç¤ºå›¾ å¤šçº¿ç¨‹æ¼”ç¤º.jpg ä¸‹è½½ç»“æœ.jpg ä¸‹è½½æ¼”ç¤ºä»£ç ä¸å…¨ï¼Œç›´æ¥ä¸Šåœ°å€https://github.com/ai0by/ai0by-spider/tree/master/mm131","categories":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/categories/Python/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/tags/Python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://sbcoder.cn/tags/çˆ¬è™«/"},{"name":"ç¦åˆ©","slug":"ç¦åˆ©","permalink":"https://sbcoder.cn/tags/ç¦åˆ©/"}]},{"title":"Redis/Redisé›†ç¾¤ä»¥åŠåœ¨Laravelä¸­çš„ä½¿ç”¨æ–¹æ³•","slug":"Redis-Redisé›†ç¾¤ä»¥åŠåœ¨Laravelä¸­çš„ä½¿ç”¨æ–¹æ³•","date":"2019-06-17T13:19:37.000Z","updated":"2019-06-17T13:21:08.000Z","comments":true,"path":"2019/06/17/Redis_laravel_PHP.html","link":"","permalink":"https://sbcoder.cn/2019/06/17/Redis_laravel_PHP.html","excerpt":"","text":"Redisçš„æ•°æ®ç±»å‹Redisä¹Ÿç®—æ˜¯ä¸€ç§æ•°æ®çš„å®¹å™¨ï¼Œæ‰¿è½½åœ¨å†…å­˜ä¸Šï¼Œå› æ­¤å®ƒçš„å„æ–¹é¢æ€§èƒ½éƒ½æ¯”è¾ƒå¿«ï¼Œä¸”ä½œä¸ºéå…³ç³»å‹æ•°æ®åº“ï¼Œé¢å¯¹å„ç§ç´¢å¼•ä¹Ÿæ¯”æ™®é€šçš„æ•°æ®åº“æŸ¥è¯¢å¿«ï¼Œä¸åŒçš„åœºæ™¯ä¸‹ä½¿ç”¨ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œé€‚ç”¨äºå¾ˆå¤šåœ°æ–¹ å­—ç¬¦ä¸²ç±»å‹ Stringä¸€ä¸€å¯¹åº”ï¼Œä½¿ç”¨åœºæ™¯æ¯”è¾ƒå¤š key:value å½¢å¼ å‘½ä»¤ æè¿° set key value è®¾ç½®æŒ‡å®škeyå€¼ get key è·å–æŒ‡å®škeyçš„valueå€¼ mget key1 key2 è·å–å¤šä¸ªkey çš„ valueï¼ŒæŒ‰é¡ºåºè¿”å›valueå€¼ mset key1 â€˜value1â€™ key2 â€˜value2â€™ æ‰¹é‡è®¾ç½®å¤šä¸ªkeyçš„value strlen key è¿”å›å¯¹åº”valueé•¿åº¦ getrange key start end æˆªå–å­—ç¬¦ä¸² append key value è¿½åŠ keyå…³è”çš„valueå€¼ï¼Œè¿”å›é•¿åº¦ getset key value è®¾ç½®keyçš„valueå¹¶è¿”å›åŸvalueå€¼ setex key time value è®¾ç½®valueå€¼ï¼Œå¹¶åŠ ä¸Šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä½¿ç”¨ttl keyæŸ¥çœ‹è¿‡æœŸæ—¶é—´ï¼Œç§’ä¸ºå•ä½ setnx key value å½“keyä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®value msetnx key1 â€˜value1â€™ key2 â€˜value2â€™ å½“æ‰€æœ‰çš„keyéƒ½ä¸å­˜åœ¨æ—¶ï¼Œæ‰¹é‡è®¾ç½®å¤šä¸ªkeyçš„value incr key å°†keyå…³è”valueçš„å€¼åŠ ä¸€ï¼Œä»…å¯¹æ•°å­—æœ‰æ•ˆ incrby key num å°†keyå…³è”valueçš„å€¼åŠ numï¼Œä¾‹å¦‚ 10ï¼Œä»…å¯¹æ•°å­—æœ‰æ•ˆ incrbyflout key num å°†keyå…³è”valueçš„å€¼åŠ numï¼Œæµ®ç‚¹ç±»å‹ decr key å°†keyå…³è”valueçš„å€¼å‡ä¸€ï¼Œä»…å¯¹æ•°å­—æœ‰æ•ˆ decrby key num å°†keyå…³è”valueçš„å€¼å‡numï¼Œä¾‹å¦‚ 10ï¼Œä»…å¯¹æ•°å­—æœ‰æ•ˆ å“ˆå¸Œç±»å‹ Hashä¸€å¯¹ä¸€å¯¹å¤šï¼Œç±»ä¼¼å­—ç¬¦ä¸²ï¼Œä½†åˆåŒºåˆ«äºå­—ç¬¦ä¸²ï¼Œå®ƒæ¯”å­—ç¬¦ä¸²å¤æ‚ä¸€äº›ï¼ŒåŒæ ·æ˜¯key:valueï¼Œä½†æ˜¯ä»–çš„valueå¯ä»¥æ˜¯ä¸€ä¸ªmapï¼ŒåŒæ—¶ï¼Œå®ƒä¹Ÿæ— æ³•ç»™å•ä¸ªå±æ€§èµ‹äºˆè¿‡æœŸæ—¶é—´ï¼Œä½†å¯ä»¥ç»™å•ä¸ªå±æ€§è®¾ç½®å€¼ï¼ŒæŸäº›æƒ…å†µä¸‹æ¯”Stringå ç”¨èµ„æºå°‘ï¼Œå½“éœ€è¦ç¼“å­˜æ•´å¼ è¡¨æ—¶æ¨èä½¿ç”¨ å‘½ä»¤ æè¿° hset key field value è®¾ç½®keyå…³è”çš„value hkeys key è·å–æ‰€æœ‰çš„key hgetall key è·å–keyçš„æ‰€æœ‰å¯¹åº”field hvals key è·å–hashè¡¨ä¸­æ‰€æœ‰çš„value hlen key è·å–keydçš„é•¿åº¦ hmget key field1 field2 è·å–å¤šä¸ªfieldçš„å€¼ hmset key field1 value1 field2 value2 è®¾ç½®å¤šä¸ªfieldçš„å€¼ hdel key field åˆ é™¤å•ä¸ªfieldçš„å•ä¸ªå±æ€§ hsetnx key field value å½“fieldä¸å­˜åœ¨æ—¶å­˜å‚¨æ•°å€¼ hincrby key field num ç»™æŒ‡å®šå­—æ®µå¢åŠ æ•°å€¼ï¼Œæ•´æ•° hincrbyfloat key field num ç»™æŒ‡å®šå­—æ®µå¢åŠ æµ®ç‚¹æ•° åˆ—è¡¨ç±»å‹ Listç±»ä¼¼æ ˆï¼Œæ‹¥æœ‰æ ˆçš„ç‰¹æ€§ï¼Œä¹Ÿæœ‰é“¾è¡¨çš„ç‰¹æ€§ï¼Œäº¦å¯ç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ï¼Œä½¿ç”¨åœºæ™¯å¾ˆå¹¿ å‘½ä»¤ æè¿° lpush key value1 value2 å°†å¤šä¸ªvalueæ’å…¥åˆ°å…³è”çš„keyé‡Œé¢ å¤´éƒ¨ lpushx key value å°†valueæ’å…¥åˆ°keyä¸­ï¼Œéœ€è¦keyå·²ç»å­˜åœ¨ å¤´éƒ¨ lpop key åˆ é™¤å¹¶è·å–å½“å‰keyé‡Œé¢çš„ç¬¬ä¸€ä¸ªå…ƒç´  llen key è·å–å½“å‰keyå…³è”çš„listé•¿åº¦ rpush key value1 value2 å°†å¤šä¸ªvalueæ’å…¥åˆ°å…³è”çš„keyé‡Œé¢ å°¾éƒ¨ rpop key åˆ é™¤å¹¶è·å–åˆ—è¡¨å†…çš„æœ€åä¸€ä¸ªå…ƒç´  rpushx key value å°†valueæ’å…¥åˆ°keyä¸­ï¼Œéœ€è¦keyå·²ç»å­˜åœ¨ å°¾éƒ¨ blpop key1 key2 timeout åˆ é™¤å¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œkey1å­˜åœ¨æ—¶ä¸æ‰§è¡Œkey2ï¼Œå¦‚æœæ²¡æœ‰ä¼šä¸€ç›´é˜»å¡åˆ°å¼¹å‡ºä¸ºæ­¢ï¼Œå»ºè®®æ·»åŠ å»¶æ—¶ brpop key1 key2 timeout åˆ é™¤å¹¶è·å–åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œkey1å­˜åœ¨æ—¶ä¸æ‰§è¡Œkey2ï¼Œå¦‚æœæ²¡æœ‰ä¼šä¸€ç›´é˜»å¡åˆ°å¼¹å‡ºä¸ºæ­¢ï¼Œå»ºè®®æ·»åŠ å»¶æ—¶ lindex key é€šè¿‡ç´¢å¼•æ¥è·å–listä¸­çš„å…ƒç´  lset key index value é€šè¿‡ç´¢å¼•æ¥è®¾ç½®ç›¸åº”å…ƒç´ çš„å€¼ lrange key start end æˆªå–æŒ‡å®šåˆ—è¡¨å†…å…ƒç´  ltrim key start end åªä¿ç•™å¼€å§‹å’Œç»“æŸå†…çš„å…ƒç´  é›†åˆ setæ•°æ®æ± ï¼Œæ— åºï¼Œå¯è®¡ç®—å·®é›†äº¤é›†ç­‰ï¼Œä¹‹å‰å†™çˆ¬è™«æ—¶ç”¨é›†åˆåšè¿‡å»é‡ï¼ŒPythonä½¿ç”¨redisä¹Ÿæ˜¯éå¸¸æ–¹ä¾¿çš„ å‘½ä»¤ æè¿° sadd key member1 member2 å‘é›†åˆå†…æ·»åŠ å…ƒç´  scard key è·å–é›†åˆå†…å…ƒç´ æ•°é‡ smembers key è·å–é›†åˆå†…æ‰€æœ‰çš„å…ƒç´  sismember key member åˆ¤æ–­memberæ˜¯å¦æ˜¯keyé›†åˆçš„å­å…ƒç´  sdiff key1 key2 è·å–ç»™å®šé›†åˆçš„å·®é›† sinter key1 key2 è·å–ç»™å®šé›†åˆçš„äº¤é›† sunion key1 key2 è·å–ç»™å®šé›†åˆçš„å¹¶é›† spop key éšæœºåˆ é™¤ä¸€ä¸ªé›†åˆå†…å…ƒç´ å¹¶è¿”å› srandmember key num è¿”å›é›†åˆå†…çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªéšæœºå…ƒç´  srem key member1 member2 åˆ é™¤é›†åˆä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªæŒ‡å®šå…ƒç´  å…¶ä»–å‰©ä¸‹çš„æ•°æ®ç±»å‹ç¡®å®æ˜¯æ²¡ç”¨è¿‡ï¼Œè¿™é‡Œä¸ä¾¿å¤šè¯´ Laravelä½¿ç”¨redisæµç¨‹ç®€å•æ¥è¯´å¦‚ä¸‹å›¾æ‰€ç¤º Laravelä½¿ç”¨redis ç¨‹åºå°†æ•°æ®å­˜å‚¨è¯·æ±‚å‘é€ç»™Laravelå†…ç½®çš„redisæ¨¡å—ï¼ˆPHPRedisï¼ŒPredisç­‰ï¼‰ï¼Œå¹¶åœ¨config/database.phpä¸­é…ç½®å¥½redisçš„ç«¯å£å¯†ç ç­‰ä¿¡æ¯ï¼Œé€šè¿‡å†…ç½®æ¨¡å—è°ƒç”¨å·²ç»å®‰è£…å¥½çš„rediså³å¯ä½¿ç”¨rediså­˜å‚¨ä½¿ç”¨æ•°æ®äº†ï¼Œç„¶årediså†…éƒ¨å¤„ç†æ•°æ®æˆ‘ä»¬å¦‚æœä¸åšåº•å±‚çš„è¯ï¼Œæ­£å¸¸å­˜å‚¨ä½¿ç”¨ï¼Œåªéœ€è¦å¤„ç†å¥½ç¨‹åºä¸Laravelä¹‹é—´çš„è¿‡ç¨‹å°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œäº†è§£PHPRediså’ŒPrediså°±å¯ä»¥äº†ï¼Œç›®å‰ä¼¼ä¹å¤§å¤šæ•°äººä½¿ç”¨çš„éƒ½æ˜¯è¿™ä¸¤ç§ï¼Œä¹Ÿä¸ä»…é™äºLaravelï¼ŒåŸç”ŸPHPä»¥åŠåƒSwooleè¿™ç§çš„ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚ å…³äºLaravelä¸­çš„Redisé…ç½®ä½¿ç”¨ å¯ä»¥å‚è€ƒ Laravelä¸­æ–‡æ–‡æ¡£5.8 - redis 1234567// laravel ç®€å•è°ƒç”¨ç¤ºä¾‹use Illuminate\\Support\\Facades\\Redis;class testRedis()&#123; Redis::set('username','é£å‘æ ‡'); $username = Redis::get('username'); return $username;&#125; Laravelä½¿ç”¨Redisé›†ç¾¤ä»ç„¶æ˜¯åœ¨ config/database ä¸­é…ç½® clusters123456789101112131415161718192021222324252627282930313233'redis' =&gt; [ 'client' =&gt; env('REDIS_CLIENT', 'predis'), 'options' =&gt; [ 'cluster' =&gt; env('REDIS_CLUSTER', 'predis'), // 'cluster' =&gt; env('redis'), ], 'clusters' =&gt; [ 'vaneCache' =&gt; [ [ 'host' =&gt; env('REDIS_HOST', '127.0.0.1'), 'password' =&gt; env('REDIS_PASSWORD', null), 'port' =&gt; env('REDIS_PORT', 6379), 'database' =&gt; 1, ], [ 'host' =&gt; env('REDIS_HOST', '127.0.0.1'), 'password' =&gt; env('REDIS_PASSWORD', null), 'port' =&gt; env('REDIS_PORT', 6379), 'database' =&gt; 2, ], [ 'host' =&gt; env('REDIS_HOST', '127.0.0.1'), 'password' =&gt; env('REDIS_PASSWORD', null), 'port' =&gt; env('REDIS_PORT', 6379), 'database' =&gt; 3, ], ], ], ], åœ¨ä½¿ç”¨æ—¶ä»…éœ€è¦ ä½¿ç”¨ connection å³å¯ 1234$redis1 = Redis::connection('vaneCache');$redis1-&gt;set('username','é£å‘æ ‡');$username = $redis1-&gt;get('username');echo $username;","categories":[{"name":"PHP","slug":"PHP","permalink":"https://sbcoder.cn/categories/PHP/"}],"tags":[{"name":"ä¼˜åŒ–","slug":"ä¼˜åŒ–","permalink":"https://sbcoder.cn/tags/ä¼˜åŒ–/"},{"name":"Redis","slug":"Redis","permalink":"https://sbcoder.cn/tags/Redis/"},{"name":"PHP","slug":"PHP","permalink":"https://sbcoder.cn/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://sbcoder.cn/tags/Laravel/"}]},{"title":"tuwanï¼ˆå…”ç©ï¼‰å…¨ç«™å¦¹å­å›¾çˆ¬è™«å¯å¤šçª—å£","slug":"tuwanå…¨ç«™å¦¹å­å›¾çˆ¬è™«å¯å¤šçª—å£","date":"2019-05-13T15:01:00.000Z","updated":"2019-05-13T15:29:23.000Z","comments":true,"path":"2019/05/13/tuwan_spider.html","link":"","permalink":"https://sbcoder.cn/2019/05/13/tuwan_spider.html","excerpt":"","text":"å‰è¨€å…”ç©æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„å¦¹å­å›¾ç½‘ç«™ï¼Œè·Ÿæ›¾ç»çš„PRç¤¾æœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„ï¼ŒèŠ±å°‘é‡çš„é’±å¯ä»¥çœ‹Coserçš„å›¾ç‰‡ï¼Œä½†æ˜¯tuwançš„å¦¹å­è¿˜æ˜¯å¾ˆæ­£ç»çš„å“Ÿ~å…”ç©å®˜ç½‘ tuwanjun.comä»¥ä¸‹æ˜¯ç½‘ç«™æˆªå›¾ tuwan å…”ç©çš„æ›´æ–°é€Ÿåº¦è¿˜æ˜¯ä¸é”™çš„å‘¢~ ç ´è§£çœ‹åˆ°å®˜ç½‘çš„å¥—å›¾æ‰“å¼€åï¼Œä¸€èˆ¬æ˜¯æœ‰å‡ å¼ å¯ä»¥çœ‹å¾—å›¾ï¼Œä¹Ÿæœ‰ä¸€å †å°ºå¯¸å°çš„é¢„è§ˆå›¾ï¼Œåœ°å€å¾ˆç›¸ä¼¼ï¼Œä¾‹å¦‚è¿™å¼ 1http://img4.tuwandata.com/v3/thumb/jpg/YjAzYiwxNTgsMTU4LDksMywxLC0xLE5PTkUsLCw5MA==/u/GLDM9lMIBglnFv7YKftLBuvzpwYbEIoBh8ap84BsgXdniTdx80UqsXLdP5yaJZklUj09PvGO8IYpAC3nOanE0EHpB9bCnRKUnvdbAJH6CcXC.jpg YjAzYiwxNTgsMTU4LDksMywxLC0xLE5PTkUsLCw5MA==è¿™ä¸€ä¸²å¾ˆå®¹æ˜“çœ‹çš„å‡ºæ˜¯base64åŠ å¯†è¿‡çš„ä¸²ï¼Œç»è¿‡è§£å¯†è·å¾—12base64.b64decode(imgurl)# b03b,158,158,9,3,1,-1,NONE,,,90 è¿™é‡Œçš„158,158å°±æ˜¯ç¼©ç•¥å›¾çš„å°ºå¯¸äº†ï¼Œæˆ‘ä»¬å°è¯•ä¿®æ”¹ç¼©ç•¥å›¾å°ºå¯¸ç„¶ååœ¨base64åŠ å¯†åå°±å¯ä»¥å–å¾—åœ°å€ï¼Œç»è¿‡å°è¯•ï¼Œä¿®æ”¹ä¸º 0ï¼Œ0å³å¯è¿˜åŸåŸå›¾å°ºå¯¸~12base64.b64encode(base64.b64decode(imgurl.encode('utf-8')).replace('158','0'))# YjAzYiwwLDAsOSwzLDEsLTEsTk9ORSwsLDkw ç»„åˆæˆåŸå›¾åœ°å€ï¼š1http://img4.tuwandata.com/v3/thumb/jpg/YjAzYiwwLDAsOSwzLDEsLTEsTk9ORSwsLDkw/u/GLDM9lMIBglnFv7YKftLBuvzpwYbEIoBh8ap84BsgXdniTdx80UqsXLdP5yaJZklUj09PvGO8IYpAC3nOanE0EHpB9bCnRKUnvdbAJH6CcXC.jpg ä¸‹è½½æºä»£ç å·²ç»å¼€æºåˆ°Githubä¸Šäº†ä¸Šä¸€å¼ æµ‹è¯•å›¾ æµ‹è¯•å›¾ ä¸‹è½½åœ°å€ï¼štuwan_spider","categories":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/categories/Python/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/tags/Python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://sbcoder.cn/tags/çˆ¬è™«/"},{"name":"ç¦åˆ©","slug":"ç¦åˆ©","permalink":"https://sbcoder.cn/tags/ç¦åˆ©/"}]},{"title":"Discuzä¼šå‘˜æ•°æ®ä¸Wordpressäº’é€š","slug":"Discuzä¼šå‘˜æ•°æ®ä¸Wordpressäº’é€š","date":"2019-04-11T12:06:06.000Z","updated":"2019-05-13T14:57:58.000Z","comments":true,"path":"2019/04/11/Discuz-Userinfo-To-Wordpress.html","link":"","permalink":"https://sbcoder.cn/2019/04/11/Discuz-Userinfo-To-Wordpress.html","excerpt":"","text":"æƒ…æ™¯è¿™ä¸ªæƒ…æ™¯å¯èƒ½é‡åˆ°çš„ä¹Ÿä¸åœ¨å°‘æ•°ï¼Œä¸æƒ³èˆå¼ƒç”¨æˆ·æ•°æ®ï¼Œè¿˜æƒ³è®©ç”¨æˆ·æ— éœ€æ³¨å†Œåœ¨æ–°ç«™ä¿ç•™è´¦å·ã€‚å®é™…å½“æˆ‘ä»¬åœ¨è¿ç§»çš„æ—¶å€™ï¼Œç¨å¾®äº†è§£æ•°æ®åº“çš„åŒå­¦åº”è¯¥æ˜ç™½æƒ³è¦è¿ç§»ç”¨æˆ·æ•°æ®åªéœ€è¦è¿ç§»ç”¨æˆ·æ•°æ®è¡¨å³å¯ã€‚å®é™…ä¸Šæˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯ä¸­é€”é‡åˆ°äº†å‡ ä¸ªå°é—®é¢˜ï¼Œè¿™é‡Œæˆ‘æ€»ç»“ä¸€ä¸‹ï¼ Discuzç”¨æˆ·å¯†ç åŠ å¯†ç®—æ³•Discuzçš„ç”¨æˆ·ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ â€˜pre_common_memberâ€˜ è¡¨é‡Œï¼ŒåŒ…å«äº†æˆ‘ä»¬éœ€è¦è½¬ç§»çš„ é‚®ç®±,ç”¨æˆ·å,å¯†ç ,ç§¯åˆ†,ip ç­‰å„ç±»ä¿¡æ¯é‚£ä¹ˆå¾ˆç®€å•äº†ï¼Œä¾¿åˆ©è¿™ä¸ªè¡¨å†æ’å…¥åˆ°Wordpressè¡¨å†…å³å¯ä½†åœ¨å¯¼å…¥è¡¨ä¹‹å‰éœ€è¦å…ˆæµ‹è¯•ä¸€ä¸‹ç”¨æˆ·æ•°æ®æ˜¯å¦åŒ¹é…ä»¥ç¤ºä¸¥è°¨~å½“æˆ‘æµ‹è¯•å¯†ç åŒ¹é…çš„æ—¶å€™å‘ç°ï¼Œè¿™é‡Œçš„å¯†ç ä¼¼ä¹å¹¶ä¸åŒ¹é…ï¼Œé¦–å…ˆæˆ‘æƒ³åˆ°çš„å°±æ˜¯åº”è¯¥æ˜¯åŠ ç›äº†ï¼Œä½†æ˜¯çºµè§‚æ•´ä¸ª â€˜pre_common_memberâ€˜ è¡¨ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰è¯¥æœ‰çš„å­—æ®µç½‘ä¸Šæ‰¾äº†ä¸€åœˆå‘ç°Discuzçš„ç”¨æˆ·çœŸå®å¯†ç æ˜¯å­˜åœ¨ â€˜pre_ucenter_membersâ€˜ è¡¨å†…çš„ï¼Œâ€™pre_common_memberâ€˜ è¡¨å†…çš„å¯†ç æˆ‘ç°åœ¨è¿˜ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œä½†è‡³å°‘è·Ÿæˆ‘ä»¬éœ€è¦è¿ç§»çš„æ•°æ®æ²¡ä»€ä¹ˆå…³è”ã€‚ä» â€˜pre_ucenter_membersâ€˜ è¡¨ä¸­æ‰¾åˆ°äº†æˆ‘ä»¬éœ€è¦çš„ â€˜saltâ€˜ å­—æ®µï¼Œç»è¿‡æµ‹è¯•å¾—å‡ºDiscuzçš„å¯†ç åŠ å¯†ç®—æ³•ä¸º1md5(md5('password').'salt'); tips: Discuzé‡Œé¢çš„saltæ˜¯ä¸€ä¸ª6ä½çš„ æ•°å­—+å­—æ¯ éšæœºæ•° Wordpressç”¨æˆ·å¯†ç åŠ å¯†ç®—æ³•æå®šäº†DZçš„åŠ å¯†ç®—æ³•åï¼Œé‚£ä¹ˆå¦‚ä½•å°†DZçš„ç”¨æˆ·ä¿¡æ¯æ’å…¥åˆ°WPé‡Œé¢å°±å¾ˆé‡è¦äº†ï¼Œæ‰“å¼€ Wordpress çš„æ•°æ®åº“æ‰¾åˆ° â€˜wp-userâ€˜è¡¨ï¼Œæ‰¾åˆ° â€˜user_passâ€˜ å­—æ®µï¼Œå‘ç°é‡Œé¢åŠ å¯†çš„å†…å®¹ä¼¼ä¹æ— è¿¹å¯å¯»ã€‚å®é™…ä¸Šï¼ŒWordpressçš„åŠ å¯†æ˜¯ä½¿ç”¨äº† phpass ç±»æ¥åŠ å¯†çš„ï¼Œç”± phpass åŠ å¯†çš„å¯†ç å…·æœ‰ä¸å¯é€†æ€§ï¼Œæ‰€ä»¥æƒ³è¦ç ´è§£æ˜¯ä¸å¯èƒ½äº†ï¼Œè¿™é‡Œç®€å•è¯´ä¸€ä¸‹ phpass çš„åŠ å¯†ç®—æ³•ç›®å‰æˆ‘ä»¬çš„PHPç‰ˆæœ¬åº”è¯¥éƒ½åœ¨5ä»¥ä¸Šï¼Œæ‰€ä»¥å‰ç¼€æ˜¯ä¸€æ ·çš„ $P$B å¤§è‡´å†™å‡ºæ¥å¦‚ä¸‹ï¼š12345$count = rand(1,8);$hash = md5($salt . $password, TRUE);while($count--)&#123; $hash = md5($hash . $password, TRUE);&#125; çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆå¼ºï¼Œæˆ‘ä»¬æ— æ³•ç ´è§£è¿™æ ·çš„å¯†ç ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ phpass æ¥åšå¯†ç åŠ å¯†ï¼Œè®©æˆ‘ä»¬çš„æ•°æ®åº“æ›´åŠ çš„å®‰å…¨~ç„¶è€Œæˆ‘ä»¬æ•°æ®è¿ç§»æ—¶å…¶å®å®Œå…¨å¯ä»¥é¿å…è¿™ç§é—®é¢˜ï¼ŒWordpressæ˜¯ä¿ç•™äº†md5åŠ å¯†çš„å½¢å¼çš„ï¼Œå¦‚æœ â€˜user_passâ€˜ å­—æ®µé‡Œé¢å­˜å‚¨çš„æ˜¯md5åŠ å¯†çš„32å€¼ï¼Œwordpressä¹Ÿå¯ä»¥ç™»å½•æˆåŠŸï¼Œå¹¶ä¸”å†ç™»é™†åä¼šå°† â€˜user_passâ€˜ å­—æ®µä¿®æ”¹ä¸º phpass åŠ å¯†çš„æ ¼å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆäººæ€§åŒ–å‘¢ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬æ— éœ€è§£å‡ºæ¥wordpressçš„åŠ å¯†ç®—æ³•ï¼Œæˆ‘ä»¬ä¹Ÿè§£ä¸å‡ºæ¥~ å¼€å§‹è¿ç§»ç”¨æˆ·æ•°æ®å…³äºè¿ç§»æœ‰å¾ˆå¤šç»†èŠ‚ï¼Œæœ¬æ¥æ˜¯æ‰“ç®—å†™å‡ºæ¥çš„ï¼Œåæ¥å‘ç°æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œéƒ½æ˜¯æµæ°´è´¦ï¼Œç›´æ¥å¼€æºåˆ°githubå¥½äº†éœ€è¦çš„æœ‹å‹è¯·ç›´æ¥ç‚¹å‡» D2W - Github","categories":[{"name":"PHP","slug":"PHP","permalink":"https://sbcoder.cn/categories/PHP/"}],"tags":[{"name":"Discuz","slug":"Discuz","permalink":"https://sbcoder.cn/tags/Discuz/"},{"name":"Wordpress","slug":"Wordpress","permalink":"https://sbcoder.cn/tags/Wordpress/"}]},{"title":"192TT(192tb)å¥—å›¾å§æ•´ç«™çˆ¬è™«","slug":"192TT-192tb-å¥—å›¾å§æ•´ç«™çˆ¬è™«","date":"2019-03-28T08:15:16.000Z","updated":"2020-05-17T05:22:15.811Z","comments":true,"path":"2019/03/28/192tt_Spider.html","link":"","permalink":"https://sbcoder.cn/2019/03/28/192tt_Spider.html","excerpt":"","text":"è§‚å¯Ÿç›®å½•ç»“æ„ç›®æ ‡ç½‘ç«™ï¼š192tb.comç½‘ç«™ç»“æ„å¤æ‚ï¼Œä½†ä¹Ÿä¸æ˜¯å¤ªå¤æ‚ï¼Œæ€»ä½“æ¥è¯´éƒ½å†™åœ¨å¯¼èˆªæ ä¸Šé¢äº†ï¼Œæœ¬ä»¥ä¸ºæ˜¯newåˆ†ç±»ä¸‹å°±æ˜¯æ‰€æœ‰çš„æ–‡ç« äº†ï¼Œåæ¥å‘ç°ä¸æ˜¯ï¼Œéœ€è¦éå†æ•´ä¸ªå¯¼èˆªåˆ†ç±»ï¼Œç”±äºæ¯ä¸ªåˆ†ç±»éƒ½æœ‰å¾ˆåºå¤§çš„èµ„æºï¼Œå› æ­¤æˆ‘å†³å®šå†™æˆé…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œå»ºç«‹config.py 1234567891011121314# -*- coding: utf-8 -*-mt = 'https://www.192tb.com/listinfo-1-1.html' # ç¾å›¾mt1 = 'https://www.192tb.com/meitu/xingganmeinv/' # æ€§æ„Ÿç¾å¥³mt2 = 'https://www.192tb.com/meitu/siwameitui/' # ä¸è¢œç¾è…¿mt3 = 'https://www.192tb.com/meitu/weimeixiezhen/' # å”¯ç¾å†™çœŸmt4 = 'https://www.192tb.com/meitu/wangluomeinv/' # ç½‘ç»œç¾å¥³mt5 = 'https://www.192tb.com/meitu/gaoqingmeinv/' # é«˜æ¸…ç¾å¥³mt6 = 'https://www.192tb.com/meitu/motemeinv/' # æ¨¡ç‰¹ç¾å¥³mt7 = 'https://www.192tb.com/meitu/tiyumeinv/' # ä½“è‚²ç¾å¥³mt8 = 'https://www.192tb.com/meitu/dongmanmeinv/' # åŠ¨æ¼«ç¾å¥³mt9 = 'https://www.192tb.com/new/ugirlapp/' # çˆ±å°¤ç‰©APP/å°¤æœç½‘gc = 'https://www.192tb.com/gc/' # å›½äº§gc1 = 'https://www.192tb.com/gc/bl/' # beautyleg1 é¡¶çº§åˆ†ç±»å’ŒäºŒçº§åˆ†ç±»ä¸ä¾¿å¤šè¯´ï¼Œè¿™é‡Œåªæ˜¯æµ‹è¯•å¹¶æ²¡æœ‰æ”¶å½•æ‰€æœ‰çš„åˆ†ç±»ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªå·±æ·»åŠ  è¿›å…¥åˆ†ç±»é¡µåæ—¢æ˜¯å¥—å›¾å°é¢ï¼Œä»è¿™é‡Œå¯ä»¥çˆ¬å–å¥—å›¾çš„é“¾æ¥ï¼Œåˆ†ç±»é¡µçš„åº•éƒ¨ä¹Ÿæ˜¯æœ‰ä¸‹ä¸€é¡µçš„é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®ä¸‹ä¸€é¡µæ¥è·å–ä¸‹ä¸€ä¸ªåˆ†ç±»é¡µçš„é“¾æ¥ï¼Œä»¥æ­¤é€’å½’ï¼Œå¹¶è·å–é“¾æ¥ è·å–åˆ°å¥—å›¾é“¾æ¥åå‘ç°æ¯ä¸ªå•é¡µé¢éƒ½æ˜¯éœ€è¦ç‚¹å‡»ä¸‹ä¸€å¼ å›¾ç‰‡æ¥åšçš„ï¼Œå•é¡µé¢ä¸­çš„å›¾ç‰‡ï¼Œä½¿ç”¨BeautifulSoupå³å¯è½»æ¾è·å–ï¼Œç”±äºä¸çŸ¥é“ä¸€å¥—å›¾é‡Œé¢æœ‰å¤šå°‘å¼ ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨é€’å½’çš„æ–¹å¼ï¼Œèµ°åˆ°æœ€åä¸€å¼ ï¼Œå³é€€å‡ºé€’å½’ã€‚ æ ¸å¿ƒä»£ç è·å–å•ä¸ªå¥—å›¾å¹¶ä¸‹è½½1234567891011121314151617def getSingleData(url,singleTitle,i = 1): response = requests.get(url) soup = BeautifulSoup(response.text,\"html.parser\") imgUrl = soup.find(id = 'p').find('center').find('img').get('lazysrc') print imgUrl try: j = i + 1 result = '_%s.html'%i in url if result: nextImg = response.url.replace('_%s.html'%i, '_%s.html'%j) else: nextImg = response.url.replace('.html', '_%s.html'%j) # print nextImg downImg(imgUrl,singleTitle,i) getSingleData(nextImg,j) except Exception,e: return 0 è·å–ä¸‹ä¸€é¡µé¡µé¢ä¿¡æ¯123456789101112131415161718192021222324def getPage(url,new = 1,i = 1): print 'å¼€å§‹é‡‡é›†ç¬¬%sé¡µ'%i print url response = requests.get(url) soup = BeautifulSoup(response.text,\"html.parser\") for dataUrl in soup.find('div',&#123;'class':'piclist'&#125;).find('ul').find_all('li'): singleDataUrl = 'https://www.192tb.com/'+dataUrl.find('a').get('href') print singleDataUrl try: singleTitle = dataUrl.find('a').find('img').get('alt') except Exception,e: continue print singleTitle getSingleData(singleDataUrl,singleTitle) result = '_%s.html' % i in url j = i + 1 if new != 1: nextPageUrl = url.replace('listinfo-1-%s.html' % i, 'listinfo-1-%s.html' % j) else: if result: nextPageUrl = url.replace('index_%s.html' % i, 'index_%s.html' % j) else: nextPageUrl = url.replace(url, url+'/index_%s.html' % j) getPage(nextPageUrl,new,j) æ¼”ç¤ºåŠä¸‹è½½ä¸‹è½½åœ°å€ï¼šGithub 192ttæ¼”ç¤ºå›¾","categories":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/categories/Python/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/tags/Python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://sbcoder.cn/tags/çˆ¬è™«/"},{"name":"ç¦åˆ©","slug":"ç¦åˆ©","permalink":"https://sbcoder.cn/tags/ç¦åˆ©/"}]},{"title":"æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨ï¼Œå¸¸ç”¨å–å€¼è¡¨ï¼ˆè®°å½•ï¼‰","slug":"æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨ï¼Œå¸¸ç”¨å–å€¼è¡¨ï¼ˆè®°å½•ï¼‰","date":"2019-03-26T08:11:06.000Z","updated":"2019-03-27T03:50:12.000Z","comments":true,"path":"2019/03/26/Regex_match_note.html","link":"","permalink":"https://sbcoder.cn/2019/03/26/Regex_match_note.html","excerpt":"","text":"æ­£åˆ™è¡¨è¾¾å¼ æŸ¥è¯¢è¡¨ å­—ç¬¦ æè¿° åœºæ™¯ \\ è½¬ä¹‰ è½¬ä¹‰åœºæ™¯ \\ ^ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ^ ä¹ŸåŒ¹é… â€˜\\nâ€™ æˆ– â€˜\\râ€™ ä¹‹åçš„ä½ç½®ã€‚ å–aå¼€å¤´çš„å­—ç¬¦ä¸² ^a.* $ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ$ ä¹ŸåŒ¹é… â€˜\\nâ€™ æˆ– â€˜\\râ€™ ä¹‹å‰çš„ä½ç½®ã€‚ å–aå¼€å¤´bç»“å°¾ ^a.*b$ * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ zo èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚ ç­‰ä»·äº{0,} + åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ â€˜zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,} ? åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡. â€œdo(es)?â€ å¯ä»¥åŒ¹é… â€œdoâ€ æˆ– â€œdoesâ€ ä¸­çš„â€doâ€ ã€‚? ç­‰ä»·äº {0,1}ã€‚ {n} n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ â€˜o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚ {n,} n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ â€˜o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€™o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€™o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ {n,m} m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ â€œo{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚ ? å½“ è¯¥å­—ç¬¦ç´§è·Ÿåœ¨ä»»ä½•ä¸€ä¸ªå…¶ä»–é™åˆ¶ç¬¦ (*, +, ?, {n}, {n,}, {n,m}) åé¢æ—¶ï¼ŒåŒ¹é…æ¨¡å¼æ˜¯éè´ªå©ªçš„ã€‚ éè´ªå©ªæ¨¡å¼å°½å¯èƒ½å°‘çš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè€Œé»˜è®¤çš„è´ªå©ªæ¨¡å¼åˆ™å°½å¯èƒ½å¤šçš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ã€‚å¯¹äºå­—ç¬¦ä¸² â€œooooâ€ï¼Œâ€™o+?â€™ å°†åŒ¹é…å•ä¸ª â€œoâ€ï¼Œè€Œ â€˜o+â€™ å°†åŒ¹é…æ‰€æœ‰ â€˜oâ€™ã€‚ . åŒ¹é…é™¤ â€œ\\nâ€ ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚ è¦åŒ¹é…åŒ…æ‹¬ â€˜\\nâ€™ åœ¨å†…çš„ä»»ä½•å­—ç¬¦ï¼Œè¯·ä½¿ç”¨è±¡ â€˜[.\\n]â€™ çš„æ¨¡å¼ã€‚ x&#124;y åŒ¹é… x æˆ– yã€‚ â€˜z&#124;foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚â€™(z&#124;f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ã€‚ [xyz] å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ â€˜[abc]â€™å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ã€‚ [^xyz] å–åï¼ŒåŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦ã€‚ â€˜?[^abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„â€™pâ€™ã€‚ [a-z] å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ â€˜[a-z]â€™ å¯ä»¥åŒ¹é… â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å°å†™å­—æ¯å­—ç¬¦ã€‚ \\b åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯æŒ‡å•è¯å’Œç©ºæ ¼é—´çš„ä½ç½®ã€‚ â€˜er\\bâ€™ å¯ä»¥åŒ¹é…â€neverâ€ ä¸­çš„ â€˜erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„ â€˜erâ€™ã€‚ \\B åŒ¹é…éå•è¯è¾¹ç•Œ â€˜er\\Bâ€™ èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„ â€˜erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é… â€œneverâ€ ä¸­çš„ â€˜erâ€™ã€‚ \\cx åŒ¹é…ç”± x æŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ \\cM åŒ¹é…ä¸€ä¸ª Control-M æˆ–å›è½¦ç¬¦ã€‚x çš„å€¼å¿…é¡»ä¸º A-Z æˆ– a-z ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ â€˜câ€™ å­—ç¬¦ã€‚ \\d åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ ç­‰ä»·äº [0-9]ã€‚ \\D åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ ç­‰ä»·äº [^0-9]ã€‚ \\f åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ ç­‰ä»·äº \\x0c å’Œ \\cLã€‚ \\n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ ç­‰ä»·äº \\x0a å’Œ \\cJã€‚ \\r åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ ç­‰ä»·äº \\x0d å’Œ \\cMã€‚ \\s åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ ç­‰ä»·äº [ \\f\\n\\r\\t\\v]ã€‚ \\S åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ ç­‰ä»·äº [^ \\f\\n\\r\\t\\v]ã€‚ \\t åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ ç­‰ä»·äº \\x09 å’Œ \\cIã€‚ \\v åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ ç­‰ä»·äº \\x0b å’Œ \\cKã€‚ \\w åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ ç­‰ä»·äºâ€™[A-Za-z0-9_]â€™ã€‚ \\W åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ã€‚ ç­‰ä»·äº â€˜[^A-Za-z0-9_]â€™ã€‚ \\xn åŒ¹é…åå…­è¿›åˆ¶æ•° â€˜\\x41â€™ åŒ¹é… â€œAâ€ã€‚â€™\\x041â€™ åˆ™ç­‰ä»·äº â€˜\\x04â€™ &amp; â€œ1â€ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨ ASCII ç¼–ç ã€‚. \\num åŒ¹é… ä¸€ä¸ªæ­£æ•´æ•°ã€‚å¯¹æ‰€è·å–çš„åŒ¹é…çš„å¼•ç”¨ã€‚ â€˜(.)\\1â€™ åŒ¹é…ä¸¤ä¸ªè¿ç»­çš„ç›¸åŒå­—ç¬¦ã€‚ \\n æ ‡è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚ å¦‚æœ \\n ä¹‹å‰è‡³å°‘ n ä¸ªè·å–çš„å­è¡¨è¾¾å¼ï¼Œåˆ™ n ä¸ºå‘åå¼•ç”¨ã€‚å¦åˆ™ï¼Œå¦‚æœ n ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™ n ä¸ºä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼ã€‚ \\nm æ ‡ è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚ å¦‚æœ \\nm ä¹‹å‰è‡³å°‘æœ‰ nm ä¸ªè·å¾—å­è¡¨è¾¾å¼ï¼Œåˆ™ nm ä¸ºå‘åå¼•ç”¨ã€‚å¦‚æœ \\nm ä¹‹å‰è‡³å°‘æœ‰ n ä¸ªè·å–ï¼Œåˆ™ n ä¸ºä¸€ä¸ªåè·Ÿæ–‡å­— m çš„å‘åå¼•ç”¨ã€‚å¦‚æœå‰é¢çš„æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè‹¥ n å’Œ m å‡ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™ \\nm å°†åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼ nmã€‚ \\nml åŒ¹é…å…«è¿›åˆ¶æ•° å¦‚æœ n ä¸ºå…«è¿›åˆ¶æ•°å­— (0-3)ï¼Œä¸” m å’Œ l å‡ä¸ºå…«è¿›åˆ¶æ•°å­— (0-7)ï¼Œåˆ™åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼ nmlã€‚ \\un åŒ¹é… nï¼Œå…¶ä¸­ n æ˜¯ä¸€ä¸ªç”¨å››ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºçš„ Unicode å­—ç¬¦ã€‚ \\u00A9 åŒ¹é…ç‰ˆæƒç¬¦å· ã€‚ å¸¸ç”¨æ¡ˆä¾‹æ¼”ç¤º123# -*- coding:utf-8 -*-import restr1 = 'ai0by123' æå–aå¼€å¤´çš„å­—ç¬¦ä¸²1regexStr = \"^a.*\" æå–aå¼€å¤´bç»“å°¾å­—ç¬¦ä¸²1regexStr = \"^a.*3$\" æå–æœ€å³è¾¹ç¬¦åˆæ¡ä»¶çš„å€¼,è´ªå©ª1regexStr = \".*(a.*b).*\" # è´ªå©ªï¼Œå–aåˆ°bä¹‹é—´ï¼Œå³è¾¹å¼€å§‹å–ï¼Œå–æœ€å³è¾¹ç¬¦åˆæ¡ä»¶çš„ æå–æœ€å·¦è¾¹ç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œéè´ªå©ª1regexStr = \".*?(a.*?b).*\" # éè´ªå©ªï¼Œå–aåˆ°bä¹‹é—´çš„å€¼å«aå’Œbï¼Œä»å·¦å¾€å³åªå–ä¸€æ¬¡ æå–ç¬¦åˆé›†åˆå†…çš„å€¼ï¼Œæˆ–è¿ç®—1regexStr = \"((ai00000by|ai0by)123)\" # æˆ–è¿ç®—ï¼Œç¬¦åˆå…¶ä¸­ä¸€ç§å³å¯ æå–å‡ºç”Ÿæ—¥æœŸ123456str1 = 'XXX å‡ºç”Ÿäº2008å¹´12æœˆ6æ—¥'str1 = 'XXX å‡ºç”Ÿäº2008/12/6'str1 = 'XXX å‡ºç”Ÿäº2008-12-6'str1 = 'XXX å‡ºç”Ÿäº2008-12-06'str1 = 'XXX å‡ºç”Ÿäº2008-12'regexStr = \".*å‡ºç”Ÿäº(\\d&#123;4&#125;[å¹´/-]\\d&#123;1,2&#125;([æœˆ/-]\\d&#123;1,2&#125;|[æœˆ/-]$|$))\" æå–å›¾ç‰‡url,å…¶ä»–ç½‘ç«™åŒç†1234567str1 = 'åœ°å€ï¼šhttps://www.ttbcdn.com/d/file/p/2018-02-17/g4edlvxmmyi9627.jpg'# å–æ•´ä¸²åœ°å€regexStr = \".*https.*jpg$\"# å–XXX.jpg png gif ç­‰regexStr = \".*/(.*.(jpg|gif|png))$\"# å–2018-02-17/g4edlvxmmyi9627.jpg png gifç­‰regexStr = \".*/(\\d&#123;4&#125;-\\d&#123;2&#125;-\\d&#123;2&#125;/(.*.(jpg|gif|png)))$\" æ”¶å°¾æå–å­—ç¬¦ä¸²12345reMatch = re.match(regexStr,str1)if reMatch: print (reMatch.group(1))else: print('No')","categories":[{"name":"note","slug":"note","permalink":"https://sbcoder.cn/categories/note/"}],"tags":[{"name":"ç¬”è®°","slug":"ç¬”è®°","permalink":"https://sbcoder.cn/tags/ç¬”è®°/"},{"name":"æ­£åˆ™è¡¨è¾¾å¼","slug":"æ­£åˆ™è¡¨è¾¾å¼","permalink":"https://sbcoder.cn/tags/æ­£åˆ™è¡¨è¾¾å¼/"}]},{"title":"åšå®¢è¿ç§»è¯´æ˜","slug":"åšå®¢è¿ç§»è¯´æ˜","date":"2019-03-25T05:12:58.000Z","updated":"2019-04-12T14:57:49.000Z","comments":true,"path":"2019/03/25/Hello_world.html","link":"","permalink":"https://sbcoder.cn/2019/03/25/Hello_world.html","excerpt":"","text":"å…³äºè¿ç§»åšå®¢æ€»æ˜¯åœ¨èµ·èµ·ä¼ä¼ï¼Œå…³äº†åˆå¼€ï¼Œå¼€äº†åˆå…³ä¸­åå¤ï¼Œè¿™ä¸€æ¬¡ï¼Œæˆ‘å°†é£å‘æ ‡åšå®¢æ”¾åœ¨äº†Github Pageä¸Šã€‚ç¨‹åºé‡‡ç”¨äº†å½“ä¸‹æ¯”è¾ƒæµè¡Œçš„é™æ€åšå®¢ç¨‹åº Hexo ï¼ŒHexoå…¶å®æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç¨‹åºï¼Œä½†ç”±äºæˆ‘ç»å¸¸æ¢ç”µè„‘ï¼Œä»¥å‰ç”¨hexoæ­å»ºçš„åšå®¢æ•°æ®ä¸¢å¤±äº†å¾ˆå¤šæ¬¡ï¼Œåç»è¿‡æ›´æ¢ä¸ºWordpressï¼ŒTypechoä¹‹ç±»çš„å¼€æºåšå®¢ç¨‹åºåï¼Œæˆ‘åˆå›åˆ°äº† Hexo çš„æ€€æŠ±ï¼Œå¯èƒ½æ˜¯çœŸçš„æ‡’å¾—æŠ˜è…¾äº†ï¼Œä¸Šäº†å¹´çºªï¼Ÿè¿™æ¬¡æˆ‘å°†æºä»£ç éƒ½å¤‡ä»½å¥½äº†ï¼Œåº”è¯¥ä¼šé•¿æœŸæ›´æ–°ï¼Œæœ‰ä»€ä¹ˆå¥½çš„ä¸œè¥¿æˆ‘åº”è¯¥ä¼šåˆ†äº«å‡ºæ¥ï¼Œä¸»æ‰“åŸåˆ›~å¯èƒ½ä¹‹å‰è®¤è¯†æˆ‘çš„äººä¹Ÿå¾ˆå°‘ï¼Œä½†æˆ‘è¿™ä¸ªåŸŸåè¿˜æ˜¯å¾ˆå¥½è®°çš„ï¼Œsb coder ä¹Ÿæ˜¯ä¸€ç§è‡ªå˜²å§ï¼Œæœ‰æƒ³è·Ÿæˆ‘äº¤æµæŠ€æœ¯æˆ–è€…æœ‰å¤–åŒ…å·¥ä½œä»‹ç»ç»™æˆ‘çš„ï¼Œæˆ‘çš„å¾®ä¿¡ä¸åŸŸååŒå·~å¤šçš„ä¸è¯´äº†ï¼Œæˆ‘å°†å°½æˆ‘æ‰€èƒ½ï¼Œä¸€å‘¨è‡³å°‘å†™ä¸€ç¯‡æ–‡ç« ï¼Œå¯èƒ½æœ‰æ—¶å€™æ™šä¸Šå›å®¶å†™ä¸€ç‚¹ï¼Œä¸€å¤©å†™ä¸€ç‚¹ï¼Œä¸€å‘¨ä¸‹æ¥ä¹Ÿèƒ½å†™ä¸å°‘ï¼Œå¸Œæœ›å„ä½ç›‘ç£~ å…³äºæˆ‘æˆ‘æ˜¯è°ï¼ŒèŒä¸šæ˜¯PHPï¼Œçˆ±å¥½Pythonï¼Œäº‘æœåŠ¡å™¨çˆ±å¥½è€…æ”¯ä»˜æ¥å£å¯¹æ¥ï¼Œå¯ä»¥å®šåˆ¶å„ç±»å…ç­¾çº¦æ”¯ä»˜æ¥å£ï¼Œå¾®ä¿¡æ”¯ä»˜å®ï¼Œæœ‰æƒ³æ³•çš„æœ‹å‹å¯ä»¥è”ç³»æˆ‘ Telegram : ai0by æ‰¿æ¥ä¸šåŠ¡æ”¯ä»˜ç›¸å…³ä¸šåŠ¡ï¼Œçˆ¬è™«(å‡ ä¹ä¸è¦é’±ï¼Œç»ƒæ‰‹)ï¼ŒPHPç¨‹åºå¼€å‘æœåŠ¡å™¨ç¯å¢ƒé…ç½®ï¼ŒPHPç¨‹åºä¿®æ”¹ï¼ŒPHP BUGæ’æŸ¥","categories":[],"tags":[{"name":"ai0by","slug":"ai0by","permalink":"https://sbcoder.cn/tags/ai0by/"}]},{"title":"å²›å›½æ¨ç‰¹å¦¹å­å›¾çˆ¬è™«","slug":"å²›å›½æ¨ç‰¹å¦¹å­å›¾çˆ¬è™«","date":"2019-03-22T03:54:58.000Z","updated":"2020-05-17T05:22:04.930Z","comments":true,"path":"2019/03/22/Japan_Twitter_Spider.html","link":"","permalink":"https://sbcoder.cn/2019/03/22/Japan_Twitter_Spider.html","excerpt":"","text":"LOCçš„å¤§ä½¬ä»¬åˆ†äº«äº†ä¸€ä¸ªç½‘ç«™ï¼Œæ”¶é›†äº†å¾ˆå¤šå²›å›½çš„å¦¹å­å›¾å’Œå¥¹ä»¬çš„æ¨ç‰¹åœ°å€ï¼šå²›å›½å¦¹å­æ¨ç‰¹æ¨ç‰¹ä¸æ˜¯å¾ˆæ„Ÿå…´è¶£ï¼Œå°±çˆ¬ä¸€ä¸‹å›¾ç‰‡å¥½äº†~ çˆ¬è™«ä»‹ç»çˆ¬è™«ç¯å¢ƒï¼š Python2.7.9 å¯æ›´æ›¿ä¸º3ï¼Œè‡ªè¡Œæ›´æ›¿ BeautifulSoup4 requests ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334# -*- coding: utf-8 -*-from bs4 import BeautifulSoupimport requestsimport urllib2import randomdef spy(url): req = urllib2.Request(url) req = urllib2.urlopen(req) page = req.read() soup = BeautifulSoup(page, \"html.parser\") for imgSoup in soup.find_all('div', &#123;\"class\": \"row\"&#125;): for i in imgSoup.find_all('div', &#123;'class': 'photo'&#125;): for j in i.find('div', &#123;'class': 'photo-link-outer'&#125;).find('a').find_all('img'): img = j.get(\"src\") print img str = random.sample('zyxwvutsrqponmlkjihgfedcba', 6) downImg(img, str) nexturl = soup.find('p',&#123;'class':'go-to-next-page'&#125;) nexturl = nexturl.find('a').get('href') pageurl = \"http://jigadori.fkoji.com\"+nexturl spy(pageurl)def downImg(img,m): try: r = requests.get(img) except Exception , e: print \"å›¾ç‰‡è·å–å¤±è´¥\" return with open('./img/good%s.jpg' % m, 'wb') as f: f.write(r.content)if __name__ == '__main__': url = \"http://jigadori.fkoji.com\" spy(url) æ•´ä½“æ€è·¯çœ‹ä¸€ä¸‹ï¼Œç½‘é¡µæ„é€ ï¼Œå‘ç°é¦–é¡µåº•éƒ¨æœ‰ä¸‹ä¸€é¡µæ ‡ç­¾ï¼ŒBeautifulSoupå–Classå–å€¼é€’å½’è·å–ä¸‹ä¸€é¡µåœ°å€å›¾ç‰‡åŒä¸Šæ•´ä½“éš¾åº¦ä¸é«˜ï¼Œæœ‰å…´è¶£çš„å¯ä»¥æ‹¿è¿™ä¸ªç½‘ç«™ç»ƒç»ƒæ‰‹~ æ¼”ç¤ºæˆªå›¾ æ¼”ç¤ºæ•°æ®1 æ¼”ç¤ºæ•°æ®2","categories":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/categories/Python/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://sbcoder.cn/tags/Python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://sbcoder.cn/tags/çˆ¬è™«/"},{"name":"ç¦åˆ©","slug":"ç¦åˆ©","permalink":"https://sbcoder.cn/tags/ç¦åˆ©/"}]}]}